{"version":3,"sources":["node_modules/browser-pack/_prelude.js","global.ts","src/Language.ts","src/Views/ItemTTT/ItemTTTController.ts","src/Views/ItemTTT/List.ts","src/Views/common.ts"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","ttt","common","itemttt","list","window","Languages","_a","utils","strEnum","allLanguages","ViewModes","allViewModes","_b","SortingFields","allSortingFields","getListContent","url","routes","itemTTT","itemsList","replace","languageParameter","pageParameters","currentLanguage","getRequest","sent","$divCarsList","ItemTTTController_1","testPromise","log","Date","ms","task","Promise","resolve","setTimeout","refreshList","noLayout","html","init","$btnViewGrid","click","viewMode","grid","$btnViewList","$btnSortName","sortingField","name","$btnSortPrice","price","debugMessages","optionalParams","_i","arguments","isDebug","console","apply","error","reduce","res","key","Object","create","stringIsNullOrEmpty","str","stringIsNullOrWhitespace","trim","htmlEncode","txt","Array","isArray","$","map","v","document","createElement","text","join","arrayContains","item","indexOf","arrayRemoveItem","splice","arraySum","rc","forEach","arrayMoveItem","direction","j","tmp","ensureInteger","canBeZero","fallbackValue","observable","subscribe","value","newValue","parseInt","isNaN","newGuid","S4","Math","random","toString","substring","block","$e","blockCounter","data","unblock","ensureVisible","offset","top","height","animate","scrollTop","effect","url_1","onChangedEvent","onChangedCallbacks","onChangedCallbacksRegistered","stringifyParameters","parms","pairs","each","encodeURIComponent","JSON","stringify","push","createUrl","newPath","pathname","location","parameters","queryString","redirect","href","parseParameters","searchString","search","tokens","split","dict","decodeURIComponent","parse","ex","onChanged","callback","bind","evt","trigger","pushHistory","history","pushState","newTitle","postRequest","request","requestStr","reject","ajax","type","contentType","dataType","success","textStatus","jqXHR","errorThrown","downloadFile","body","append","attr","src","style","__export"],"mappings":"CAAA,SAAAA,EAAAC,EAAAC,EAAAC,GAAA,SAAAC,EAAAC,EAAAC,GAAA,IAAAJ,EAAAG,GAAA,CAAA,IAAAJ,EAAAI,GAAA,CAAA,IAAAE,EAAA,mBAAAC,SAAAA,QAAA,IAAAF,GAAAC,EAAA,OAAAA,EAAAF,GAAA,GAAA,GAAAI,EAAA,OAAAA,EAAAJ,GAAA,GAAA,IAAAK,EAAA,IAAAC,MAAA,uBAAAN,EAAA,KAAA,MAAAK,EAAAE,KAAA,mBAAAF,EAAA,IAAAG,EAAAX,EAAAG,GAAA,CAAAS,QAAA,IAAAb,EAAAI,GAAA,GAAAU,KAAAF,EAAAC,QAAA,SAAAd,GAAA,OAAAI,EAAAH,EAAAI,GAAA,GAAAL,IAAAA,IAAAa,EAAAA,EAAAC,QAAAd,EAAAC,EAAAC,EAAAC,GAAA,OAAAD,EAAAG,GAAAS,QAAA,IAAA,IAAAL,EAAA,mBAAAD,SAAAA,QAAAH,EAAA,EAAAA,EAAAF,EAAAa,OAAAX,IAAAD,EAAAD,EAAAE,IAAA,OAAAD,EAAA,CAAA,CAAAa,EAAA,CAAA,SAAAT,EAAAU,EAAAJ,6ECCA,IAMIK,EACJ,CACCC,OARDZ,EAAA,sBASCa,QAAS,CACRC,KATFd,EAAA,8BAgBAe,OAAOJ,IAAMA,oICjBb,IAAAC,EAAAZ,EAAA,kBAEiBM,EAAAU,WAAJC,EAAkCL,EAAOM,MAAMC,QAAQ,CAAE,KAAM,KAAM,QAAO1B,EAA3Da,EAAAc,aAAYH,EAAAf,27CCF1C,IAEiBY,MAFjBF,EAAAZ,EAAA,aAEiBc,EAAAR,EAAAQ,OAAAR,EAAAQ,KAAI,IAEPG,EAAAL,EAAAM,MAAAC,QAAA,CAAA,OAAA,SAAEL,EAAAO,UAAAJ,EAAAxB,EAAaqB,EAAAQ,aAAAL,EAAAf,EAGfqB,EAAAX,EAAAM,MAAAC,QAAA,CAAA,QAAA,SAAEL,EAAAU,cAAAD,EAAA9B,EAAiBqB,EAAAW,iBAAAF,EAAArB,EAGVY,EAAAY,eAAtB,SAAqCrB,iGAG7B,OADHsB,EAAMf,EAAOgB,OAAOC,QAAQC,UAAUC,QAASnB,EAAOgB,OAAOI,kBAAmBpB,EAAOqB,eAAeC,iBACnG,CAAA,EAAMtB,EAAOe,IAAIQ,WAAYR,EAAKtB,WAAzC,MAAA,CAAA,EAAOY,EAAAmB,k8CCbT,IAiBIC,EAjBJzB,EAAAZ,EAAA,aACAsC,EAAAtC,EAAA,uBAOA,SAAeuC,kGAKd,OAHA3B,EAAOM,MAAMsB,IAAK,IAAK,GAAG,IAAIC,MAPhBC,EAQI,IAAdC,EANG,IAAIC,QAAS,SAAAC,GAAW,OAAAC,WAAWD,EAASH,KAOnD9B,EAAOM,MAAMsB,IAAK,IAAK,GAAG,IAAIC,MAC9B,CAAA,EAAME,iBAAN1B,EAAAmB,OACAxB,EAAOM,MAAMsB,IAAK,IAAK,GAAG,IAAIC,UAX/B,IAAeC,MAkCf,SAAeK,EAAY1C,iGAKf,OAHXO,EAAOM,MAAMsB,IAAK,wBAElBnC,EAAE2C,UAAW,EACF,CAAA,EAAMV,EAAAxB,KAAKY,eAAgBrB,kBAAlC4C,EAAOhC,EAAAmB,OACXC,EAAaY,KAAMA,GAEnBrC,EAAOM,MAAMsB,IAAK,+BA1BnBlC,EAAA4C,KAAA,SAA2B7C,2EAM1BO,EAAOM,MAAMsB,IAAK,qBAClBD,IAEAF,EAAehC,EAAEgC,aACjBhC,EAAE8C,aAAcC,MAAO,WAAML,EAAY,CAAEM,SAASf,EAAAxB,KAAKO,UAAUiC,SACnEjD,EAAEkD,aAAcH,MAAO,WAAML,EAAY,CAAEM,SAASf,EAAAxB,KAAKO,UAAUP,SACnET,EAAEmD,aAAcJ,MAAO,WAAML,EAAY,CAAEU,aAAanB,EAAAxB,KAAKU,cAAckC,SAC3ErD,EAAEsD,cAAeP,MAAO,WAAML,EAAY,CAAEU,aAAanB,EAAAxB,KAAKU,cAAcoC,UAE5EhD,EAAOM,MAAMsB,IAAK,0IClCnB,IAgBiBtB,EAAAA,EA0JA+B,EA1KjBrC,EAAAZ,EAAA,YAKaM,EAAAuD,eAA0B,EAIvCvD,EAAA4C,KAAA,SAAqB7C,GAEpBC,EAAA2B,eAAiB5B,EAAE4B,eACnB3B,EAAAsB,OAAStB,EAAA2B,eAAeL,OACxBV,EAAMsB,IAAK,mBAGKtB,EAAAA,EAAAZ,EAAAY,QAAAZ,EAAAY,MAAK,KAELsB,IAAhB,eAAoB,IAAAsB,EAAA,GAAAC,EAAA,EAAAA,EAAAC,UAAAxD,OAAAuD,IAAAD,EAAAC,GAAAC,UAAAD,GAEfzD,EAAA2B,eAAegC,SAClBC,QAAQ1B,IAAI2B,MAAOD,QAASF,YAGd9C,EAAAkD,MAAhB,eAAsB,IAAAN,EAAA,GAAAC,EAAA,EAAAA,EAAAC,UAAAxD,OAAAuD,IAAAD,EAAAC,GAAAC,UAAAD,GAErBG,QAAQE,MAAMD,MAAOD,QAASF,YAMf9C,EAAAC,QAAhB,SAA0CjB,GAOzC,MAAO,CAAET,EALCS,EAAEmE,OAAQ,SAACC,EAAKC,GAGxB,OADAD,EAAIC,GAAOA,EACJD,GACLE,OAAOC,OAAO,OACNvE,EAACA,IAGEgB,EAAAwD,oBAAhB,SAAoCC,GAEnC,OAAW,MAAPA,GAEO,IAAPA,GAIWzD,EAAA0D,yBAAhB,SAAyCD,GAExC,OAAW,MAAPA,GAEc,IAAdA,EAAIE,QAKO3D,EAAA4D,WAAhB,SAA2BC,GAG1B,OAAIC,MAAMC,QAAQF,GACVG,EAAEC,IAAeJ,EAAK,SAAAK,GAAG,OAAAF,EAAEG,SAASC,cAAc,SAASC,KAAMH,GAAInC,SAASuC,KAAM,SAEpFN,EAAEG,SAASC,cAAc,SAASC,KAAMR,GAAM9B,QAGvC/B,EAAAuE,cAAhB,SAAiCvF,EAAOwF,GAEvC,OAA8B,GAArBxF,EAAEyF,QAASD,IAULxE,EAAA0E,gBAAhB,SAAmC1F,EAAOwF,GAEzC,IAAI7F,EAAIK,EAAEyF,QAASD,GACnB,QAAI7F,EAAI,IAERK,EAAE2F,OAAQhG,EAAG,GACN,KAGQqB,EAAA4E,SAAhB,SAA4B5F,EAAOJ,GAElC,IAAIiG,EAAK,EAKT,OAJA7F,EAAE8F,QAAS,SAASvG,GAElBsG,GAAMjG,EAAEL,KAEHsG,GAGQ7E,EAAA+E,cAAhB,SAAiC5F,GAIhC,IAAIX,EAAI,EACW,MAAfW,EAAE6F,YACLxG,EAAoB,MAAfW,EAAE6F,WAAsBxG,EAAIA,GAClC,IAAMG,EAAIQ,EAAES,KAAK6E,QAAStF,EAAEqF,MAC5B,GAAI7F,EAAI,EACP,KAAM,CAAEuE,MAAM,8BAA+BsB,KAAKrF,EAAEqF,MACrD,IAAIS,EAAItG,EAAIH,EAKZ,GAJIyG,EAAI,EACPA,EAAI,EACIA,GAAK9F,EAAES,KAAKN,SACpB2F,EAAI9F,EAAES,KAAKN,OAAS,GACjBX,GAAKsG,EAER,OAAO9F,EAAES,KAGV,IAAMsF,EAAM/F,EAAES,KAAMjB,GAIpB,OAHAQ,EAAES,KAAMjB,GAAMQ,EAAES,KAAMqF,GACtB9F,EAAES,KAAMqF,GAAMC,EAEP/F,EAAES,MAGMI,EAAAmF,cAAhB,SAA8BhG,GAKV,MAAfA,EAAEiG,YACLjG,EAAEiG,WAAY,GACQ,MAAnBjG,EAAEkG,gBAEDlG,EAAEiG,UACLjG,EAAEkG,cAAgB,EAElBlG,EAAEkG,cAAgB,GAGpBlG,EAAEmG,WAAWC,UAAW,SAASC,GAE/B,IAAIC,EAAWC,SAAeF,GAE1BG,MAAMF,GACTA,EAAWtG,EAAEkG,cACHlG,EAAEiG,WAAwB,GAATI,EAElBrG,EAAgB,gBAAMqG,EAAQ,IACvCC,EAAWtG,EAAEkG,eAFbI,EAAWtG,EAAEkG,cAIVG,IAAUC,GAEbtG,EAAEmG,WAAYG,MAMFzF,EAAA4F,QAAhB,WAEC,IAAIC,EAAK,WAER,OAA2B,OAAjB,EAAEC,KAAKC,UAAmB,GAAGC,SAAS,IAAIC,UAAU,IAE/D,OAAQJ,IAAKA,IAAK,IAAIA,IAAK,IAAIA,IAAK,IAAIA,IAAK,IAAIA,IAAKA,IAAKA,MAI5C9D,EAAA3C,EAAA2C,OAAA3C,EAAA2C,KAAI,KAGJmE,MAAhB,SAAsBC,GAGrB,IAAIC,EAAsD,GAAN,EAA/BD,EAAGE,KAAK,wBAO7B,OANAF,EAAGE,KAAM,sBAAuBD,GAEZ,GAAhBA,GAEGD,EAAID,QAEJC,GAIQpE,EAAAuE,QAAhB,SAAwBH,GAGvB,IAAIC,GAAgD,EAA/BD,EAAGE,KAAK,wBAA6B,EAiB1D,OAhBAF,EAAGE,KAAM,sBAAuBD,GAE5BA,EAAe,IAGlB1G,EAAOM,MAAMkD,MAAO,+CAAgDkD,GAGpEA,EAAe,EACfD,EAAGE,KAAM,sBAAuB,IAGb,GAAhBD,GAEGD,EAAIG,UAEJH,GAGQpE,EAAAwE,cAAhB,SAA8BJ,GAG7B,IAAMK,EAASL,EAAGK,SAASC,KAAQ,GAAKN,EAAGO,UAC3C1C,EAAE,cAAc2C,QAAQ,CAAEC,UAAUJ,IAGpCL,EAAGU,OAAQ,YAAa,GAAI,MAI9B,SAAiBC,GAEhB,IAAMC,EAAiB,eACnBC,EAAqBhD,EAAE,IACvBiD,GAA+B,EAkCnC,SAAgBC,EAAoBC,GAEnC,IAAIC,EAAkB,GActB,OAbApD,EAAEqD,KAAMF,EAAO,SAAS9D,EAAWmC,GAEjCnC,EAAMiE,mBAAoBjE,GAEZ,MAATmC,GAAqC,iBAAZ,GAA4C,iBAAZ,GAA4C,kBAAZ,IAI7FA,EAAQ+B,KAAKC,UAAWhC,IACzBA,EAAQ8B,mBAAoB9B,GAE5B4B,EAAMK,KAAMpE,EAAI,IAAImC,KAEf4B,EAAM9C,KAAM,KAoBpB,SAAgBoD,EAAUvI,GAEzB,IAAIwI,EAAUxI,EAAEyI,SAIhB,GAHe,MAAXD,IACHA,EAAU9H,OAAOgI,SAASD,UAEP,MAAhBzI,EAAE2I,WACN,CACC,IAAMC,EAAcb,EAAqB/H,EAAE2I,YAClB,EAArBC,EAAYzI,SACfqI,EAAUA,EAAQ,IAAII,GAExB,OAAOJ,EAhFQb,EAAAkB,SAAhB,SAAyBvH,GAExBZ,OAAOgI,SAASI,KAAOxH,GAIRqG,EAAAoB,gBAAhB,SAAgCC,GAI/B,GAFoB,MAAhBA,IACHA,EAAetI,OAAOgI,SAASO,OAAOnC,UAAU,IACtB,GAAvBkC,EAAa7I,OAChB,MAAO,GAKR,IAHA,IAAI+I,EAASF,EAAaG,MAAO,KAE7BC,EAA2B,GACtB5J,EAAE,EAAGA,EAAI0J,EAAO/I,SAAUX,EACnC,CACC,IAAIyI,EAAQiB,EAAO1J,GAAG2J,MAAO,KACzBjF,EAAMmF,mBAAoBpB,EAAM,IAChC5B,EAAQgD,mBAAoBpB,EAAM,IAGtC,IAAM5B,EAAQ+B,KAAKkB,MAAMjD,GACzB,MAAOkD,IAEPH,EAAMlF,GAAQmC,EAEf,OAAO+C,GAIQzB,EAAAI,oBAAmBA,EAoBnBJ,EAAA6B,UAAhB,SAA0BC,GAIW,GAAhC3B,IAEHjD,EAAEnE,QAAQgJ,KAAM,WAAY,SAASC,GAEnC9B,EAAmB+B,QAAShC,KAE9BE,GAA+B,GAGhCD,EAAmB6B,KAAM9B,EAAgB6B,IAG1B9B,EAAAY,UAASA,EAgBTZ,EAAAkC,YAAhB,SAA4B7J,GAE3B,IAAMwI,EAAUD,EAAWvI,GAC3BU,OAAOoJ,QAAQC,UAAW,GAAI/J,EAAEgK,SAAUxB,GAG1CX,EAAmB+B,QAAShC,IAIbD,EAAAsC,YAAhB,SAA+B3I,EAAY4I,GAE1C,IAAIC,EAAa/B,KAAKC,UAAW6B,GACjC,OAAO,IAAI3H,QAAY,SAACC,EAAQ4H,GAE9BvF,EAAEwF,KAAK,CAAEC,KAAQ,OACdhJ,IAAQA,EACRiJ,YAAc,mBACdrD,KAAQiD,EACRK,SAAW,OACXC,QAAW,SAACvD,EAAKwD,EAAWC,GAAQ,OAAAnI,EAAS0E,IAC7CnD,MAAS,SAAC4G,EAAMD,EAAWE,GAEtBR,EAAQM,SAOH/C,EAAA7F,WAAhB,SAA2BR,EAAY4I,GAEtC,GAAe,MAAXA,EACJ,CACC,IAAMlC,EAAQD,EAAqBmC,GACnC5I,EAASA,EAAG,IAAI0G,EAGjB,OAAO,IAAIzF,QAAiB,SAACC,EAAQ4H,GAEnCvF,EAAEwF,KAAK,CAAEC,KAAQ,MACdhJ,IAAQA,EACRiJ,YAAc,YACdE,QAAW,SAACvD,EAAKwD,EAAWC,GAAQ,OAAAnI,EAAS0E,IAC7CnD,MAAS,SAAC4G,EAAMD,EAAWE,GAEtBR,EAAQM,SAMH/C,EAAAkD,aAAhB,SAA6BvJ,GAE5BuD,EAAEG,SAAS8F,MAAMC,OAAQlG,EAAE,aAAamG,KAAK,CAAEC,IAAO3J,EAC1C4J,MAAQ,qCAjJtB,CAAiBjL,EAAAqB,MAAArB,EAAAqB,IAAG,iEAwJpB6J,CAAAxL,EAAA","file":"site.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","\r\nimport * as common\t\tfrom \"./src/Views/common\";\r\nimport * as itemlist\tfrom \"./src/Views/ItemTTT/List\";\r\n\r\n///////\r\n\r\n// Global assignment of window.itemttt (will be available in each pages e.g. from the console):\r\nvar ttt =\r\n{\r\n\tcommon: common,\r\n\titemttt: {\r\n\t\tlist : itemlist,\r\n\t},\r\n}\r\ndeclare global\r\n{\r\n\tinterface Window { ttt: typeof ttt; }\r\n}\r\nwindow.ttt = ttt;\r\n","\nimport * as common from \"./Views/common\";\n\nexport const { e:Languages, a:allLanguages } = common.utils.strEnum([ 'en', 'fr', 'nl' ]);\nexport type Language = keyof typeof Languages;\n","\nimport * as common from \"../common\";\n\nexport namespace list\n{\n\texport const { e:ViewModes, a:allViewModes } = common.utils.strEnum([ 'grid', 'list' ]);\n\texport type ViewMode = keyof typeof ViewModes;\n\n\texport const { e:SortingFields, a:allSortingFields } = common.utils.strEnum([ 'price', 'name' ]);\n\texport type SortingField = keyof typeof SortingFields;\n\n\texport async function getListContent(p:GetListContentRequest) : Promise<string>\n\t{\n\t\tvar url = common.routes.itemTTT.itemsList.replace( common.routes.languageParameter, common.pageParameters.currentLanguage );\n\t\treturn await common.url.getRequest( url, p );\n\t}\n\texport interface GetListContentRequest\n\t\t{\n\t\t\tviewMode?\t\t: ViewMode,\n\t\t\tsortingField?\t: SortingField,\n\t\t\tnoLayout?\t\t: boolean,\n\t\t};\n}\n","\nimport * as common from \"../common\";\nimport { list } from \"./ItemTTTController\";\n\nfunction sleep(ms:number) : Promise<void>\n{\n\treturn new Promise( resolve => setTimeout(resolve, ms) );\n}\n// DELETEME\nasync function testPromise() : Promise<void>\n{\n\tcommon.utils.log( 'A', `${new Date()}` );\n\tvar task = sleep( 3000 );\n\tcommon.utils.log( 'B', `${new Date()}` );\n\tawait task;\n\tcommon.utils.log( 'C', `${new Date()}` );\n}\n\nvar $divCarsList : JQuery;\n\nexport async function init(p:{\t$divCarsList\t: JQuery,\n\t\t\t\t\t\t\t\t$btnViewList\t: JQuery,\n\t\t\t\t\t\t\t\t$btnViewGrid\t: JQuery,\n\t\t\t\t\t\t\t\t$btnSortName\t: JQuery,\n\t\t\t\t\t\t\t\t$btnSortPrice\t: JQuery }) : Promise<void>\n{\n\tcommon.utils.log( 'list.init() START' );\n\ttestPromise();\n\n\t$divCarsList = p.$divCarsList;\n\tp.$btnViewGrid\t.click( ()=>{ refreshList({ viewMode:list.ViewModes.grid }) } );\n\tp.$btnViewList\t.click( ()=>{ refreshList({ viewMode:list.ViewModes.list }) } );\n\tp.$btnSortName\t.click( ()=>{ refreshList({ sortingField:list.SortingFields.name }) } );\n\tp.$btnSortPrice\t.click( ()=>{ refreshList({ sortingField:list.SortingFields.price }) } );\n\n\tcommon.utils.log( 'list.init() END' );\n}\n\nasync function refreshList(p:list.GetListContentRequest) : Promise<void>\n{\n\tcommon.utils.log( 'list.refresh() START' );\n\n\tp.noLayout = true;\n\tvar html = await list.getListContent( p );\n\t$divCarsList.html( html );\n\n\tcommon.utils.log( 'list.refresh() END' );\n}\n\n","\r\nimport * as common from \"./common\";\r\nimport { PageParameters } from \"../PageHelper\";\r\nimport { Routes } from \"../Routes\";\r\n\r\n\r\nexport const debugMessages : boolean = false;  // NB: 'export' so that it can be easily changed from the browser's console\r\nexport var pageParameters : PageParameters;\r\nexport var routes : Routes;\r\n\r\nexport function init(p:{ pageParameters:PageParameters })\r\n{\r\n\tpageParameters = p.pageParameters;\r\n\troutes = pageParameters.routes;\r\n\tutils.log( 'common.init()' );\r\n}\r\n\r\nexport namespace utils\r\n{\r\n\texport function log(...optionalParams: any[]) : void\r\n\t{\r\n\t\tif( pageParameters.isDebug )\r\n\t\t\tconsole.log.apply( console, arguments );\r\n\t}\r\n\r\n\texport function error(...optionalParams: any[]) : void\r\n\t{\r\n\t\tconsole.error.apply( console, arguments );\r\n\t}\r\n\r\n\t/** Function to simulate string-valued enums\r\n\t * Based on: https://basarat.gitbooks.io/typescript/docs/types/literal-types.html\r\n\t * Returns: { e:the enum , a:the array specified as parameter } */\r\n\texport function strEnum<T extends string>(a:Array<T>): { e:{[K in T]: K}, a:T[] }\r\n\t{\r\n\t\tconst e = a.reduce( (res, key)=>\r\n\t\t\t{\r\n\t\t\t\tres[key] = key;\r\n\t\t\t\treturn res;\r\n\t\t\t}, Object.create(null) );\r\n\t\treturn { e, a };\r\n\t}\r\n\r\n\texport function stringIsNullOrEmpty(str:string) : boolean\r\n\t{\r\n\t\tif( str == null )\r\n\t\t\treturn true;\r\n\t\tif( str == '' )\r\n\t\t\treturn true;\r\n\t\treturn false;\r\n\t}\r\n\texport function stringIsNullOrWhitespace(str:string) : boolean\r\n\t{\r\n\t\tif( str == null )\r\n\t\t\treturn true;\r\n\t\tif( str.trim() == '' )\r\n\t\t\treturn true;\r\n\t\treturn false;\r\n\t}\r\n\r\n\texport function htmlEncode(txt:string|string[]) : string\r\n\t{\r\n\t\t// TODO: Find a better way ?\r\n\t\tif( Array.isArray(txt) )\r\n\t\t\treturn $.map( <string[]>txt, v=>$(document.createElement('span')).text( v ).html() ).join( '<br/>' );\r\n\t\telse\r\n\t\t\treturn $(document.createElement('span')).text( txt ).html();\r\n\t}\r\n\r\n\texport function arrayContains<T>(a:T[], item:any) : boolean\r\n\t{\r\n\t\treturn ( a.indexOf( item ) >= 0 );\r\n\t}\r\n\r\n//ES5 incompatible ...\r\n//\texport function arrayUnique<T>(a:T[]) : T[]\r\n//\t{\r\n//\t\t//return a.filter( (v,i)=>( a.indexOf(v) === i ) );\r\n//\t\treturn [ ... new Set(a) ];\r\n//\t}\r\n\r\n\texport function arrayRemoveItem<T>(a:T[], item:T) : boolean\r\n\t{\r\n\t\tlet i = a.indexOf( item );\r\n\t\tif( i < 0 )\r\n\t\t\treturn false;\r\n\t\ta.splice( i, 1 );\r\n\t\treturn true;\r\n\t}\r\n\r\n\texport function arraySum<T>(a:T[], f:(e:T)=>number) : number\r\n\t{\r\n\t\tlet rc = 0;\r\n\t\ta.forEach( function(e)\r\n\t\t\t{\r\n\t\t\t\trc += f(e);\r\n\t\t\t} );\r\n\t\treturn rc;\r\n\t}\r\n\r\n\texport function arrayMoveItem<T>(p:{ list:T[], item:T, direction?:'up'|'down' }) : T[]\r\n\t{\r\n\t\t// NB: Does not yet work when n>1 ...\r\n\r\n\t\tlet n = 1;\r\n\t\tif( p.direction != null )\r\n\t\t\tn = (p.direction == 'up') ? -n : n;\r\n\t\tconst i = p.list.indexOf( p.item );  // Start position\r\n\t\tif( i < 0 )\r\n\t\t\tthrow { error:'Could not find item in list', item:p.item };\r\n\t\tlet j = i + n;  // End position\r\n\t\tif( j < 0 )\r\n\t\t\tj = 0;\r\n\t\telse if( j >= p.list.length )\r\n\t\t\tj = p.list.length - 1;\r\n\t\tif( i == j )\r\n\t\t\t// NOOP\r\n\t\t\treturn p.list;\r\n\r\n\t\t// Swap items here\r\n\t\tconst tmp = p.list[ i ];\r\n\t\tp.list[ i ] = p.list[ j ];\r\n\t\tp.list[ j ] = tmp;\r\n\r\n\t\treturn p.list;\r\n\t}\r\n\r\n\texport function ensureInteger(p:{\tobservable:KnockoutObservable<Number>,\r\n\t\t\t\t\t\t\t\t\t\tfallbackValue?:number,\r\n\t\t\t\t\t\t\t\t\t\tmustBePositive?:boolean,\r\n\t\t\t\t\t\t\t\t\t\tcanBeZero?:boolean }) : void\r\n\t{\r\n\t\tif( p.canBeZero == null )\r\n\t\t\tp.canBeZero = true;\r\n\t\tif( p.fallbackValue == null )\r\n\t\t{\r\n\t\t\tif( p.canBeZero )\r\n\t\t\t\tp.fallbackValue = 0;\r\n\t\t\telse\r\n\t\t\t\tp.fallbackValue = 1;\r\n\t\t}\r\n\r\n\t\tp.observable.subscribe( function(value:number)\r\n\t\t\t{\r\n\t\t\t\tvar newValue = parseInt( <any>value );\r\n\r\n\t\t\t\tif( isNaN(newValue) )\r\n\t\t\t\t\tnewValue = p.fallbackValue;\r\n\t\t\t\telse if( (!p.canBeZero) && (value == 0) )\r\n\t\t\t\t\tnewValue = p.fallbackValue;\r\n\t\t\t\telse if( (p.mustBePositive) && (value < 0) )\r\n\t\t\t\t\tnewValue = p.fallbackValue;\r\n\r\n\t\t\t\tif( value !== newValue )\r\n\t\t\t\t\t// Value must be changed\r\n\t\t\t\t\tp.observable( newValue );\r\n\t\t\t} );\r\n\t}\r\n\r\n\t/** Generates a GUID-like string (something that looks like one, but NOT a real one!!!)\r\n\t * cf. http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript */\r\n\texport function newGuid() : string\r\n\t{\r\n\t\tvar S4 = function() : string\r\n\t\t{\r\n\t\t\treturn (((1+Math.random())*0x10000)|0).toString(16).substring(1);\r\n\t\t};\r\n\t\treturn (S4()+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+S4()+S4());\r\n\t}\r\n} // namespace utils\r\n\r\nexport namespace html\r\n{\r\n\t/** Invoke jQuery.blockUI's '.block()' on the specified element but supports multiple invokation on the same element */\r\n\texport function block($e:JQuery) : JQuery\r\n\t{\r\n\t\t// Insert/increment a block counter as jQuery 'data()'\r\n\t\tvar blockCounter = ( $e.data('common_blockCounter')|0 ) + 1;\r\n\t\t$e.data( 'common_blockCounter', blockCounter );\r\n\r\n\t\tif( blockCounter == 1 )\r\n\t\t\t// This element is not blocked yet\r\n\t\t\t(<any>$e).block();  // TODO: ACA: jQuery.blockUI typings ...\r\n\r\n\t\treturn $e;\r\n\t}\r\n\r\n\t/** Invoke jQuery.blockUI's '.unblock()' on the specified element except if it has been block()ed more than once */\r\n\texport function unblock($e:JQuery) : JQuery\r\n\t{\r\n\t\t// Decrement the block counter in the jQuery 'data()'\r\n\t\tvar blockCounter = ( $e.data('common_blockCounter')|0 ) - 1;\r\n\t\t$e.data( 'common_blockCounter', blockCounter );\r\n\r\n\t\tif( blockCounter < 0 )\r\n\t\t{\r\n\t\t\t// There is a logic error somewhere...\r\n\t\t\tcommon.utils.error( 'INTERNAL ERROR: Unblock count > block count:', blockCounter );\r\n\r\n\t\t\t// Reset counter\r\n\t\t\tblockCounter = 0;\r\n\t\t\t$e.data( 'common_blockCounter', 0 );\r\n\t\t}\r\n\r\n\t\tif( blockCounter == 0 )\r\n\t\t\t// This element is no more blocked by anything else\r\n\t\t\t(<any>$e).unblock();  // TODO: ACA: jQuery.blockUI typings ...\r\n\r\n\t\treturn $e;\r\n\t}\r\n\r\n\texport function ensureVisible($e:JQuery) : void\r\n\t{\r\n\t\t// Scroll\r\n\t\tconst offset = $e.offset().top - ( 20 + $e.height() );\r\n\t\t$('html, body').animate({ scrollTop:offset });  // cf.: https://stackoverflow.com/questions/4884839/how-do-i-get-an-element-to-scroll-into-view-using-jquery?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa\r\n\r\n\t\t// Blink\r\n\t\t$e.effect( \"highlight\", {}, 2000 );  // cf.: https://stackoverflow.com/questions/5205445/jquery-blinking-highlight-effect-on-div?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa\r\n\t}\r\n} // namespace html\r\n\r\nexport namespace url\r\n{\r\n\tconst onChangedEvent = 'onUrlChanged';\r\n\tvar onChangedCallbacks = $({});\r\n\tvar onChangedCallbacksRegistered = false;\r\n\r\n\texport function redirect(url:string)\r\n\t{\r\n\t\twindow.location.href = url;\r\n\t}\r\n\r\n\t/** Parse a parameters string like 'foo=bar&hello=world' and return the a dictionary like {foo:'bar',hello:'world'} */\r\n\texport function parseParameters(searchString?:string) : {[key:string]:any}\r\n\t{\r\n\t\tif( searchString == null )\r\n\t\t\tsearchString = window.location.search.substring(1);\r\n\t\tif( searchString.length == 0 )\r\n\t\t\treturn {};\r\n\r\n\t\tvar tokens = searchString.split( '&' );\r\n\r\n\t\tvar dict = <{[key:string]:any}>{};\r\n\t\tfor( var i=0; i < tokens.length; ++i )\r\n\t\t{\r\n\t\t\tvar pairs = tokens[i].split( '=' );\r\n\t\t\tvar key = decodeURIComponent( pairs[0] );\r\n\t\t\tvar value = decodeURIComponent( pairs[1] );\r\n\r\n\t\t\t// Try parse JSON\r\n\t\t\ttry { value = JSON.parse(value); }\r\n\t\t\tcatch( ex ){/* Not JSON => Keep the string as-is*/}\r\n\r\n\t\t\tdict[ key ] = value;\r\n\t\t}\r\n\t\treturn dict;\r\n\t}\r\n\r\n\t/** Transform a dictionary like {foo:'bar',hello:'world'} to a parameters string like 'foo=bar&hello=world' */\r\n\texport function stringifyParameters(parms:{[key:string]:any}) : string\r\n\t{\r\n\t\tvar pairs = <string[]>[];\r\n\t\t$.each( parms, function(key:string,value)\r\n\t\t\t{\r\n\t\t\t\tkey = encodeURIComponent( key );\r\n\r\n\t\t\t\tif( (value == null) || (typeof(value) === 'string') || (typeof(value) === 'number') || (typeof(value) === 'boolean') )\r\n\t\t\t\t\t{/*Keep as-is*/}\r\n\t\t\t\telse\r\n\t\t\t\t\t// Convert to JSON\r\n\t\t\t\t\tvalue = JSON.stringify( value );\r\n\t\t\t\tvalue = encodeURIComponent( value );\r\n\r\n\t\t\t\tpairs.push( key+\"=\"+value );\r\n\t\t\t} );\r\n\t\treturn pairs.join( '&' );\r\n\t}\r\n\r\n\t/** Registers a callback to be invoked whenever the browser's URL changes (cf. 'pushHistory()') */\r\n\texport function onChanged(callback:()=>void) : void\r\n\t{\r\n\t\t// NB: The callback gets invoked ALSO when 'pushHistory()' is invoked\r\n\r\n\t\tif( onChangedCallbacksRegistered == false )\r\n\t\t{\r\n\t\t\t$(window).bind( 'popstate', function(evt)\r\n\t\t\t\t{\r\n\t\t\t\t\tonChangedCallbacks.trigger( onChangedEvent );\r\n\t\t\t\t} );\r\n\t\t\tonChangedCallbacksRegistered = true;\r\n\t\t}\r\n\r\n\t\tonChangedCallbacks.bind( onChangedEvent, callback );\r\n\t}\r\n\r\n\texport function createUrl(p:{ pathname?:string, parameters?:{[key:string]:any} }) : string\r\n\t{\r\n\t\tvar newPath = p.pathname;\r\n\t\tif( newPath == null )\r\n\t\t\tnewPath = window.location.pathname;\r\n\r\n\t\tif( p.parameters != null )\r\n\t\t{\r\n\t\t\tconst queryString = stringifyParameters( p.parameters );\r\n\t\t\tif( queryString.length > 0 )\r\n\t\t\t\tnewPath = newPath+'?'+queryString;\r\n\t\t}\r\n\t\treturn newPath;\r\n\t}\r\n\r\n\t/** Change the browser's current URL without triggering an HTTP request (NB: Will trigger any registered 'onChanged()' callbacks) */\r\n\texport function pushHistory(p:{ pathname?:string, parameters?:{[key:string]:any}, newTitle?:string }) : void\r\n\t{\r\n\t\tconst newPath = createUrl( p );\r\n\t\twindow.history.pushState( {}, p.newTitle, newPath );\r\n\r\n\t\t// Invoke any registered callbacks\r\n\t\tonChangedCallbacks.trigger( onChangedEvent );\r\n\t}\r\n\r\n\t// nb: ES5 incompatible ; requires \"Promise\" library\r\n\texport function postRequest<T>(url:string, request:{[key:string]:any}) : Promise<T>\r\n\t{\r\n\t\tlet requestStr = JSON.stringify( request );\r\n\t\treturn new Promise<T>( (resolve,reject)=>\r\n\t\t\t{\r\n\t\t\t\t$.ajax({\ttype\t\t: 'POST',\r\n\t\t\t\t\t\t\turl\t\t\t: url,\r\n\t\t\t\t\t\t\tcontentType\t: 'application/json',\r\n\t\t\t\t\t\t\tdata\t\t: requestStr,\r\n\t\t\t\t\t\t\tdataType\t: 'json',\r\n\t\t\t\t\t\t\tsuccess\t\t: (data,textStatus,jqXHR)=>resolve( data ),\r\n\t\t\t\t\t\t\terror\t\t: (jqXHR,textStatus,errorThrown)=>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\treject( textStatus );\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t} );\r\n\t}\r\n\r\n\t// nb: ES5 incompatible ; requires \"Promise\" library\r\n\texport function getRequest(url:string, request?:{[key:string]:any}) : Promise<string>\r\n\t{\r\n\t\tif( request != null )\r\n\t\t{\r\n\t\t\tconst parms = stringifyParameters( request );\r\n\t\t\turl = `${url}?${parms}`;\r\n\t\t}\r\n\r\n\t\treturn new Promise<string>( (resolve,reject)=>\r\n\t\t\t{\r\n\t\t\t\t$.ajax({\ttype\t\t: 'GET',\r\n\t\t\t\t\t\t\turl\t\t\t: url,\r\n\t\t\t\t\t\t\tcontentType\t: 'text/html',\r\n\t\t\t\t\t\t\tsuccess\t\t: (data,textStatus,jqXHR)=>resolve( data ),\r\n\t\t\t\t\t\t\terror\t\t: (jqXHR,textStatus,errorThrown)=>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\treject( textStatus );\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t} );\r\n\t}\r\n\r\n\texport function downloadFile(url:string) : void\r\n\t{\r\n\t\t$(document.body).append( $(\"<iframe/>\").attr({\tsrc\t\t: url,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle\t: 'visibility:hidden;display:none' })\r\n\t\t\t\t\t\t\t\t);\r\n\t}\r\n\r\n} // namespace url\r\n\r\n// nb: Exports at the end or the order of execution breaks everything (i.e. strEnum must be defined before) ...\r\nexport * from \"../Language\";\r\nexport * from \"../PageHelper\";\r\nexport * from \"../Routes\";\r\n"]}