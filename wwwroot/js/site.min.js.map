{"version":3,"sources":["node_modules/browser-pack/_prelude.js","global.ts","src/DTOs/Item.ts","src/Language.ts","src/Services/ItemController.ts","src/Services/ItemPictureController.ts","src/Utils/BaseAutoItem.ts","src/Views/ItemTTT/Add.ts","src/Views/ItemTTT/Edit.ts","src/Views/ItemTTT/ItemTTTController.ts","src/Views/ItemTTT/List.ts","src/Views/common.ts"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","ttt","common","itemttt","list","add","edit","window","ItemKO","_super","$container","src","_this","name","self","this","price","utils","ensureInteger","observable","canBeZero","canBeNull","mustBePositive","__extends","prototype","toDictObj","dict","BaseAutoItem","Languages","_a","strEnum","allLanguages","getUrlCode","originalCode","stringIsNullOrWhitespace","url","getRequest","routes","api","sent","details","itemDetails","replace","itemCodeParameter","postRequest","rc","item","result","save","itemSave","newCode","delete_","itemDelete","upload","itemCode","file","itemPictureUpload","formData","FormData","append","Promise","resolve","reject","$","ajax","type","contentType","processData","data","dataType","success","textStatus","jqXHR","imageNumber","error","errorThrown","fieldTagAttribute","fieldNames","knockoutify","dictKO","each","fieldName","fromDictObj","find","attr","ko","push","$blockingDiv","dto","ctrl","log","obj","html","block","unblock","itemTTT","itemEdit","redirect","showMessage","errorMessage","init","$fieldsContainer","applyBindings","$btnSave","click","picCtrl","message_saveSuccess","message_refreshFailed","newUrl","pushHistory","pathname","newTitle","refresh","itemsList","languageParameter","pageParameters","currentLanguage","uploadPicture","files","undefined","tasks","map","all","rcs","$dropZone","$upload","model","$btnDelete","$picUploadDropZone","$picUploadControl","picDropZone","hover","on","stopPropagation","preventDefault","originalEvent","dataTransfer","ViewModes","allViewModes","_b","SortingFields","allSortingFields","getListContent","currentSortingField","$divCarsList","ItemTTTController_1","refreshList","noLayout","sortingField","name_desc","price_desc","$btnViewGrid","viewMode","grid","$btnViewList","$btnSortName","$btnSortPrice","debugMessages","optionalParams","_i","arguments","isDebug","console","apply","reduce","res","key","Object","create","stringIsNullOrEmpty","str","trim","htmlEncode","txt","Array","isArray","v","document","createElement","text","join","arrayContains","indexOf","arrayRemoveItem","splice","arraySum","forEach","arrayMoveItem","direction","j","tmp","fallbackValue","subscribe","value","newValue","parseInt","isNaN","newGuid","S4","Math","random","toString","substring","sleep","ms","setTimeout","msg","$div","dialog","$e","blockCounter","ensureVisible","offset","top","height","animate","scrollTop","effect","url_1","onChangedEvent","onChangedCallbacks","onChangedCallbacksRegistered","stringifyParameters","parms","pairs","encodeURIComponent","JSON","stringify","createUrl","newPath","location","parameters","queryString","href","parseParameters","searchString","search","tokens","split","decodeURIComponent","parse","ex","onChanged","callback","bind","evt","trigger","history","pushState","request","requestStr","downloadFile","body","style","__export"],"mappings":"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","file":"site.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","\r\nimport * as common\t\tfrom \"./src/Views/common\";\r\nimport * as itemlist\tfrom \"./src/Views/ItemTTT/List\";\r\nimport * as itemadd\t\tfrom \"./src/Views/ItemTTT/Add\";\r\nimport * as itemedit\tfrom \"./src/Views/ItemTTT/Edit\";\r\n\r\n///////\r\n\r\n// Global assignment of window.itemttt (will be available in each pages e.g. from the console):\r\nvar ttt =\r\n{\r\n\tcommon: common,\r\n\titemttt: {\r\n\t\tlist\t: itemlist,\r\n\t\tadd\t\t: itemadd,\r\n\t\tedit\t: itemedit,\r\n\t},\r\n}\r\ndeclare global\r\n{\r\n\tinterface Window { ttt: typeof ttt; }\r\n}\r\nwindow.ttt = ttt;\r\n","\nimport * as common from \"../Views/common\";\nimport { BaseAutoItem, DictObj } from \"../Utils/BaseAutoItem\";\nexport { DictObj, DictKO } from \"../Utils/BaseAutoItem\";\n\nexport interface Item extends DictObj\n{\n}\n\nexport class ItemKO extends BaseAutoItem\n{\n\tpublic readonly code\t\t\t: KnockoutObservable<string>;\n\tpublic readonly name\t\t\t: KnockoutObservable<string>;\n\tpublic readonly price\t\t\t: KnockoutObservable<number>;\n\n\tconstructor($container:JQuery, src?:Item)\n\t{\n\t\tif( src == null )\n\t\t\tsrc = { name:'' };\n\t\tsuper( $container, src );\n\t\tconst self = this;\n\n\t\tif( self.price != null )\n\t\t\tcommon.utils.ensureInteger({ observable:self.price, canBeZero:false, canBeNull:true, mustBePositive:true });\n\t}\n\n\tpublic /*override*/ toDictObj(dict?:DictObj) : Item\n\t{\n\t\tconst rc = super.toDictObj( dict );\n\t\treturn <Item>rc;\n\t}\n}\n","\nimport * as common from \"./Views/common\";\n\nexport const { e:Languages, a:allLanguages } = common.utils.strEnum([ 'en', 'fr', 'nl' ]);\nexport type Language = keyof typeof Languages;\n","\nimport * as common from \"../Views/common\";\nimport { Item } from \"../DTOs/Item\";\nimport Result from \"../Utils/TTTServiceResult\";\n\nexport async function getUrlCode(originalCode:string) : Promise<string>\n{\n\tif( common.utils.stringIsNullOrWhitespace(originalCode) )\n\t\treturn null;\n\treturn await common.url.getRequest( common.routes.api.getUrlCode, { originalCode } );\n}\n\nexport async function details(code:string) : Promise<DetailsResult>\n{\n\tconst url = common.routes.api.itemDetails.replace( common.routes.itemCodeParameter, code );\n\tconst rc = await common.url.postRequest<DetailsResult>( url, {} );\n\trc.item = rc.result;\n\tdelete rc.result;\n\treturn rc;\n}\nexport interface DetailsResult extends Result\n{\n\titem : Item;\n}\n\nexport async function save(p:SaveRequest) : Promise<SaveResult>\n{\n\tconst rc = await common.url.postRequest<SaveResult>( common.routes.api.itemSave, p );\n\trc.newCode = rc.result;\n\tdelete rc.result;\n\treturn rc;\n}\nexport interface SaveRequest\n{\n\toriginalCode?\t: string;\n\titem\t\t\t: Item;\n}\nexport interface SaveResult extends Result\n{\n\tnewCode : string;\n}\n\nexport async function delete_(code:string) : Promise<SaveResult>\n{\n\tconst url = common.routes.api.itemDelete.replace( common.routes.itemCodeParameter, code );\n\tconst rc = await common.url.postRequest<SaveResult>( url, {} );\n\treturn rc;\n}\n","\nimport * as common from \"../Views/common\";\nimport Result from \"../Utils/TTTServiceResult\";\n\nexport function upload(itemCode:string, file:File) : Promise<UploadResult>\n{\n\tconst url = common.routes.api.itemPictureUpload.replace( common.routes.itemCodeParameter, itemCode );\n\tconst formData = new FormData();\n\tformData.append( 'file', file );\n\treturn new Promise<UploadResult>( (resolve,reject)=>\n\t\t{\n\t\t\t$.ajax( {\ttype\t\t: \"POST\",\n\t\t\t\t\t\turl\t\t\t: url,\n\t\t\t\t\t\tcontentType\t: false,\n\t\t\t\t\t\tprocessData\t: false,\n\t\t\t\t\t\tdata\t\t: formData,\n\t\t\t\t\t\tdataType\t: 'json',\n\t\t\t\t\t\tsuccess\t\t: (data:UploadResult,textStatus,jqXHR)=>\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tdata.imageNumber = data.result;\n\t\t\t\t\t\t\t\t\t\t\tdelete data.result;\n\t\t\t\t\t\t\t\t\t\t\tresolve( data );\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\terror\t\t: (jqXHR,textStatus,errorThrown)=>\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\treject( textStatus );\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t} );\n\t\t} );\n}\nexport interface UploadResult extends Result\n{\n\timageNumber : number;\n}\n","\nconst fieldTagAttribute = 'ttt-name';\n\nexport type DictObj\t= {[key:string]:any};\nexport type DictKO\t= {[key:string]:KnockoutObservable<any>};\n\nexport abstract class BaseAutoItem\n{\n\tprivate readonly fieldNames : string[];\n\n\tconstructor($container:JQuery, src:DictObj)\n\t{\n\t\tthis.fieldNames = [];\n\t\tthis.knockoutify( $container, src );\n\t}\n\n\tpublic toDictObj(dict?:DictObj) : DictObj\n\t{\n\t\tconst self = this;\n\t\tconst dictKO : DictKO = <any>self;\n\t\tif( dict == null )\n\t\t\tdict = {};\n\n\t\t$.each( self.fieldNames, (i,fieldName)=>\n\t\t\t{\n\t\t\t\tconst observable = dictKO[ fieldName ];\n\t\t\t\tdict[ fieldName ] = observable();\n\t\t\t} );\n\n\t\treturn dict;\n\t}\n\n\tpublic fromDictObj(dict:DictObj) : void\n\t{\n\t\tconst self = this;\n\t\tconst dictKO : DictKO = <any>self;\n\t\t$.each( self.fieldNames, (i,fieldName)=>\n\t\t\t{\n\t\t\t\tconst observable = dictKO[ fieldName ];\n\t\t\t\tobservable( dict[fieldName] );\n\t\t\t} );\n\t}\n\n\tprivate knockoutify($container:JQuery, src:DictObj) : void\n\t{\n\t\tconst self = this;\n\t\tconst dict : DictKO = <any>this;\n\n\t\t// For each tagged elements we find in '$container' ...\n\t\t$container.find( `[${fieldTagAttribute}]` ).each( (i,e)=>\n\t\t\t{\n\t\t\t\tconst $e = $(e);\n\t\t\t\tconst fieldName = $e.attr( fieldTagAttribute );\n\n\t\t\t\t// ... create a KO observable on 'this' and set it's value using 'src' ...\n\t\t\t\tdict[ fieldName ] = ko.observable( src[fieldName] );\n\n\t\t\t\t// ... and register this field to 'fieldNames'\n\t\t\t\tself.fieldNames.push( fieldName );\n\t\t\t} );\n\t}\n}\n","\nimport * as common from \"../common\";\nimport * as dto from \"../../DTOs/Item\";\nimport * as ctrl from \"../../Services/ItemController\";\n\nvar $blockingDiv : JQuery;\nexport var item : dto.ItemKO;\n\nexport async function init(p:{\t$blockingDiv\t\t: JQuery,\n\t\t\t\t\t\t\t\t$btnSave\t\t\t: JQuery,\n\t\t\t\t\t\t\t\t$fieldsContainer\t: JQuery }) : Promise<void>\n{\n\tcommon.utils.log( 'add.init() START', { p } );\n\t$blockingDiv = p.$blockingDiv;\n\n\tcommon.utils.log( 'add.init(): Create KO item' );\n\titem = new dto.ItemKO( p.$fieldsContainer );\n\n\tcommon.utils.log( 'add.init(): Apply KO item' );\n\tko.applyBindings( item, p.$fieldsContainer[0] );\n\n\tcommon.utils.log( 'add.init(): Bind JQuery events' );\n\tp.$btnSave.click( save );\n\n\tcommon.utils.log( 'add.init() END' );\n}\n\nasync function save() : Promise<void>\n{\n\tcommon.utils.log( 'add.save(): START' );\n\n\tconst obj = item.toDictObj();\n\n\tcommon.utils.log( 'add.save(): Launch save' );\n\tcommon.html.block( $blockingDiv );\n\tconst rc = await ctrl.save({ item:obj });\n\tcommon.html.unblock( $blockingDiv );\n\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'add.save(): Error', { rc } );\n\t\tcommon.html.showMessage( rc.errorMessage );\n\t\treturn;\n\t}\n\n\tcommon.utils.log( 'add.save(): Redirect', { rc } );\n\tconst url = common.routes.itemTTT.itemEdit.replace( common.routes.itemCodeParameter, rc.newCode );\n\tcommon.utils.log( `add.save(): url=\"${url}\"` );\n\tcommon.url.redirect( url );\n\n\tcommon.utils.log( 'add.save(): END' );\n}\n","\nimport * as common from \"../common\";\nimport * as dto from \"../../DTOs/Item\";\nimport * as ctrl from \"../../Services/ItemController\";\nimport * as picCtrl from \"../../Services/ItemPictureController\";\n\nconst message_saveSuccess = 'Item saved successfully';\nconst message_refreshFailed = 'An error occured while refresing the data: ';\n\nvar $blockingDiv : JQuery;\nvar originalCode : string;\nexport var item : dto.ItemKO;\n\nexport var picDropZone : { hover:KnockoutObservable<boolean> };\n\nexport async function init(p:{\tmodel\t\t\t\t: dto.Item,\n\t\t\t\t\t\t\t\t$blockingDiv\t\t: JQuery,\n\t\t\t\t\t\t\t\t$btnSave\t\t\t: JQuery,\n\t\t\t\t\t\t\t\t$btnDelete\t\t\t: JQuery,\n\t\t\t\t\t\t\t\t$fieldsContainer\t: JQuery,\n\t\t\t\t\t\t\t\t$picUploadDropZone\t: JQuery,\n\t\t\t\t\t\t\t\t$picUploadControl\t: JQuery,\n\t\t\t\t\t\t\t}) : Promise<void>\n{\n\tcommon.utils.log( 'edit.init() START', { p } );\n\t$blockingDiv = p.$blockingDiv;\n\n\tcommon.utils.log( 'edit.init(): Create KO item' );\n\titem = new dto.ItemKO( p.$fieldsContainer, p.model );\n\toriginalCode = item.code();\n\n\tcommon.utils.log( 'edit.init(): Apply KO item bindings' );\n\tko.applyBindings( item, p.$fieldsContainer[0] );\n\n\tcommon.utils.log( 'edit.init(): Bind JQuery events' );\n\tp.$btnSave.click( save );\n\tp.$btnDelete.click( delete_ );\n\n\tcommon.utils.log( 'edit.init(): Initi picture upload' );\n\tinitPictureUpload( p.$picUploadDropZone, p.$picUploadControl );\n\n\tcommon.utils.log( 'edit.init() END' );\n}\n\nfunction initPictureUpload($dropZone:JQuery, $upload:JQuery) : void\n{\n\tcommon.utils.log( 'edit.initDropZone(): Create drop zone object' );\n\n\tpicDropZone = {\n\t\t\thover : ko.observable(false),\n\t\t};\n\n\tcommon.utils.log( 'edit.initDropZone(): Watch for drag-drops on \"upload image drop zone\"' );\n\n\t$dropZone.on( 'dragenter', function(e)\n\t\t{\n\t\t\tpicDropZone.hover( true );\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t} );\n\t$dropZone.on( 'dragover', function(e)\n\t\t{\n\t\t\tpicDropZone.hover( true );\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t} );\n\t$dropZone.on( 'dragleave', function(e)\n\t\t{\n\t\t\tpicDropZone.hover( false );\n\t\t} );\n\t$dropZone.on( 'drop', function(e)\n\t\t{\n\t\t\tpicDropZone.hover( false );\n\t\t\te.preventDefault();\n\n\t\t\tvar files = (<any>e.originalEvent).dataTransfer.files;\n\t\t\tuploadPicture( files );\n\t\t});\n\n\t$upload.on( 'change', ()=>\n\t\t{\n\t\t\tconst files = (<HTMLInputElement>$upload[0]).files;\n\t\t\tuploadPicture( files );\n\t\t} );\n\n\tcommon.utils.log( 'edit.initDropZone(): Apply KO bindings' );\n\tko.applyBindings( picDropZone, $dropZone[0] );\n}\n\nasync function save() : Promise<void>\n{\n\tcommon.utils.log( 'edit.save(): START' );\n\n\tconst obj = item.toDictObj();\n\n\tcommon.utils.log( 'edit.save(): Launch save' );\n\tcommon.html.block( $blockingDiv );\n\tconst rc = await ctrl.save({ originalCode, item:obj });\n\tcommon.html.unblock( $blockingDiv );\n\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'edit.save(): Error', { rc } );\n\t\tcommon.html.showMessage( rc.errorMessage );\n\t\treturn;\n\t}\n\n\tcommon.utils.log( 'edit.save(): Refresh values', { rc } );\n\tconst rcr = await refresh( rc.newCode );\n\tif( rcr )\n\t\tcommon.html.showMessage( message_saveSuccess );\n\n\tcommon.utils.log( 'edit.save(): END' );\n}\n\nasync function delete_() : Promise<void>\n{\n\tcommon.utils.log( 'edit.delete(): START' );\n\n\tcommon.utils.log( 'edit.delete(): Launch delete' );\n\tcommon.html.block( $blockingDiv );\n\tconst rc = await ctrl.delete_( originalCode );\n\tcommon.html.unblock( $blockingDiv );\n\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'edit.delete(): Error', { rc } );\n\t\tcommon.html.showMessage( rc.errorMessage );\n\t\treturn;\n\t}\n\n\tcommon.utils.log( 'edit.delete(): Redirect' );\n\tconst url = common.routes.itemTTT.itemsList.replace( common.routes.languageParameter, common.pageParameters.currentLanguage );\n\tcommon.utils.log( 'edit.delete()', { url } );\n\tcommon.url.redirect( url );\n\n\tcommon.utils.log( 'edit.delete(): END' );\n}\n\nasync function uploadPicture(files:FileList) : Promise<void>\n{\n\tcommon.utils.log( 'edit.uploadPicture(): START', {files} );\n\n\tif( files.length == 0 )\n\t\treturn;\n\tif( (<any>window).FormData === undefined )\n\t{\n\t\tcommon.utils.error( \"This browser doesn't support HTML5 file uploads!\" );\n\t\treturn;\n\t}\n\n\tcommon.utils.log( `edit.uploadPicture(): Create '${files.length}' upload tasks` );\n\tcommon.html.block( $blockingDiv );\n\tconst tasks = $.map( files, (file:File)=>\n\t\t{\n\t\t\treturn picCtrl.upload( originalCode, file );\n\t\t} );\n\n\tcommon.utils.log( 'edit.uploadPicture(): Wait for tasks to terminate' );\n\tconst rcs = await Promise.all( tasks );\n\tcommon.html.unblock( $blockingDiv );\n\tcommon.utils.log( 'edit.uploadPicture(): All tasks terminated' );\n\n\t$.each( rcs, (i,rc)=>\n\t\t{\n\t\t\tif(! rc )\n\t\t\t{\n\t\t\t\tcommon.utils.error( 'edit.delete(): Upload error', { i, rc } );\n\t\t\t\tcommon.html.showMessage( rc.errorMessage );\n\t\t\t}\n\t\t} );\n\n// TODO: Refresh pictures\n\tcommon.utils.log( 'edit.uploadPicture(): END' );\n}\n\nasync function refresh(code?:string) : Promise<boolean>\n{\n\tcommon.utils.log( 'edit.refresh(): START' );\n\n\tlet newUrl : string = null;\n\tif( code == null )\n\t{\n\t\tcode = originalCode;\n\t}\n\telse\n\t{\n\t\tif( originalCode != code )\n\t\t\t// URL must change!\n\t\t\tnewUrl = common.routes.itemTTT.itemEdit.replace( common.routes.itemCodeParameter, code );\n\t\toriginalCode = code;\n\t}\n\n\tcommon.utils.log( 'edit.refresh(): Launch request' );\n\tcommon.html.block( $blockingDiv );\n\tconst rc = await ctrl.details( code );\n\tcommon.html.unblock( $blockingDiv );\n\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'edit.refresh(): Error', { rc } );\n\t\tcommon.html.showMessage( message_refreshFailed+rc.errorMessage );\n\t\treturn false;\n\t}\n\n\tcommon.utils.log( 'edit.refresh(): Load from new item', { rc } );\n\titem.fromDictObj( rc.item );\n\n\tif( newUrl != null )\n\t{\n\t\tcommon.utils.log( `edit.refresh(): Update URL to \"${newUrl}\"` );\n\t\tcommon.url.pushHistory({ pathname:newUrl, newTitle:item.name() });\n\t}\n\n\tcommon.utils.log( 'edit.refresh(): END' );\n\treturn true;\n}\n","\nimport * as common from \"../common\";\n\nexport namespace list\n{\n\texport const { e:ViewModes, a:allViewModes } = common.utils.strEnum([ 'grid', 'list' ]);\n\texport type ViewMode = keyof typeof ViewModes;\n\n\texport const { e:SortingFields, a:allSortingFields } = common.utils.strEnum([ 'price', 'price_desc', 'name', 'name_desc' ]);\n\texport type SortingField = keyof typeof SortingFields;\n\n\texport async function getListContent(p:GetListContentRequest) : Promise<string>\n\t{\n\t\tvar url = common.routes.itemTTT.itemsList.replace( common.routes.languageParameter, common.pageParameters.currentLanguage );\n\t\treturn await common.url.getRequest( url, p );\n\t}\n\texport interface GetListContentRequest\n\t\t{\n\t\t\tviewMode?\t\t: ViewMode,\n\t\t\tsortingField?\t: SortingField,\n\t\t\tnoLayout?\t\t: boolean,\n\t\t};\n}\n","\nimport * as common from \"../common\";\nimport { list } from \"./ItemTTTController\";\n\nvar currentSortingField : list.SortingField;\nvar $divCarsList : JQuery;\n\nexport async function init(p:{\tsortingField\t: list.SortingField,\n\t\t\t\t\t\t\t\t$divCarsList\t: JQuery,\n\t\t\t\t\t\t\t\t$btnViewList\t: JQuery,\n\t\t\t\t\t\t\t\t$btnViewGrid\t: JQuery,\n\t\t\t\t\t\t\t\t$btnSortName\t: JQuery,\n\t\t\t\t\t\t\t\t$btnSortPrice\t: JQuery }) : Promise<void>\n{\n\tcommon.utils.log( 'list.init() START' );\n\n\tcurrentSortingField\t= p.sortingField;\n\t$divCarsList\t\t= p.$divCarsList;\n\tp.$btnViewGrid\t.click( ()=>{ refreshList({ viewMode:list.ViewModes.grid }) } );\n\tp.$btnViewList\t.click( ()=>{ refreshList({ viewMode:list.ViewModes.list }) } );\n\tp.$btnSortName\t.click( ()=>{ refreshList({ sortingField:list.SortingFields.name }) } );\n\tp.$btnSortPrice\t.click( ()=>{ refreshList({ sortingField:list.SortingFields.price }) } );\n\n\tcommon.utils.log( 'list.init() END' );\n}\n\nasync function refreshList(p:list.GetListContentRequest) : Promise<void>\n{\n\tcommon.utils.log( 'list.refreshList() START', { p, currentSortingField } );\n\n\t// Ask for the stripped version of the page (no layout)\n\tp.noLayout = true;\n\n\t// Switch to descending order if required\n\tif( p.sortingField != null )\n\t{\n\t\tif( p.sortingField == currentSortingField )\n\t\t{\n\t\t\tswitch( currentSortingField )\n\t\t\t{\n\t\t\t\tcase list.SortingFields.name:\tp.sortingField = list.SortingFields.name_desc;\tbreak;\n\t\t\t\tcase list.SortingFields.price:\tp.sortingField = list.SortingFields.price_desc;\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tcurrentSortingField = p.sortingField;\n\t}\n\n\t// GET and replace list DOM\n\tvar html = await list.getListContent( p );\n\t$divCarsList.html( html );\n\n\tcommon.utils.log( 'list.refresh() END', { currentSortingField } );\n}\n\n","\r\nimport * as common from \"./common\";\r\nimport { PageParameters } from \"../PageHelper\";\r\nimport { Routes } from \"../Routes\";\r\n\r\n\r\nexport const debugMessages : boolean = false;  // NB: 'export' so that it can be easily changed from the browser's console\r\nexport var pageParameters : PageParameters;\r\nexport var routes : Routes;\r\n\r\nexport function init(p:{ pageParameters:PageParameters })\r\n{\r\n\tpageParameters = p.pageParameters;\r\n\troutes = pageParameters.routes;\r\n\tutils.log( 'common.init()' );\r\n}\r\n\r\nexport namespace utils\r\n{\r\n\texport function log(...optionalParams: any[]) : void\r\n\t{\r\n\t\tif( pageParameters.isDebug )\r\n\t\t\tconsole.log.apply( console, arguments );\r\n\t}\r\n\r\n\texport function error(...optionalParams: any[]) : void\r\n\t{\r\n\t\tconsole.error.apply( console, arguments );\r\n\t}\r\n\r\n\t/** Function to simulate string-valued enums\r\n\t * Based on: https://basarat.gitbooks.io/typescript/docs/types/literal-types.html\r\n\t * Returns: { e:the enum , a:the array specified as parameter } */\r\n\texport function strEnum<T extends string>(a:Array<T>): { e:{[K in T]: K}, a:T[] }\r\n\t{\r\n\t\tconst e = a.reduce( (res, key)=>\r\n\t\t\t{\r\n\t\t\t\tres[key] = key;\r\n\t\t\t\treturn res;\r\n\t\t\t}, Object.create(null) );\r\n\t\treturn { e, a };\r\n\t}\r\n\r\n\texport function stringIsNullOrEmpty(str:string) : boolean\r\n\t{\r\n\t\tif( str == null )\r\n\t\t\treturn true;\r\n\t\tif( str == '' )\r\n\t\t\treturn true;\r\n\t\treturn false;\r\n\t}\r\n\texport function stringIsNullOrWhitespace(str:string) : boolean\r\n\t{\r\n\t\tif( str == null )\r\n\t\t\treturn true;\r\n\t\tif( str.trim() == '' )\r\n\t\t\treturn true;\r\n\t\treturn false;\r\n\t}\r\n\r\n\texport function htmlEncode(txt:string|string[]) : string\r\n\t{\r\n\t\t// TODO: Find a better way ?\r\n\t\tif( Array.isArray(txt) )\r\n\t\t\treturn $.map( <string[]>txt, v=>$(document.createElement('span')).text( v ).html() ).join( '<br/>' );\r\n\t\telse\r\n\t\t\treturn $(document.createElement('span')).text( txt ).html();\r\n\t}\r\n\r\n\texport function arrayContains<T>(a:T[], item:any) : boolean\r\n\t{\r\n\t\treturn ( a.indexOf( item ) >= 0 );\r\n\t}\r\n\r\n//ES5 incompatible ...\r\n//\texport function arrayUnique<T>(a:T[]) : T[]\r\n//\t{\r\n//\t\t//return a.filter( (v,i)=>( a.indexOf(v) === i ) );\r\n//\t\treturn [ ... new Set(a) ];\r\n//\t}\r\n\r\n\texport function arrayRemoveItem<T>(a:T[], item:T) : boolean\r\n\t{\r\n\t\tlet i = a.indexOf( item );\r\n\t\tif( i < 0 )\r\n\t\t\treturn false;\r\n\t\ta.splice( i, 1 );\r\n\t\treturn true;\r\n\t}\r\n\r\n\texport function arraySum<T>(a:T[], f:(e:T)=>number) : number\r\n\t{\r\n\t\tlet rc = 0;\r\n\t\ta.forEach( function(e)\r\n\t\t\t{\r\n\t\t\t\trc += f(e);\r\n\t\t\t} );\r\n\t\treturn rc;\r\n\t}\r\n\r\n\texport function arrayMoveItem<T>(p:{ list:T[], item:T, direction?:'up'|'down' }) : T[]\r\n\t{\r\n\t\t// NB: Does not yet work when n>1 ...\r\n\r\n\t\tlet n = 1;\r\n\t\tif( p.direction != null )\r\n\t\t\tn = (p.direction == 'up') ? -n : n;\r\n\t\tconst i = p.list.indexOf( p.item );  // Start position\r\n\t\tif( i < 0 )\r\n\t\t\tthrow { error:'Could not find item in list', item:p.item };\r\n\t\tlet j = i + n;  // End position\r\n\t\tif( j < 0 )\r\n\t\t\tj = 0;\r\n\t\telse if( j >= p.list.length )\r\n\t\t\tj = p.list.length - 1;\r\n\t\tif( i == j )\r\n\t\t\t// NOOP\r\n\t\t\treturn p.list;\r\n\r\n\t\t// Swap items here\r\n\t\tconst tmp = p.list[ i ];\r\n\t\tp.list[ i ] = p.list[ j ];\r\n\t\tp.list[ j ] = tmp;\r\n\r\n\t\treturn p.list;\r\n\t}\r\n\r\n\texport function ensureInteger(p:{\tobservable:KnockoutObservable<Number>,\r\n\t\t\t\t\t\t\t\t\t\tfallbackValue?:number,\r\n\t\t\t\t\t\t\t\t\t\tmustBePositive?:boolean,\r\n\t\t\t\t\t\t\t\t\t\tcanBeZero?:boolean,\r\n\t\t\t\t\t\t\t\t\t\tcanBeNull?:boolean }) : void\r\n\t{\r\n\t\tif( p.canBeZero == null )\r\n\t\t\tp.canBeZero = true;\r\n\t\tif( p.canBeNull == null )\r\n\t\t\tp.canBeNull = false;\r\n\t\tif( p.fallbackValue == null )\r\n\t\t{\r\n\t\t\tif( p.canBeZero )\r\n\t\t\t\tp.fallbackValue = 0;\r\n\t\t\telse\r\n\t\t\t\tp.fallbackValue = 1;\r\n\t\t}\r\n\r\n\t\tlet canBeNull = p.canBeNull;\r\n\t\tp.observable.subscribe( function(value:number)\r\n\t\t\t{\r\n\t\t\t\tif( canBeNull )\r\n\t\t\t\t{\r\n\t\t\t\t\tif( (<any>value == '') || (value == null) )\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tp.observable( null );\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar newValue = parseInt( <any>value );\r\n\r\n\t\t\t\tif( isNaN(newValue) )\r\n\t\t\t\t\tnewValue = p.fallbackValue;\r\n\t\t\t\telse if( (!p.canBeZero) && (value == 0) )\r\n\t\t\t\t\tnewValue = p.fallbackValue;\r\n\t\t\t\telse if( (p.mustBePositive) && (value < 0) )\r\n\t\t\t\t\tnewValue = p.fallbackValue;\r\n\r\n\t\t\t\tif( value !== newValue )\r\n\t\t\t\t\t// Value must be changed\r\n\t\t\t\t\tp.observable( newValue );\r\n\t\t\t} );\r\n\t}\r\n\r\n\t/** Generates a GUID-like string (something that looks like one, but NOT a real one!!!)\r\n\t * cf. http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript */\r\n\texport function newGuid() : string\r\n\t{\r\n\t\tvar S4 = function() : string\r\n\t\t{\r\n\t\t\treturn (((1+Math.random())*0x10000)|0).toString(16).substring(1);\r\n\t\t};\r\n\t\treturn (S4()+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+S4()+S4());\r\n\t}\r\n\r\n\texport function sleep(ms:number) : Promise<void>\r\n\t{\r\n\t\treturn new Promise( resolve => setTimeout(resolve, ms) );\r\n\t}\r\n} // namespace utils\r\n\r\nexport namespace html\r\n{\r\n\texport function showMessage(msg:string) : void\r\n\t{\r\n\t\tconst $div = $('<div/>').text( msg );\r\n\t\t$('body').append( $div );\r\n\t\t$div.dialog();\r\n\t}\r\n\r\n\t/** Invoke jQuery.blockUI's '.block()' on the specified element but supports multiple invokation on the same element */\r\n\texport function block($e:JQuery) : JQuery\r\n\t{\r\n\t\t// Insert/increment a block counter as jQuery 'data()'\r\n\t\tvar blockCounter = ( $e.data('common_blockCounter')|0 ) + 1;\r\n\t\t$e.data( 'common_blockCounter', blockCounter );\r\n\r\n\t\tif( blockCounter == 1 )\r\n\t\t\t// This element is not blocked yet\r\n\t\t\t(<any>$e).block();  // TODO: ACA: jQuery.blockUI typings ...\r\n\r\n\t\treturn $e;\r\n\t}\r\n\r\n\t/** Invoke jQuery.blockUI's '.unblock()' on the specified element except if it has been block()ed more than once */\r\n\texport function unblock($e:JQuery) : JQuery\r\n\t{\r\n\t\t// Decrement the block counter in the jQuery 'data()'\r\n\t\tvar blockCounter = ( $e.data('common_blockCounter')|0 ) - 1;\r\n\t\t$e.data( 'common_blockCounter', blockCounter );\r\n\r\n\t\tif( blockCounter < 0 )\r\n\t\t{\r\n\t\t\t// There is a logic error somewhere...\r\n\t\t\tcommon.utils.error( 'INTERNAL ERROR: Unblock count > block count:', blockCounter );\r\n\r\n\t\t\t// Reset counter\r\n\t\t\tblockCounter = 0;\r\n\t\t\t$e.data( 'common_blockCounter', 0 );\r\n\t\t}\r\n\r\n\t\tif( blockCounter == 0 )\r\n\t\t\t// This element is no more blocked by anything else\r\n\t\t\t(<any>$e).unblock();  // TODO: ACA: jQuery.blockUI typings ...\r\n\r\n\t\treturn $e;\r\n\t}\r\n\r\n\texport function ensureVisible($e:JQuery) : void\r\n\t{\r\n\t\t// Scroll\r\n\t\tconst offset = $e.offset().top - ( 20 + $e.height() );\r\n\t\t$('html, body').animate({ scrollTop:offset });  // cf.: https://stackoverflow.com/questions/4884839/how-do-i-get-an-element-to-scroll-into-view-using-jquery?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa\r\n\r\n\t\t// Blink\r\n\t\t$e.effect( \"highlight\", {}, 2000 );  // cf.: https://stackoverflow.com/questions/5205445/jquery-blinking-highlight-effect-on-div?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa\r\n\t}\r\n} // namespace html\r\n\r\nexport namespace url\r\n{\r\n\tconst onChangedEvent = 'onUrlChanged';\r\n\tvar onChangedCallbacks = $({});\r\n\tvar onChangedCallbacksRegistered = false;\r\n\r\n\texport function redirect(url:string)\r\n\t{\r\n\t\twindow.location.href = url;\r\n\t}\r\n\r\n\t/** Parse a parameters string like 'foo=bar&hello=world' and return the a dictionary like {foo:'bar',hello:'world'} */\r\n\texport function parseParameters(searchString?:string) : {[key:string]:any}\r\n\t{\r\n\t\tif( searchString == null )\r\n\t\t\tsearchString = window.location.search.substring(1);\r\n\t\tif( searchString.length == 0 )\r\n\t\t\treturn {};\r\n\r\n\t\tvar tokens = searchString.split( '&' );\r\n\r\n\t\tvar dict = <{[key:string]:any}>{};\r\n\t\tfor( var i=0; i < tokens.length; ++i )\r\n\t\t{\r\n\t\t\tvar pairs = tokens[i].split( '=' );\r\n\t\t\tvar key = decodeURIComponent( pairs[0] );\r\n\t\t\tvar value = decodeURIComponent( pairs[1] );\r\n\r\n\t\t\t// Try parse JSON\r\n\t\t\ttry { value = JSON.parse(value); }\r\n\t\t\tcatch( ex ){/* Not JSON => Keep the string as-is*/}\r\n\r\n\t\t\tdict[ key ] = value;\r\n\t\t}\r\n\t\treturn dict;\r\n\t}\r\n\r\n\t/** Transform a dictionary like {foo:'bar',hello:'world'} to a parameters string like 'foo=bar&hello=world' */\r\n\texport function stringifyParameters(parms:{[key:string]:any}) : string\r\n\t{\r\n\t\tvar pairs = <string[]>[];\r\n\t\t$.each( parms, function(key:string,value)\r\n\t\t\t{\r\n\t\t\t\tkey = encodeURIComponent( key );\r\n\r\n\t\t\t\tif( (value == null) || (typeof(value) === 'string') || (typeof(value) === 'number') || (typeof(value) === 'boolean') )\r\n\t\t\t\t\t{/*Keep as-is*/}\r\n\t\t\t\telse\r\n\t\t\t\t\t// Convert to JSON\r\n\t\t\t\t\tvalue = JSON.stringify( value );\r\n\t\t\t\tvalue = encodeURIComponent( value );\r\n\r\n\t\t\t\tpairs.push( key+\"=\"+value );\r\n\t\t\t} );\r\n\t\treturn pairs.join( '&' );\r\n\t}\r\n\r\n\t/** Registers a callback to be invoked whenever the browser's URL changes (cf. 'pushHistory()') */\r\n\texport function onChanged(callback:()=>void) : void\r\n\t{\r\n\t\t// NB: The callback gets invoked ALSO when 'pushHistory()' is invoked\r\n\r\n\t\tif( onChangedCallbacksRegistered == false )\r\n\t\t{\r\n\t\t\t$(window).bind( 'popstate', function(evt)\r\n\t\t\t\t{\r\n\t\t\t\t\tonChangedCallbacks.trigger( onChangedEvent );\r\n\t\t\t\t} );\r\n\t\t\tonChangedCallbacksRegistered = true;\r\n\t\t}\r\n\r\n\t\tonChangedCallbacks.bind( onChangedEvent, callback );\r\n\t}\r\n\r\n\texport function createUrl(p:{ pathname?:string, parameters?:{[key:string]:any} }) : string\r\n\t{\r\n\t\tvar newPath = p.pathname;\r\n\t\tif( newPath == null )\r\n\t\t\tnewPath = window.location.pathname;\r\n\r\n\t\tif( p.parameters != null )\r\n\t\t{\r\n\t\t\tconst queryString = stringifyParameters( p.parameters );\r\n\t\t\tif( queryString.length > 0 )\r\n\t\t\t\tnewPath = newPath+'?'+queryString;\r\n\t\t}\r\n\t\treturn newPath;\r\n\t}\r\n\r\n\t/** Change the browser's current URL without triggering an HTTP request (NB: Will trigger any registered 'onChanged()' callbacks) */\r\n\texport function pushHistory(p:{ pathname?:string, parameters?:{[key:string]:any}, newTitle?:string }) : void\r\n\t{\r\n\t\tconst newPath = createUrl( p );\r\n\t\twindow.history.pushState( {}, p.newTitle, newPath );\r\n\r\n\t\t// Invoke any registered callbacks\r\n\t\tonChangedCallbacks.trigger( onChangedEvent );\r\n\t}\r\n\r\n\t// nb: ES5 incompatible ; requires \"Promise\" library\r\n\texport function postRequest<T>(url:string, request:{[key:string]:any}) : Promise<T>\r\n\t{\r\n\t\tlet requestStr = JSON.stringify( request );\r\n\t\treturn new Promise<T>( (resolve,reject)=>\r\n\t\t\t{\r\n\t\t\t\t$.ajax({\ttype\t\t: 'POST',\r\n\t\t\t\t\t\t\turl\t\t\t: url,\r\n\t\t\t\t\t\t\tcontentType\t: 'application/json',\r\n\t\t\t\t\t\t\tdata\t\t: requestStr,\r\n\t\t\t\t\t\t\tdataType\t: 'json',\r\n\t\t\t\t\t\t\tsuccess\t\t: (data,textStatus,jqXHR)=>resolve( data ),\r\n\t\t\t\t\t\t\terror\t\t: (jqXHR,textStatus,errorThrown)=>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\treject( textStatus );\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t} );\r\n\t}\r\n\r\n\t// nb: ES5 incompatible ; requires \"Promise\" library\r\n\texport function getRequest(url:string, request?:{[key:string]:any}) : Promise<string>\r\n\t{\r\n\t\tif( request != null )\r\n\t\t{\r\n\t\t\tconst parms = stringifyParameters( request );\r\n\t\t\turl = `${url}?${parms}`;\r\n\t\t}\r\n\r\n\t\treturn new Promise<string>( (resolve,reject)=>\r\n\t\t\t{\r\n\t\t\t\t$.ajax({\ttype\t\t: 'GET',\r\n\t\t\t\t\t\t\turl\t\t\t: url,\r\n\t\t\t\t\t\t\tcontentType\t: 'text/html',\r\n\t\t\t\t\t\t\tsuccess\t\t: (data,textStatus,jqXHR)=>resolve( data ),\r\n\t\t\t\t\t\t\terror\t\t: (jqXHR,textStatus,errorThrown)=>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\treject( textStatus );\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t} );\r\n\t}\r\n\r\n\texport function downloadFile(url:string) : void\r\n\t{\r\n\t\t$(document.body).append( $(\"<iframe/>\").attr({\tsrc\t\t: url,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle\t: 'visibility:hidden;display:none' })\r\n\t\t\t\t\t\t\t\t);\r\n\t}\r\n\r\n} // namespace url\r\n\r\n// nb: Exports at the end or the order of execution breaks everything (i.e. strEnum must be defined before) ...\r\nexport * from \"../Language\";\r\nexport * from \"../PageHelper\";\r\nexport * from \"../Routes\";\r\n"]}