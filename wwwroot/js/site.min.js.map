{"version":3,"sources":["node_modules/browser-pack/_prelude.js","global.ts","src/DTOs/BlogPost.ts","src/DTOs/Item.ts","src/DTOs/Translation.ts","src/Language.ts","src/Services/BlogController.ts","src/Services/DynamicPageController.ts","src/Services/ItemController.ts","src/Services/ItemPictureController.ts","src/Services/LoginController.ts","src/Services/TestimonialController.ts","src/Services/TranslationController.ts","src/Utils/BaseAutoItem.ts","src/Views/Admin/Home.ts","src/Views/Blog/BlogController.ts","src/Views/Blog/Edit.ts","src/Views/Blog/List.ts","src/Views/DynamicPage/Show.ts","src/Views/ItemTTT/Add.ts","src/Views/ItemTTT/Edit.ts","src/Views/ItemTTT/ItemTTTController.ts","src/Views/ItemTTT/List.ts","src/Views/Testimonial/List.ts","src/Views/common.ts"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","ttt","common","admin","home","itemttt","list","add","edit","blog","testimonial","dynamicpage","show","window","BlogPostKO","src","this","id","ko","observable","date","imageHtml","titleHtmlEN","titleHtmlFR","titleHtmlNL","textHtmlEN","textHtmlFR","textHtmlNL","active","fromDTO","prototype","self","toDTO","dst","ItemKO","_super","$container","fieldNames","_this","features","pictures","price","utils","ensureInteger","canBeZero","canBeNull","mustBePositive","__extends","toDictObj","dict","BaseAutoItem","TranslationKO","en","fr","nl","TranslationItemKO","inOriginal","inTranslation","enOriginal","frOriginal","nlOriginal","modified","computed","setAllLanguagesTo","str","copyEnToBlanks","stringIsNullOrWhitespace","Languages","_a","strEnum","allLanguages","url","postRequestForm","routes","api","rc","sent","posts","result","uploadPicture","file","pictureUpload","formData","FormData","append","postRequestFormData","response","imageTagContent","save","post","postRequestJSON","delete_","delete","get","language","pageParameters","currentLanguage","dynamicPage","update","getUrlCode","originalCode","getRequest","details","items","replace","itemCodeParameter","item","newCode","upload","itemCode","imageNumber","number","reorder","newNumber","setMain","isMain","changePassword","testimonials","imageData","TranslationTypes","allTranslationTypes","translations","autoCompleteResolve","autoComplete","fieldTagAttribute","knockoutify","dictKO","$","each","fieldName","fromDictObj","find","attr","indexOf","push","forEach","loginCtrl","trnCtrl","trnDto","init","ChangePassword","$passwordBlockingDiv","Features","$featuresBlockingDiv","$blockingDiv","original","newPassword","newPasswordAgain","change","oldPassword","html","showMessage","block","unblock","success","error","errorMessage","TranslationsBase","type","observableArray","hasChanges","refresh","map","v","TranslationItem","clearLine","index","addLine","toSave","dto","filter","showReset","feature","languageParameter","isAdding","dtos","ctrl","message_confirmRefresh","message_confirmDelete","addKoTinymceEditor","bindingHandlers","tinymceEditor","element","valueAccessor","allBindings","viewModel","bindingContext","$element","tinymce","inline","plugins","setup","ed","on","log","$picUploadControl","files","undefined","$txtDate","datepicker","dateFormat","confirm","includeImages","includeInactives","itemIDParameter","redirect","apiCtrl","htmlCtrl","blogIdAttribute","loadImages","parseInt","removeAttr","model","__awaiter","applyBindings","lastPostItem","lastPost","Promise","resolve","waitForScrolledVisible","$endPostElement","postsIncrement","$spinner","noLayout","skipToID","take","hide","before","loopLoadNextPosts","Edit_1","newHtml","textHtml","text","obj","itemTTT","$fieldsContainer","$btnSave","click","picCtrl","Translation_1","message_saveSuccess","message_refreshFailed","message_confirmDeletePicture","tasks","all","rcs","newUrl","pushHistory","pathname","newTitle","name","$dropZone","$upload","$btnDelete","confirmed","$picUploadDropZone","picDropZone","hover","stopPropagation","preventDefault","originalEvent","dataTransfer","autoCompleteFeature","searchTerm","searchString","includeTranslations","deletePicture","picture","toggleMainPicture","isMainImage","reorderPicture","offset","scrambleUrl","newGuid","addNewFeature","ViewModes","allViewModes","_b","SortingFields","allSortingFields","getListContent","currentSortingField","$txtSearch","$cbShowInactive","$divCarsList","$divBlocking","itemCtrl","ItemTTTController_1","Language_1","modelSearchString","reconstructItemsList","$models","$modelElement","parent","JSON","parse","remove","itemsList","filterItemsList","visible","getIsVisible","refreshList","sortingField","name_desc","price_desc","prop","$btnViewGrid","viewMode","grid","$btnViewList","$btnSortName","$btnSortPrice","keyup","required","nameof","toggleActive","showInactive","is","val","toLowerCase","trim","searchWords","split","word","searchFields","descriptionEN","descriptionFR","descriptionNL","matchCount","i_1","message_imageUploadError","saveSuccessMessage","testimonialIdAttribute","imageUploadErrorMessage","formTestimonial","FormTestimonial","$formDialog","urlImgNotFound","isAutenticated","$e","TestimonialItem","rc1","saveRequest","extend","saveImage","rc2","location","reload","showRequiredText","firstLastName","whosWho","imageSrc","data","reset","open","modal","close","fields","html_1","debugMessages","hasErrors","logs","ttt_autocomplete","searchFunction","autocomplete","minLength","source","request","term","ttt_slideUpDownVisible","unwrap","slideDown","slideUp","ttt_slideLeftRightVisible","direction","ttt_blink","koValue","fadeIn","delay","fadeOut","optionalParams","_i","arguments","isDebug","console","apply","reduce","res","key","Object","create","stringIsNullOrEmpty","htmlEncode","txt","Array","isArray","document","createElement","join","arrayContains","arrayRemoveItem","splice","arraySum","arrayMoveItem","j","tmp","fallbackValue","subscribe","value","newValue","isNaN","S4","Math","random","toString","substring","sleep","ms","setTimeout","msg","$div","blockCounter","ensureVisible","top","height","animate","scrollTop","effect","$elem","$window","isScrolledVisible","docViewTop","docViewBottom","elemTop","scrollHandler","unbind","bind","url_1","onChangedEvent","onChangedCallbacks","onChangedCallbacksRegistered","stringifyParameters","parms","pairs","encodeURIComponent","stringify","createUrl","newPath","parameters","queryString","href","parseParameters","search","tokens","decodeURIComponent","ex","onChanged","callback","evt","trigger","history","pushState","reject","ajax","contentType","dataType","textStatus","jqXHR","errorThrown","processData","requestStr","downloadFile","body","style","__export"],"mappings":"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","file":"site.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","\r\nimport * as common\t\tfrom \"./src/Views/common\";\r\nimport * as adminhome\tfrom \"./src/Views/Admin/Home\";\r\nimport * as itemlist\tfrom \"./src/Views/ItemTTT/List\";\r\nimport * as itemadd\t\tfrom \"./src/Views/ItemTTT/Add\";\r\nimport * as itemedit\tfrom \"./src/Views/ItemTTT/Edit\";\r\nimport * as bloglist\tfrom \"./src/Views/Blog/List\";\r\nimport * as blogedit\tfrom \"./src/Views/Blog/Edit\";\r\nimport * as tstmlist\tfrom \"./src/Views/Testimonial/List\";\r\nimport * as dynpgshow\tfrom \"./src/Views/DynamicPage/Show\";\r\n\r\n///////\r\n\r\n// Global assignment of window.itemttt (will be available in each pages e.g. from the console):\r\nvar ttt =\r\n{\r\n\tcommon: common,\r\n\tadmin: {\r\n\t\thome : adminhome,\r\n\t},\r\n\titemttt: {\r\n\t\tlist\t: itemlist,\r\n\t\tadd\t\t: itemadd,\r\n\t\tedit\t: itemedit,\r\n\t},\r\n\tblog: {\r\n\t\tlist\t: bloglist,\r\n\t\tedit\t: blogedit,\r\n\t},\r\n\ttestimonial: {\r\n\t\tlist\t: tstmlist,\r\n\t},\r\n\tdynamicpage: {\r\n\t\tshow\t: dynpgshow,\r\n\t},\r\n}\r\ndeclare global\r\n{\r\n\tinterface Window { ttt: typeof ttt; }\r\n}\r\nwindow.ttt = ttt;\r\n","\nexport interface BlogPost\n{\n\tid?\t\t\t: number;\n\tdate\t\t: string;\n\timageHtml\t: string;\n\ttitleHtmlEN\t: string;\n\ttitleHtmlFR\t: string;\n\ttitleHtmlNL\t: string;\n\ttextHtmlEN\t: string;\n\ttextHtmlFR\t: string;\n\ttextHtmlNL\t: string;\n\tactive\t\t: boolean;\n}\n\nexport class BlogPostKO\n{\n\tpublic readonly\tid\t\t\t: KnockoutObservable<number>;\n\tpublic readonly\tdate\t\t: KnockoutObservable<string>;\n\tpublic readonly\timageHtml\t: KnockoutObservable<string>;\n\tpublic readonly\ttitleHtmlEN\t: KnockoutObservable<string>;\n\tpublic readonly\ttitleHtmlFR\t: KnockoutObservable<string>;\n\tpublic readonly\ttitleHtmlNL\t: KnockoutObservable<string>;\n\tpublic readonly\ttextHtmlEN\t: KnockoutObservable<string>;\n\tpublic readonly\ttextHtmlFR\t: KnockoutObservable<string>;\n\tpublic readonly\ttextHtmlNL\t: KnockoutObservable<string>;\n\tpublic readonly\tactive\t\t: KnockoutObservable<boolean>;\n\n\tconstructor(src?:BlogPost)\n\t{\n\t\tconst self = this;\n\n\t\tthis.id\t\t\t\t= ko.observable( null );\n\t\tthis.date\t\t\t= ko.observable( '' );\n\t\tthis.imageHtml\t\t= ko.observable( '' );\n\t\tthis.titleHtmlEN\t= ko.observable( '' );\n\t\tthis.titleHtmlFR\t= ko.observable( '' );\n\t\tthis.titleHtmlNL\t= ko.observable( '' );\n\t\tthis.textHtmlEN\t\t= ko.observable( '' );\n\t\tthis.textHtmlFR\t\t= ko.observable( '' );\n\t\tthis.textHtmlNL\t\t= ko.observable( '' );\n\t\tthis.active\t\t\t= ko.observable( false );\n\n\t\tif( src != null )\n\t\t\tself.fromDTO( src );\n\t}\n\n\tpublic fromDTO(src:BlogPost) : void\n\t{\n\t\tconst self = this;\n\n\t\tself.id\t\t\t\t( src.id );\n\t\tself.date\t\t\t( src.date );\n\t\tself.imageHtml\t\t( src.imageHtml );\n\t\tself.titleHtmlEN\t( src.titleHtmlEN );\n\t\tself.titleHtmlFR\t( src.titleHtmlFR );\n\t\tself.titleHtmlNL\t( src.titleHtmlNL );\n\t\tself.textHtmlEN\t\t( src.textHtmlEN );\n\t\tself.textHtmlFR\t\t( src.textHtmlFR );\n\t\tself.textHtmlNL\t\t( src.textHtmlNL );\n\t\tself.active\t\t\t( src.active );\n\t}\n\n\tpublic toDTO() : BlogPost\n\t{\n\t\tconst self = this;\n\t\tconst dst : BlogPost = <any>{};\n\n\t\tdst.id\t\t\t= self.id();\n\t\tdst.date\t\t= self.date();\n\t\tdst.imageHtml\t= self.imageHtml();\n\t\tdst.titleHtmlEN\t= self.titleHtmlEN();\n\t\tdst.titleHtmlFR\t= self.titleHtmlFR();\n\t\tdst.titleHtmlNL\t= self.titleHtmlNL();\n\t\tdst.textHtmlEN\t= self.textHtmlEN();\n\t\tdst.textHtmlFR\t= self.textHtmlFR();\n\t\tdst.textHtmlNL\t= self.textHtmlNL();\n\t\tdst.active\t\t= self.active();\n\n\t\treturn dst;\n\t}\n}\n","\nimport * as common from \"../Views/common\";\nimport { BaseAutoItem, DictObj } from \"../Utils/BaseAutoItem\";\nexport { DictObj, DictKO } from \"../Utils/BaseAutoItem\";\nimport { Translation } from \"./Translation\";\nimport { ItemPicture } from \"./ItemPicture\";\n\nexport interface Item extends DictObj\n{\n\tcode\t\t: string;\n\tactive\t\t: boolean;\n\tfeatures\t: Translation[];\n\tpictures\t: ItemPicture[];\n}\n\nexport class ItemKO extends BaseAutoItem\n{\n\tpublic readonly code\t\t\t: KnockoutObservable<string>;\n\tpublic readonly name\t\t\t: KnockoutObservable<string>;\n\tpublic readonly descriptionEN\t: KnockoutObservable<string>;\n\tpublic readonly descriptionFR\t: KnockoutObservable<string>;\n\tpublic readonly descriptionNL\t: KnockoutObservable<string>;\n\tpublic readonly active\t\t\t: KnockoutObservable<boolean>;\n\tpublic readonly price\t\t\t: KnockoutObservable<number>;\n\n\tconstructor($container:JQuery, src?:Item, fieldNames?:string[])\n\t{\n\t\tif( src == null )\n\t\t\tsrc = { code:null, active:false, features:[], pictures:[] };\n\t\tsuper( $container, src, fieldNames );\n\t\tconst self = this;\n\n\t\tif( self.price != null )\n\t\t\tcommon.utils.ensureInteger({ observable:self.price, canBeZero:false, canBeNull:true, mustBePositive:true });\n\t}\n\n\tpublic /*override*/ toDictObj(dict?:DictObj) : Item\n\t{\n\t\tconst rc = super.toDictObj( dict );\n\t\treturn <Item>rc;\n\t}\n}\n","\nimport * as common from \"../Views/common\";\n\nexport interface Translation\n{\n\ten : string;\n\tfr : string;\n\tnl : string;\n}\nexport interface TranslationItem extends Translation\n{\n\tinOriginal\t\t: boolean;\n\tinTranslation\t: boolean;\n}\n\nexport class TranslationKO\n{\n\tpublic readonly en\t: KnockoutObservable<string>;\n\tpublic readonly fr\t: KnockoutObservable<string>;\n\tpublic readonly nl\t: KnockoutObservable<string>;\n\n\tconstructor(src?:Translation)\n\t{\n\t\tif( src == null )\n\t\t\tsrc = { en:'', fr:'', nl:'' };\n\t\tthis.en = ko.observable( src.en );\n\t\tthis.fr = ko.observable( src.fr );\n\t\tthis.nl = ko.observable( src.nl );\n\t}\n}\nexport class TranslationItemKO extends TranslationKO\n{\n\tpublic readonly inOriginal\t\t: KnockoutObservable<boolean>;\n\tpublic readonly inTranslation\t: KnockoutObservable<boolean>;\n\n\tpublic readonly enOriginal\t: KnockoutObservable<string>;\n\tpublic readonly frOriginal\t: KnockoutObservable<string>;\n\tpublic readonly nlOriginal\t: KnockoutObservable<string>;\n\tpublic readonly modified\t: KnockoutComputed<boolean>;\n\n\tconstructor(src?:TranslationItem)\n\t{\n\t\tif( src == null )\n\t\t\tsrc = { en:'', fr:'', nl:'', inOriginal:false, inTranslation:false };\n\t\tsuper( src );\n\t\tconst self = this;\n\n\t\tthis.inOriginal\t\t= ko.observable( src.inOriginal\t );\n\t\tthis.inTranslation\t= ko.observable( src.inTranslation );\n\n\t\tthis.enOriginal = ko.observable( self.en() );\n\t\tthis.frOriginal = ko.observable( self.fr() );\n\t\tthis.nlOriginal = ko.observable( self.nl() );\n\t\tthis.modified = ko.computed( ()=>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif( self.en() != self.enOriginal() )\treturn true;\n\t\t\t\t\t\t\t\tif( self.fr() != self.frOriginal() )\treturn true;\n\t\t\t\t\t\t\t\tif( self.nl() != self.nlOriginal() )\treturn true;\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t} );\n\t}\n\n\tpublic toDTO() : Translation\n\t{\n\t\treturn {\n\t\t\t\ten : this.en(),\n\t\t\t\tfr : this.fr(),\n\t\t\t\tnl : this.nl(),\n\t\t\t};\n\t}\n\n\tpublic setAllLanguagesTo(str:string) : void\n\t{\n\t\tthis.en( str );\n\t\tthis.fr( str );\n\t\tthis.nl( str );\n\t}\n\n\tpublic copyEnToBlanks() : void\n\t{\n\t\tconst self = this;\n\t\tconst en = self.en();\n\t\tif( common.utils.stringIsNullOrWhitespace(self.fr()) )\n\t\t\tself.fr( en );\n\t\tif( common.utils.stringIsNullOrWhitespace(self.nl()) )\n\t\t\tself.nl( en );\n\t}\n}\n","\nimport * as common from \"./Views/common\";\n\nexport const { e:Languages, a:allLanguages } = common.utils.strEnum([ 'en', 'fr', 'nl' ]);\nexport type Language = keyof typeof Languages;\n","\nimport * as common from \"../Views/common\";\nimport Result from \"../Utils/TTTServiceResult\";\nimport * as dto from \"../DTOs/BlogPost\";\n\nexport async function list(p:ListRequest) : Promise<ListResponse>\n{\n\tconst rc = <ListResponse>await common.url.postRequestForm( common.routes.api.blog.list, p );\n\trc.posts = rc.result;\n\tdelete rc.result;\n\treturn rc;\n}\nexport interface ListRequest\n{\n\tincludeImages?\t\t: boolean;\n\tincludeInactives?\t: boolean;\n\tid?\t\t\t\t\t: number;\n\tskipToID?\t\t\t: number;\n\tskip?\t\t\t\t: number;\n\ttake?\t\t\t\t: number;\n}\nexport interface ListResponse extends Result\n{\n\tposts : dto.BlogPost[];\n}\n\nexport async function uploadPicture(file:File) : Promise<UploadPictureResult>\n{\n\tconst url = common.routes.api.blog.pictureUpload;\n\tconst formData = new FormData();\n\tformData.append( 'file', file );\n\n\tconst response = await common.url.postRequestFormData<UploadPictureResult>( url, formData );\n\tresponse.imageTagContent = response.result;\n\tdelete response.result;\n\n\treturn response;\n}\nexport interface UploadPictureResult extends Result\n{\n\timageTagContent : string;\n}\n\nexport async function save(post:dto.BlogPost) : Promise<SaveResponse>\n{\n\tconst rc = await common.url.postRequestJSON<SaveResponse>( common.routes.api.blog.save, post );\n\trc.id = rc.result;\n\tdelete rc.result;\n\treturn rc;\n}\nexport interface SaveResponse extends Result\n{\n\tid : number;\n}\n\nexport async function delete_(id:number) : Promise<Result>\n{\n\tconst rc = await common.url.postRequestForm<Result>( common.routes.api.blog.delete, { id } );\n\treturn rc;\n}\n","\nimport * as common from \"../Views/common\";\nimport { Result } from \"../Utils/TTTServiceResult\";\nimport { Language } from \"../Views/common\";\n\nexport async function get(p:{ itemCode:string, language?:Language }) : Promise<string>\n{\n\tif( p.language == null )\n\t\tp.language = common.pageParameters.currentLanguage;\n\tconst rc = <Result>await common.url.postRequestForm( common.routes.api.dynamicPage.get, p );\n\treturn rc.result;\n}\n\nexport async function update(p:{ itemCode:string, language?:Language, text:string, allowAdd?:boolean }) : Promise<string>\n{\n\tif( p.language == null )\n\t\tp.language = common.pageParameters.currentLanguage;\n\tconst rc = <Result>await common.url.postRequestForm( common.routes.api.dynamicPage.update, p );\n\treturn rc.result;\n}\n","\nimport * as common from \"../Views/common\";\nimport { Item } from \"../DTOs/Item\";\nimport Result from \"../Utils/TTTServiceResult\";\n\nexport async function getUrlCode(originalCode:string) : Promise<string>\n{\n\tif( common.utils.stringIsNullOrWhitespace(originalCode) )\n\t\treturn null;\n\treturn await common.url.getRequest( common.routes.api.getUrlCode, { originalCode } );\n}\n\nexport async function details(code:string) : Promise<DetailsResult>\n{\n\tconst url = common.routes.api.items.details.replace( common.routes.itemCodeParameter, code );\n\tconst rc = await common.url.postRequestJSON<DetailsResult>( url, {} );\n\trc.item = rc.result;\n\tdelete rc.result;\n\treturn rc;\n}\nexport interface DetailsResult extends Result\n{\n\titem : Item;\n}\n\nexport async function save(p:SaveRequest) : Promise<SaveResult>\n{\n\tconst rc = await common.url.postRequestJSON<SaveResult>( common.routes.api.items.save, p );\n\trc.newCode = rc.result;\n\tdelete rc.result;\n\treturn rc;\n}\nexport interface SaveRequest\n{\n\toriginalCode?\t: string;\n\titem\t\t\t: Item;\n}\nexport interface SaveResult extends Result\n{\n\tnewCode : string;\n}\n\nexport async function delete_(code:string) : Promise<SaveResult>\n{\n\tconst url = common.routes.api.items.delete.replace( common.routes.itemCodeParameter, code );\n\tconst rc = await common.url.postRequestJSON<SaveResult>( url, {} );\n\treturn rc;\n}\n","\nimport * as common from \"../Views/common\";\nimport Result from \"../Utils/TTTServiceResult\";\n\nexport async function upload(itemCode:string, file:File) : Promise<UploadResult>\n{\n\tconst url = common.routes.api.items.pictures.upload.replace( common.routes.itemCodeParameter, itemCode );\n\tconst formData = new FormData();\n\tformData.append( 'file', file );\n\n\tconst response = await common.url.postRequestFormData<UploadResult>( url, formData );\n\tresponse.imageNumber = response.result;\n\tdelete response.result;\n\t\n\treturn response;\n}\nexport interface UploadResult extends Result\n{\n\timageNumber : number;\n}\n\nexport async function delete_(p:{ itemCode:string, number:number }) : Promise<Result>\n{\n\tconst url = common.routes.api.items.pictures.delete.replace( common.routes.itemCodeParameter, p.itemCode );\n\tconst rc = await common.url.postRequestForm<Result>( url, { number:p.number } );\n\treturn rc;\n}\n\nexport async function reorder(p:{ itemCode:string, number:number, newNumber:number }) : Promise<Result>\n{\n\tconst url = common.routes.api.items.pictures.reorder.replace( common.routes.itemCodeParameter, p.itemCode );\n\tconst rc = await common.url.postRequestForm<Result>( url, { number:p.number, newNumber:p.newNumber } );\n\treturn rc;\n}\n\nexport async function setMain(p:{ itemCode:string, number:number, isMain:boolean }) : Promise<Result>\n{\n\tconst url = common.routes.api.items.pictures.setMain.replace( common.routes.itemCodeParameter, p.itemCode );\n\tconst rc = await common.url.postRequestForm<Result>( url, { number:p.number, isMain:p.isMain } );\n\treturn rc;\n}\n","\nimport * as common from \"../Views/common\";\nimport Result from \"../Utils/TTTServiceResult\";\n\nexport async function changePassword(p:{ oldPassword:string, newPassword:string }) : Promise<Result>\n{\n\tconst url = common.routes.api.changePassword;\n\tconst rc = <Result>await common.url.postRequestForm( url, p );\n\treturn rc;\n}\n","\nimport * as common from \"../Views/common\";\nimport * as dto from \"../DTOs/Testimonial\";\nimport Result from \"../Utils/TTTServiceResult\";\n\nexport async function list(p:ListRequest) : Promise<ListResponse>\n{\n\tconst rc = <ListResponse>await common.url.postRequestForm( common.routes.api.testimonial.list, p );\n\trc.testimonials = rc.result;\n\tdelete rc.result;\n\treturn rc;\n}\nexport interface ListRequest\n{\n\tincludeImages?\t\t: boolean;\n\tincludeInactives?\t: boolean;\n\tid?\t\t\t\t\t: number;\n}\nexport interface ListResponse extends Result\n{\n\ttestimonials : dto.Testimonial[];\n}\n\nexport async function save(post:SaveRequest) : Promise<Result>\n{\n\tconst rc = await common.url.postRequestJSON<Result>( common.routes.api.testimonial.save, post );\n\treturn rc;\n}\nexport interface SaveRequest extends dto.Testimonial\n{\n\tsaveImage\t: boolean;\n}\n\nexport async function delete_(id:number) : Promise<Result>\n{\n\tconst rc = await common.url.postRequestForm<Result>( common.routes.api.testimonial.delete, { id } );\n\treturn rc;\n}\n\nexport async function uploadPicture(file:File) : Promise<UploadPictureResult>\n{\n\tconst url = common.routes.api.testimonial.pictureUpload;\n\tconst formData = new FormData();\n\tformData.append( 'file', file );\n\n\tconst response = await common.url.postRequestFormData<UploadPictureResult>( url, formData );\n\tresponse.imageData = response.result;\n\tdelete response.result;\n\n\treturn response;\n}\nexport interface UploadPictureResult extends Result\n{\n\timageData : string;\n}\n","\nimport * as common from \"../Views/common\";\nimport Result from \"../Utils/TTTServiceResult\";\nimport * as dto from \"../DTOs/Translation\";\n\nexport const { e:TranslationTypes, a:allTranslationTypes } = common.utils.strEnum([\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'feature',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]);\nexport type TranslationType = keyof typeof TranslationTypes;\n\nexport async function list(p:ListRequest) : Promise<ListResponse>\n{\n\tconst rc = <ListResponse>await common.url.postRequestForm( common.routes.api.translations.list, p );\n\trc.translations = rc.result;\n\tdelete rc.result;\n\treturn rc;\n}\nexport interface ListRequest\n{\n\ttype\t\t\t\t\t: TranslationType;\n\tincludeOriginals?\t\t: boolean;\n\tincludeTranslations?\t: boolean;\n}\nexport interface ListResponse extends Result\n{\n\ttranslations : dto.TranslationItem[];\n}\n\nexport async function save(p:SaveRequest) : Promise<Result>\n{\n\treturn await common.url.postRequestJSON<Result>( common.routes.api.translations.save, p );\n}\nexport interface SaveRequest\n{\n\ttype\t\t\t: TranslationType;\n\ttranslations\t: SaveRequestItem[];\n}\nexport interface SaveRequestItem extends dto.Translation\n{\n\tenOriginal?\t: string;\n}\n\nexport async function autoCompleteResolve(p:AutoCompleteResolveRequest) : Promise<AutoCompleteResolveResponse>\n{\n\tconst url = common.routes.api.autoComplete;\n\tconst rc = <AutoCompleteResolveResponse>await common.url.postRequestForm( url, p );\n\trc.list = rc.result;\n\tdelete rc.result;\n\treturn rc;\n}\nexport interface AutoCompleteResolveRequest\n{\n\ttype\t\t\t\t\t: TranslationType;\n\tsearchString?\t\t\t: string;\n\tincludeTranslations?\t: boolean;\n}\nexport interface AutoCompleteResolveResponse extends Result\n{\n\tlist : string[];\n}\n","\nconst fieldTagAttribute = 'ttt-name';\n\nexport type DictObj\t= {[key:string]:any};\nexport type DictKO\t= {[key:string]:KnockoutObservable<any>};\n\nexport abstract class BaseAutoItem\n{\n\tprivate readonly fieldNames : string[];\n\n\tconstructor($container:JQuery, src:DictObj, fieldNames?:string[])\n\t{\n\t\tthis.fieldNames = (fieldNames != null) ? fieldNames : [];\n\t\tthis.knockoutify( $container, src );\n\t}\n\n\tpublic toDictObj(dict?:DictObj) : DictObj\n\t{\n\t\tconst self = this;\n\t\tconst dictKO : DictKO = <any>self;\n\t\tif( dict == null )\n\t\t\tdict = {};\n\n\t\t$.each( self.fieldNames, (i,fieldName)=>\n\t\t\t{\n\t\t\t\tconst observable = dictKO[ fieldName ];\n\t\t\t\tdict[ fieldName ] = observable();\n\t\t\t} );\n\n\t\treturn dict;\n\t}\n\n\tpublic fromDictObj(dict:DictObj) : void\n\t{\n\t\tconst self = this;\n\t\tconst dictKO : DictKO = <any>self;\n\t\t$.each( self.fieldNames, (i,fieldName)=>\n\t\t\t{\n\t\t\t\tconst observable = dictKO[ fieldName ];\n\t\t\t\tobservable( dict[fieldName] );\n\t\t\t} );\n\t}\n\n\tprivate knockoutify($container:JQuery, src:DictObj) : void\n\t{\n\t\tconst self = this;\n\t\tconst dict : DictKO = <any>this;\n\n\t\t// For each tagged elements we find in '$container'\n\t\t$container.find( `[${fieldTagAttribute}]` ).each( (i,e)=>\n\t\t\t{\n\t\t\t\t// Extract the field name from that attribute\n\t\t\t\tconst $e = $(e);\n\t\t\t\tconst fieldName = $e.attr( fieldTagAttribute );\n\n\t\t\t\tif( self.fieldNames.indexOf(fieldName) >= 0 )\n\t\t\t\t\t// That field is already already listed\n\t\t\t\t\t{/*NOOP*/}\n\t\t\t\telse\n\t\t\t\t\t// Add that field to the fields list\n\t\t\t\t\tself.fieldNames.push( fieldName );\n\t\t\t} );\n\n\t\t// For each listed fields ...\n\t\tself.fieldNames.forEach( (fieldName)=>\n\t\t\t{\n\t\t\t\t// ... create a KO observable on 'this' and set it's value using 'src' ...\n\t\t\t\tdict[ fieldName ] = ko.observable( src[fieldName] );\n\t\t\t} );\n\t}\n}\n","\nimport * as common from \"../common\";\nimport * as loginCtrl from \"../../Services/LoginController\";\nimport * as trnCtrl from \"../../Services/TranslationController\";\nimport * as trnDto from \"../../DTOs/Translation\";\n\nconst passwordsDontMatchMessage = 'Les 2 mots de passe ne concordent pas';\nconst passwordChangedMessage = 'Password changed successfully';\n\nexport var changePassword : ChangePassword;\nexport var features : Features;\n\nexport async function init(p:{\t$passwordBlockingDiv : JQuery,\n\t\t\t\t\t\t\t\t$featuresBlockingDiv : JQuery,\n\t\t\t\t\t\t\t}) : Promise<void>\n{\n\tchangePassword\t= new ChangePassword( p.$passwordBlockingDiv );\n\tfeatures\t\t= new Features( p.$featuresBlockingDiv );\n}\n\nclass ChangePassword\n{\n\tprivate readonly\t$blockingDiv\t\t: JQuery;\n\n\tprotected readonly\toriginal\t\t\t: KnockoutObservable<string>;\n\tprotected readonly\tnewPassword\t\t\t: KnockoutObservable<string>;\n\tprotected readonly\tnewPasswordAgain\t: KnockoutObservable<string>;\n\n\tconstructor($blockingDiv:JQuery)\n\t{\n\t\tthis.$blockingDiv\t\t= $blockingDiv;\n\t\tthis.original\t\t\t= ko.observable( '' );\n\t\tthis.newPassword\t\t= ko.observable( '' );\n\t\tthis.newPasswordAgain\t= ko.observable( '' );\n\t}\n\n\tprotected async change() : Promise<void>\n\t{\n\t\tconst self = this;\n\t\tconst oldPassword = self.original();\n\t\tconst newPassword = self.newPassword();\n\t\tconst newPasswordAgain = self.newPasswordAgain();\n\n\t\tif( common.utils.stringIsNullOrWhitespace(newPassword) )\n\t\t\treturn;\n\t\tif( common.utils.stringIsNullOrWhitespace(oldPassword) )\n\t\t\treturn;\n\t\tif( newPassword != newPasswordAgain )\n\t\t{\n\t\t\tcommon.html.showMessage( passwordsDontMatchMessage );\n\t\t\treturn;\n\t\t}\n\n\t\tcommon.html.block( self.$blockingDiv );\n\t\tconst rc = await loginCtrl.changePassword({ oldPassword, newPassword });\n\t\tcommon.html.unblock( self.$blockingDiv );\n\t\tif(! rc.success )\n\t\t{\n\t\t\tcommon.utils.error( 'change password error', { rc } );\n\t\t\tcommon.html.showMessage( rc.errorMessage );\n\t\t\treturn;\n\t\t}\n\t\tcommon.html.showMessage( passwordChangedMessage );\n\t\treturn;\n\t}\n}\n\nabstract class TranslationsBase\n{\n\tprivate readonly\t$blockingDiv\t: JQuery;\n\n\tprivate readonly\ttype\t\t\t: trnCtrl.TranslationType;\n\tprotected readonly\titems\t\t\t: KnockoutObservableArray<TranslationItem>;\n\tprotected readonly\thasChanges\t\t: KnockoutComputed<boolean>;\n\n\tconstructor(type:trnCtrl.TranslationType, $blockingDiv:JQuery)\n\t{\n\t\tconst self = this;\n\n\t\tthis.$blockingDiv\t= $blockingDiv;\n\t\tthis.type\t\t\t= type;\n\t\tthis.items\t\t\t= ko.observableArray();\n\t\tthis.hasChanges\t\t= ko.computed( ()=>\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tconst items = self.items();\n\t\t\t\t\t\t\t\t\t\tfor( let i=0; i<items.length; ++i )\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tif( items[i].modified() )\n\t\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t} );\n\n\t\tthis.refresh();\n\t}\n\n\tprotected async refresh() : Promise<void>\n\t{\n\t\tconst self = this;\n\n\t\tcommon.html.block( self.$blockingDiv );\n\t\tvar rc = await trnCtrl.list({ type:self.type });\n\t\tcommon.html.unblock( self.$blockingDiv );\n\t\tif(! rc.success )\n\t\t{\n\t\t\tcommon.utils.error( 'refresh translations error', { rc } );\n\t\t\tcommon.html.showMessage( rc.errorMessage );\n\t\t\treturn;\n\t\t}\n\n\t\tconst items = rc.translations.map( v=>new TranslationItem(v) );\n\t\tself.items( items );\n\t}\n\n\tprotected clearLine(index:KnockoutObservable<number>) : void\n\t{\n\t\tconst self = this;\n\t\tconst item = self.items()[ index() ];\n\t\titem.setAllLanguagesTo( '' );\n\t}\n\tprotected addLine() : void\n\t{\n\t\tthis.items.push( new TranslationItem() );\n\t}\n\n\tprotected async save() : Promise<void>\n\t{\n\t\tconst self = this;\n\n\t\tconst toSave = self.items()\n\t\t\t\t\t\t.map( (item)=>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(! item.modified() )\n\t\t\t\t\t\t\t\t\treturn null;\n\n\t\t\t\t\t\t\t\tconst dto : trnCtrl.SaveRequestItem = item.toDTO();\n\t\t\t\t\t\t\t\tdto.enOriginal = item.enOriginal();\n\t\t\t\t\t\t\t\treturn dto;\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t.filter( (item)=>(item != null) );\n\n\t\tif( toSave.length == 0 )\n\t\t{\n\t\t\t// NOOP => Simply refresh\n\t\t\tawait self.refresh();\n\t\t\treturn;\n\t\t}\n\n\t\tcommon.html.block( self.$blockingDiv );\n\t\tconst rc = await trnCtrl.save({ type:self.type, translations:toSave });\n\t\tcommon.html.unblock( self.$blockingDiv );\n\t\tif(! rc.success )\n\t\t{\n\t\t\tcommon.utils.error( 'save translations error', { rc } );\n\t\t\tcommon.html.showMessage( rc.errorMessage );\n\t\t\treturn;\n\t\t}\n\n\t\tawait self.refresh();\n\t}\n}\nclass TranslationItem extends trnDto.TranslationItemKO\n{\n\tprotected readonly showReset\t: KnockoutComputed<boolean>;\n\n\tconstructor(src?:trnDto.TranslationItem)\n\t{\n\t\tsuper( src );\n\t\tconst self = this;\n\t\tthis.showReset = ko.computed( ()=>self.inTranslation() );\n\t}\n}\n\nclass Features extends TranslationsBase\n{\n\tconstructor($blockingDiv:JQuery)\n\t{\n\t\tsuper( trnCtrl.TranslationTypes.feature, $blockingDiv );\n\t}\n}\n","\nimport * as common from \"../common\";\n\nexport namespace list\n{\n\texport async function list(p:{ noLayout?:boolean, includeImages?:boolean, includeInactives?:boolean, skipToID?:number, take?:number }) : Promise<string>\n\t{\n\t\tvar url = common.routes.blog.list.replace( common.routes.languageParameter, common.pageParameters.currentLanguage );\n\t\treturn await common.url.getRequest( url, p );\n\t}\n}\n","\nimport * as tmce from \"tinymce\";\nimport * as common from \"../common\";\nimport * as dtos from \"../../DTOs/BlogPost\";\nimport * as ctrl from \"../../Services/BlogController\";\n\nconst message_confirmRefresh = 'Are your sure you want to reset the current form ?';\nconst message_confirmDelete = 'Are your sure you want to delete the current post ?';\n\nvar isAdding : boolean;\nvar $blockingDiv : JQuery;\nexport var post : dtos.BlogPostKO;\n\nexport async function init(p:{\tisAdding\t\t\t: boolean,\n\t\t\t\t\t\t\t\tpost\t\t\t\t: dtos.BlogPost,\n\t\t\t\t\t\t\t\t$blockingDiv\t\t: JQuery,\n\t\t\t\t\t\t\t\t$picUploadControl\t: JQuery,\n\t\t\t\t\t\t\t\t$txtDate\t\t\t: JQuery,\n\t\t\t\t\t\t\t}) : Promise<void>\n{\n\tcommon.utils.log( 'edit.init() START', { p } );\n\n\tisAdding\t\t= p.isAdding;\n\t$blockingDiv\t= p.$blockingDiv;\n\tpost\t\t\t= new dtos.BlogPostKO( p.post );\n\n\tcommon.utils.log( 'edit.init(): add custom Knockout bindings handler' );\n\taddKoTinymceEditor();\n\n\tcommon.utils.log( 'edit.init(): Init picture upload' );\n\tp.$picUploadControl.on( 'change', ()=>\n\t\t{\n\t\t\tconst files = (<HTMLInputElement>p.$picUploadControl[0]).files;\n\t\t\tuploadPicture( files );\n\t\t} );\n\n\tcommon.utils.log( 'edit.init(): Init date picker' );\n\tp.$txtDate.datepicker({ dateFormat: 'yy-mm-dd' });\n\n\tcommon.utils.log( 'edit.init() END' );\n}\n\n/** Add 'tinymceEditor' Knockout bindings handler */\nexport function addKoTinymceEditor() : void\n{\n\t// Create HTML editor KO's binding\n\tko.bindingHandlers.tinymceEditor =\n\t\t{\n\t\t\tinit : function(element, valueAccessor, allBindings, viewModel, bindingContext)\n\t\t\t\t{\n\t\t\t\t\tconst $element = $(element);\n\t\t\t\t\tconst observable : KnockoutObservable<string> = valueAccessor();\n\n\t\t\t\t\t// Initial sync.\n\t\t\t\t\tobservable( $element.html() );\n\t\t\t\t\t$element.html( observable() );\n\n\t\t\t\t\t(<any>$element).tinymce( {\n\t\t\t\t\t\t\tinline\t: true,\n\t\t\t\t\t\t\tplugins\t: 'image,code',\n\t\t\t\t\t\t\tsetup\t: function(ed:tmce.Editor)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ted.on( 'change', function()\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t// HTML has changed\n\t\t\t\t\t\t\t\t\t\t\t\t\tobservable( $element.html() );\n\t\t\t\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t} );\n\t\t\t\t},\n\t\t\tupdate : function(element, valueAccessor)\n\t\t\t\t{\n\t\t\t\t\t// Observable has changed\n\t\t\t\t\tconst observable : KnockoutObservable<string> = valueAccessor();\n\t\t\t\t\tconst $element = $(element);\n\t\t\t\t\t$element.html( observable() );\n\t\t\t\t},\n\t\t};\n}\n\nasync function uploadPicture(files:FileList) : Promise<void>\n{\n\tcommon.utils.log( 'edit.uploadPicture(): START', {files} );\n\n\tif( files.length == 0 )\n\t\treturn;\n\tif( (<any>window).FormData === undefined )\n\t{\n\t\tcommon.utils.error( \"This browser doesn't support HTML5 file uploads!\" );\n\t\treturn;\n\t}\n\n\t const rc = await ctrl.uploadPicture( files[0] );\n\t if(! rc.success )\n\t {\n\t\t common.utils.error( 'edit.uploadPicture(): Error', { rc } );\n\t\t common.html.showMessage( rc.errorMessage );\n\t\t return;\n\t }\n\n\tpost.imageHtml( rc.imageTagContent );\n\n\tcommon.utils.log( 'edit.uploadPicture(): END' );\n}\n\nexport async function refresh() : Promise<void>\n{\n\tcommon.utils.log( 'edit.refresh(): START' );\n\n\tcommon.utils.log( 'edit.refresh(): Wait for user confirmation' );\n\tconst confirmed = await common.html.confirm( message_confirmRefresh );\n\tif(! confirmed )\n\t{\n\t\tcommon.utils.log( 'edit.refresh(): NOT confirmed ; END' );\n\t\treturn;\n\t}\n\n\tcommon.utils.log( 'edit.refresh(): Retreive item' );\n\tcommon.html.block( $blockingDiv );\n\tconst rc = await ctrl.list({ id:post.id(), includeImages:true, includeInactives:true });\n\tcommon.html.unblock( $blockingDiv );\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'retreive post error', { rc } );\n\t\tcommon.html.showMessage( rc.errorMessage );\n\t\treturn;\n\t}\n\tcommon.utils.log( 'edit.refresh(): Update blog post' );\n\tpost.fromDTO( rc.posts[0] );\n\n\tcommon.utils.log( 'edit.refresh(): END' );\n}\n\nexport async function save() : Promise<void>\n{\n\tcommon.utils.log( 'edit.save(): START' );\n\n\tcommon.utils.log( 'edit.save(): Create DTO' );\n\tconst dto = post.toDTO();\n\n\tcommon.utils.log( 'edit.save(): Send the save request' );\n\tcommon.html.block( $blockingDiv );\n\tconst rc = await ctrl.save( dto );\n\tcommon.html.unblock( $blockingDiv );\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'edit.save(): Error', { rc } );\n\t\tcommon.html.showMessage( rc.errorMessage );\n\t\treturn;\n\t}\n\n\tif( isAdding )\n\t{\n\t\tcommon.utils.log( 'edit.save(): Adding => Redirect to edit page' );\n\t\tconst url = common.routes.blog.edit.replace( common.routes.itemIDParameter, ''+rc.id );\n\t\tcommon.url.redirect( url );\n\t}\n\n\tcommon.utils.log( 'edit.save(): END' );\n}\n\nexport async function delete_() : Promise<void>\n{\n\tcommon.utils.log( 'edit.delete(): START' );\n\n\tcommon.utils.log( 'edit.delete(): Wait for user confirmation' );\n\tconst confirmed = await common.html.confirm( message_confirmDelete );\n\tif(! confirmed )\n\t{\n\t\tcommon.utils.log( 'edit.delete(): NOT confirmed ; END' );\n\t\treturn;\n\t}\n\n\tcommon.utils.log( 'edit.delete(): Send the delete request' );\n\tcommon.html.block( $blockingDiv );\n\tconst rc = await ctrl.delete_( post.id() );\n\tcommon.html.unblock( $blockingDiv );\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'edit.delete(): Error', { rc } );\n\t\tcommon.html.showMessage( rc.errorMessage );\n\t\treturn;\n\t}\n\n\tcommon.utils.error( 'edit.delete(): Redirect to list page' );\n\tconst url = common.routes.blog.list.replace( common.routes.languageParameter, common.pageParameters.currentLanguage );\n\tcommon.url.redirect( url );\n\n\tcommon.utils.log( 'edit.delete(): END' );\n}\n","\nimport * as common from \"../common\";\nimport * as dtos from \"../../DTOs/BlogPost\";\nimport * as apiCtrl from \"../../Services/BlogController\";\nimport * as htmlCtrl from \"./BlogController\";\n\nconst blogIdAttribute = 'ttt-blog-id';\n\nexport async function init(p:{\t$postsContainer\t: JQuery,\n\t\t\t\t\t\t\t\t$endPostElement\t: JQuery,\n\t\t\t\t\t\t\t\t$spinner\t\t: JQuery,\n\t\t\t\t\t\t\t\tpostsIncrement\t: number,\n\t\t\t\t\t\t\t}) : Promise<void>\n{\n\tcommon.utils.log( 'list.init() START', { p } );\n\n\t// Retreive images of initially loaded posts\n\tconst lastPost = await loadImages();\n\n\tcommon.utils.log( 'list.init(): Wait for document.load' );\n\tawait new Promise<void>( (resolve)=>$(window).on( 'load', ()=>resolve() ) );\n\tcommon.utils.log( 'list.init(): Loaded!' );\n\n\t// Start \"scroll-triggered\" retreives loop\n\t/*await*/ loopLoadNextPosts({ $endPostElement:p.$endPostElement, $spinner:p.$spinner, lastPost, postsIncrement:p.postsIncrement });\n\n\tcommon.utils.log( 'list.init() END' );\n}\n\nasync function loopLoadNextPosts(p:{ $endPostElement:JQuery, $spinner:JQuery, lastPost:PostItem, postsIncrement:number }) : Promise<void>\n{\n\tcommon.utils.log( 'loopLoadNextPosts(): START', { p } );\n\n\tlet lastPost = p.lastPost;\n\twhile( lastPost != null )\n\t{\n\t\tcommon.utils.log( 'loopLoadNextPosts(): Wait for $endPostElement to be visible' );\n\t\tawait common.html.waitForScrolledVisible( p.$endPostElement );\n\n\t\tcommon.utils.log( `loopLoadNextPosts(): Request next '${p.postsIncrement}' posts` );\n\t\tp.$spinner.show();\n\t\tconst html = await htmlCtrl.list.list({ noLayout:true, includeImages:false, skipToID:lastPost.id, take:p.postsIncrement });\n\t\tp.$spinner.hide();\n\n\t\tcommon.utils.log( 'loopLoadNextPosts(): Append received posts' );\n\t\tp.$endPostElement.before( html );\n\n\t\tcommon.utils.log( `loopLoadNextPosts(): Launch 'loadImages()'`, { lastPost } );\n\t\tlastPost = await loadImages();\n\n\t\tcommon.utils.log( 'loopLoadNextPosts()', { lastPost } );\n\t}\n\n\tcommon.utils.log( 'loopLoadNextPosts(): END' );\n}\n\nasync function loadImages() : Promise<PostItem>\n{\n\tcommon.utils.log( 'loadImages(): START' );\n\n\t// Find all new elements with the \"tag attribute\" (i.e. all new blog posts)\n\tconst posts : PostItem[] = [];\n\t$(`[${blogIdAttribute}]`).each( (i,e)=>\n\t\t{\n\t\t\tconst $container = $(e);\n\t\t\tconst id = parseInt( $container.attr(blogIdAttribute) );\n\t\t\t$container.removeAttr( blogIdAttribute );  // Remove the \"tag attribute\" from the DOM so that next call to this method does not re-find this item\n\t\t\tposts.push({ id, $container, model:null });\n\t\t} );\n\n\tcommon.utils.log( 'loadImages(): Asynchroneously retreive posts (full) DTOs', { posts } );\n\tposts.forEach( async (item)=>\n\t\t{\n\t\t\tcommon.html.block( item.$container );\n\t\t\tconst rc = await apiCtrl.list({ id:item.id, includeInactives:true });\n\t\t\tcommon.html.unblock( item.$container );\n\t\t\tif(! rc.success )\n\t\t\t{\n\t\t\t\tcommon.utils.error( 'retreive post error', { rc } );\n\t\t\t\t// common.html.showMessage( rc.errorMessage ); <== publicly-accessible page => Don't show internal errors ...\n\t\t\t\treturn;\n\t\t\t}\n\t\t\titem.model = rc.posts[0];\n\n\t\t\tcommon.utils.log( 'loadImages(): Bind model', { /*model:item.model,*/ $element:item.$container, id:item.id } );\n\t\t\tko.applyBindings( item.model, item.$container[0] );\n\t\t} );\n\n\tconst lastPostItem = (posts.length > 0) ? posts[posts.length - 1] : null;\n\tcommon.utils.log( 'loadImages(): END', { lastPostItem } );\n\treturn lastPostItem;\n}\n\ninterface PostItem\n{\n\tid\t\t\t: number;\n\t$container\t: JQuery;\n\tmodel\t\t: dtos.BlogPost;\n}\n","\nimport * as common from \"../common\";\nimport { addKoTinymceEditor } from \"../Blog/Edit\";\nimport * as ctrl from \"../../Services/DynamicPageController\";\n\nvar $blockingDiv\t: JQuery;\nvar itemCode\t\t: string;\nexport var textHtml\t: KnockoutObservable<string>;\n\nexport async function init(p:{\t$blockingDiv\t: JQuery,\n\t\t\t\t\t\t\t\titemCode\t\t: string,\n\t\t\t\t\t\t\t}) : Promise<void>\n{\n\tcommon.utils.log( 'show.init() START', { p } );\n\n\t$blockingDiv\t= p.$blockingDiv;\n\titemCode\t\t= p.itemCode;\n\ttextHtml\t\t= ko.observable();\n\n\tcommon.utils.log( 'show.init(): add custom Knockout bindings handler' );\n\taddKoTinymceEditor();\n\n\tcommon.utils.log( 'show.init() END' );\n}\n\nexport async function save() : Promise<void>\n{\n\tcommon.utils.log( 'show.save(): START' );\n\tcommon.html.block( $blockingDiv );\n\n\tcommon.utils.log( 'show.save(): Send the save request' );\n\tawait ctrl.update({ itemCode, text:textHtml() });\n\n\tcommon.utils.log( 'show.save(): Refresh' );\n\tawait refresh();\n\n\tcommon.html.unblock( $blockingDiv );\n\tcommon.utils.log( 'show.save(): END' );\n}\n\nexport async function refresh() : Promise<void>\n{\n\tcommon.utils.log( 'show.refresh(): START' );\n\tcommon.html.block( $blockingDiv );\n\n\tcommon.utils.log( 'show.save(): Send the get request' );\n\tconst newHtml = await ctrl.get({ itemCode });\n\n\tcommon.utils.log( 'show.save(): Update html' );\n\ttextHtml( newHtml );\n\n\tcommon.html.unblock( $blockingDiv );\n\tcommon.utils.log( 'show.refresh(): END' );\n}\n","\nimport * as common from \"../common\";\nimport * as dto from \"../../DTOs/Item\";\nimport * as ctrl from \"../../Services/ItemController\";\n\nvar $blockingDiv : JQuery;\nexport var item : dto.ItemKO;\n\nexport async function init(p:{\t$blockingDiv\t\t: JQuery,\n\t\t\t\t\t\t\t\t$btnSave\t\t\t: JQuery,\n\t\t\t\t\t\t\t\t$fieldsContainer\t: JQuery }) : Promise<void>\n{\n\tcommon.utils.log( 'add.init() START', { p } );\n\t$blockingDiv = p.$blockingDiv;\n\n\tcommon.utils.log( 'add.init(): Create KO item' );\n\titem = new dto.ItemKO( p.$fieldsContainer );\n\n\tcommon.utils.log( 'add.init(): Apply KO item' );\n\tko.applyBindings( item, p.$fieldsContainer[0] );\n\n\tcommon.utils.log( 'add.init(): Bind JQuery events' );\n\tp.$btnSave.click( save );\n\n\tcommon.utils.log( 'add.init() END' );\n}\n\nasync function save() : Promise<void>\n{\n\tcommon.utils.log( 'add.save(): START' );\n\n\tconst obj = item.toDictObj();\n\n\tcommon.utils.log( 'add.save(): Launch save' );\n\tcommon.html.block( $blockingDiv );\n\tconst rc = await ctrl.save({ item:obj });\n\tcommon.html.unblock( $blockingDiv );\n\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'add.save(): Error', { rc } );\n\t\tcommon.html.showMessage( rc.errorMessage );\n\t\treturn;\n\t}\n\n\tcommon.utils.log( 'add.save(): Redirect', { rc } );\n\tconst url = common.routes.itemTTT.edit.replace( common.routes.itemCodeParameter, rc.newCode );\n\tcommon.utils.log( `add.save(): url=\"${url}\"` );\n\tcommon.url.redirect( url );\n\n\tcommon.utils.log( 'add.save(): END' );\n}\n","\nimport * as common from \"../common\";\nimport * as dto from \"../../DTOs/Item\";\nimport { ItemPicture } from \"../../DTOs/ItemPicture\";\nimport * as ctrl from \"../../Services/ItemController\";\nimport * as picCtrl from \"../../Services/ItemPictureController\";\nimport * as trnCtrl from \"../../Services/TranslationController\";\nimport { TranslationKO } from \"../../DTOs/Translation\";\n\nconst message_confirmDelete = 'Are you sure you want to delete that item?';\nconst message_saveSuccess = 'Item saved successfully';\nconst message_refreshFailed = 'An error occured while refresing the data: ';\nconst message_confirmDeletePicture = 'Are you sure you want to delete that image?';\n\nvar $blockingDiv : JQuery;\nvar originalCode : string;\n\nexport var item\t\t\t: ItemKO;\nexport var picDropZone\t: { hover:KnockoutObservable<boolean> };\n\nexport async function init(p:{\tmodel\t\t\t\t: dto.Item,\n\t\t\t\t\t\t\t\t$blockingDiv\t\t: JQuery,\n\t\t\t\t\t\t\t\t$btnSave\t\t\t: JQuery,\n\t\t\t\t\t\t\t\t$btnDelete\t\t\t: JQuery,\n\t\t\t\t\t\t\t\t$fieldsContainer\t: JQuery,\n\t\t\t\t\t\t\t\t$picUploadDropZone\t: JQuery,\n\t\t\t\t\t\t\t\t$picUploadControl\t: JQuery,\n\t\t\t\t\t\t\t}) : Promise<void>\n{\n\tcommon.utils.log( 'edit.init() START', { p } );\n\t$blockingDiv = p.$blockingDiv;\n\n\tcommon.utils.log( 'edit.init(): Create KO item' );\n\titem = new ItemKO( p.$fieldsContainer, p.model );\n\toriginalCode = item.code();\n\n\tcommon.utils.log( 'edit.init(): Bind JQuery events' );\n\tp.$btnSave.click( save );\n\tp.$btnDelete.click( ()=>{ delete_(); } );\n\n\tcommon.utils.log( 'edit.init(): Init picture upload' );\n\tinitPictureUpload( p.$picUploadDropZone, p.$picUploadControl );\n\n\tcommon.utils.log( 'edit.init() END' );\n}\n\nfunction initPictureUpload($dropZone:JQuery, $upload:JQuery) : void\n{\n\tcommon.utils.log( 'edit.initDropZone(): Create drop zone object' );\n\n\tpicDropZone = {\n\t\t\thover : ko.observable(false),\n\t\t};\n\n\tcommon.utils.log( 'edit.initDropZone(): Watch for drag-drops on \"upload image drop zone\"' );\n\n\t$dropZone.on( 'dragenter', function(e)\n\t\t{\n\t\t\tpicDropZone.hover( true );\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t} );\n\t$dropZone.on( 'dragover', function(e)\n\t\t{\n\t\t\tpicDropZone.hover( true );\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t} );\n\t$dropZone.on( 'dragleave', function(e)\n\t\t{\n\t\t\tpicDropZone.hover( false );\n\t\t} );\n\t$dropZone.on( 'drop', function(e)\n\t\t{\n\t\t\tpicDropZone.hover( false );\n\t\t\te.preventDefault();\n\n\t\t\tvar files = (<any>e.originalEvent).dataTransfer.files;\n\t\t\tuploadPicture( files );\n\t\t});\n\n\t$upload.on( 'change', ()=>\n\t\t{\n\t\t\tconst files = (<HTMLInputElement>$upload[0]).files;\n\t\t\tuploadPicture( files );\n\t\t} );\n}\n\nexport async function autoCompleteFeature(searchTerm:string) : Promise<string[]>\n{\n\tvar rc = await trnCtrl.autoCompleteResolve({ type:trnCtrl.TranslationTypes.feature, searchString:searchTerm, includeTranslations:true });\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'autocomplete error', { rc } );\n\t\treturn [];\n\t}\n\treturn rc.list;\n}\n\nasync function save() : Promise<void>\n{\n\tcommon.utils.log( 'edit.save(): START' );\n\n\tconst obj = item.toDictObj();\n\n\tcommon.utils.log( 'edit.save(): Launch save' );\n\tcommon.html.block( $blockingDiv );\n\tconst rc = await ctrl.save({ originalCode, item:obj });\n\tcommon.html.unblock( $blockingDiv );\n\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'edit.save(): Error', { rc } );\n\t\tcommon.html.showMessage( rc.errorMessage );\n\t\treturn;\n\t}\n\n\tcommon.utils.log( 'edit.save(): Refresh values', { rc } );\n\tconst rcr = await refresh( rc.newCode );\n\tif( rcr )\n\t\tcommon.html.showMessage( message_saveSuccess );\n\n\tcommon.utils.log( 'edit.save(): END' );\n}\n\nasync function delete_(confirmed?:boolean) : Promise<void>\n{\n\tcommon.utils.log( 'edit.delete(): START' );\n\n\tif( confirmed != true )\n\t{\n\t\tcommon.utils.log( 'edit.delete(): Ask confirmation' );\n\t\tconst rc = await common.html.confirm( message_confirmDelete );\n\t\tif(! rc )\n\t\t{\n\t\t\tcommon.utils.log( 'edit.delete(): NOT CONFIRMED' );\n\t\t\treturn;\n\t\t}\n\t}\n\n\tcommon.utils.log( 'edit.delete(): Launch delete' );\n\tcommon.html.block( $blockingDiv );\n\tconst rc = await ctrl.delete_( originalCode );\n\tcommon.html.unblock( $blockingDiv );\n\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'edit.delete(): Error', { rc } );\n\t\tcommon.html.showMessage( rc.errorMessage );\n\t\treturn;\n\t}\n\n\tcommon.utils.log( 'edit.delete(): Redirect' );\n\tconst url = common.routes.itemTTT.list.replace( common.routes.languageParameter, common.pageParameters.currentLanguage );\n\tcommon.utils.log( 'edit.delete()', { url } );\n\tcommon.url.redirect( url );\n\n\tcommon.utils.log( 'edit.delete(): END' );\n}\n\nasync function uploadPicture(files:FileList) : Promise<void>\n{\n\tcommon.utils.log( 'edit.uploadPicture(): START', {files} );\n\n\tif( files.length == 0 )\n\t\treturn;\n\tif( (<any>window).FormData === undefined )\n\t{\n\t\tcommon.utils.error( \"This browser doesn't support HTML5 file uploads!\" );\n\t\treturn;\n\t}\n\n\tcommon.utils.log( `edit.uploadPicture(): Create '${files.length}' upload tasks` );\n\tcommon.html.block( $blockingDiv );\n\tconst tasks = $.map( files, (file:File)=>\n\t\t{\n\t\t\treturn picCtrl.upload( originalCode, file );\n\t\t} );\n\n\tcommon.utils.log( 'edit.uploadPicture(): Wait for tasks to terminate' );\n\tconst rcs = await Promise.all( tasks );\n\tcommon.html.unblock( $blockingDiv );\n\tcommon.utils.log( 'edit.uploadPicture(): All tasks terminated' );\n\n\t$.each( rcs, (i,rc)=>\n\t\t{\n\t\t\tif(! rc )\n\t\t\t{\n\t\t\t\tcommon.utils.error( 'edit.delete(): Upload error', { i, rc } );\n\t\t\t\tcommon.html.showMessage( rc.errorMessage );\n\t\t\t}\n\t\t} );\n\n\tawait refresh();\n\n\tcommon.utils.log( 'edit.uploadPicture(): END' );\n}\n\nexport async function deletePicture(picture:ItemPicture, confirmed?:boolean) : Promise<void>\n{\n\tcommon.utils.log( 'edit.deletePicture(): START' );\n\n\tif( confirmed != true )\n\t{\n\t\tcommon.utils.log( 'edit.deletePicture(): Ask confirmation' );\n\t\tconst rc = await common.html.confirm( message_confirmDeletePicture );\n\t\tif(! rc )\n\t\t{\n\t\t\tcommon.utils.log( 'edit.deletePicture(): NOT CONFIRMED' );\n\t\t\treturn;\n\t\t}\n\t}\n\n\tcommon.utils.log( 'edit.deletePicture(): Launch delete request' );\n\tcommon.html.block( $blockingDiv );\n\tconst rc = await picCtrl.delete_({ itemCode:picture.itemCode, number:picture.number });\n\tcommon.html.unblock( $blockingDiv );\n\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'edit.deletePicture(): Error', { rc } );\n\t\tcommon.html.showMessage( rc.errorMessage );\n\t}\n\n\tcommon.utils.log( 'edit.deletePicture(): Launch refresh' );\n\tawait refresh();\n\n\tcommon.utils.log( 'edit.deletePicture(): END' );\n}\n\nexport async function toggleMainPicture(picture:ItemPicture) : Promise<void>\n{\n\tcommon.utils.log( 'edit.toggleMainPicture(): START' );\n\n\tcommon.utils.log( 'edit.toggleMainPicture(): Launch toggle request' );\n\tcommon.html.block( $blockingDiv );\n\tconst rc = await picCtrl.setMain({ itemCode:picture.itemCode, number:picture.number, isMain:(!picture.isMainImage) });\n\tcommon.html.unblock( $blockingDiv );\n\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'edit.toggleMainPicture(): Error', { rc } );\n\t\tcommon.html.showMessage( rc.errorMessage );\n\t}\n\n\tcommon.utils.log( 'edit.toggleMainPicture(): Launch refresh' );\n\tawait refresh();\n\n\tcommon.utils.log( 'edit.toggleMainPicture(): END' );\n}\n\nexport async function reorderPicture(picture:ItemPicture, offset:number) : Promise<void>\n{\n\tcommon.utils.log( 'edit.movePicture(): START' );\n\n\tlet newNumber = picture.number + offset;\n\tif( newNumber <= 0 )\n\t\tnewNumber = 1;\n\tif( picture.number == newNumber )\n\t\t// NOOP\n\t\treturn;\n\n\tcommon.utils.log( 'edit.movePicture(): Launch move request' );\n\tcommon.html.block( $blockingDiv );\n\tconst rc = await picCtrl.reorder({ itemCode:picture.itemCode, number:picture.number, newNumber:newNumber });\n\tcommon.html.unblock( $blockingDiv );\n\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'edit.movePicture(): Error', { rc } );\n\t\tcommon.html.showMessage( rc.errorMessage );\n\t}\n\n\tcommon.utils.log( 'edit.movePicture(): Launch refresh' );\n\tawait refresh();\n\n\tcommon.utils.log( 'edit.movePicture(): END' );\n}\n\nasync function refresh(code?:string) : Promise<boolean>\n{\n\t// TODO: Allow refresh only images to avoid overwriting any modifications to input fields ...\n\tcommon.utils.log( 'edit.refresh(): START' );\n\n\tlet newUrl : string = null;\n\tif( code == null )\n\t{\n\t\tcode = originalCode;\n\t}\n\telse\n\t{\n\t\tif( originalCode != code )\n\t\t\t// URL must change!\n\t\t\tnewUrl = common.routes.itemTTT.edit.replace( common.routes.itemCodeParameter, code );\n\t\toriginalCode = code;\n\t}\n\n\tcommon.utils.log( 'edit.refresh(): Launch request' );\n\tcommon.html.block( $blockingDiv );\n\tconst rc = await ctrl.details( code );\n\tcommon.html.unblock( $blockingDiv );\n\n\tif(! rc.success )\n\t{\n\t\tcommon.utils.error( 'edit.refresh(): Error', { rc } );\n\t\tcommon.html.showMessage( message_refreshFailed+rc.errorMessage );\n\t\treturn false;\n\t}\n\n\tcommon.utils.log( 'edit.refresh(): Load from new item', { rc } );\n\titem.fromDictObj( rc.item );\n\n\tif( newUrl != null )\n\t{\n\t\tcommon.utils.log( `edit.refresh(): Update URL to \"${newUrl}\"` );\n\t\tcommon.url.pushHistory({ pathname:newUrl, newTitle:item.name() });\n\t}\n\n\tcommon.utils.log( 'edit.refresh(): END' );\n\treturn true;\n}\n\n/** Used to add a changing parameter to the URL to bypass browser's cache */\nexport function scrambleUrl(url:string) : string\n{\n\tif( url.indexOf('?') >= 0 )\n\t\turl = url + '&';\n\telse\n\t\turl = url + '?';\n\turl = url + 'p=' + common.utils.newGuid();\n\treturn url;\n}\n\nclass ItemKO extends dto.ItemKO\n{\n\tpublic readonly features\t\t: KnockoutObservableArray<TranslationKO>;\n\tpublic readonly pictures\t\t: KnockoutObservableArray<ItemPicture>;\n\n\tconstructor($container:JQuery, src:dto.Item)\n\t{\n\t\tsuper( $container, src );\n\t\tthis.features\t= ko.observableArray( src.features.map(v=>new TranslationKO(v)) );\n\t\tthis.pictures\t= ko.observableArray( src.pictures );\n\t}\n\n\tprotected addNewFeature() : void\n\t{\n\t\tconst self = this;\n\t\tself.features.push( new TranslationKO() );\n\t}\n\n\tpublic /*override*/ toDictObj(dict?:dto.DictObj) : dto.Item\n\t{\n\t\tconst self = this;\n\t\tconst item = <dto.Item>super.toDictObj( dict );\n\t\titem.features\t= self.features().map( v=>{ return { en:v.en(), fr:'', nl:'' }; } );  // nb: only EN is used server-side\n\t\treturn item;\n\t}\n\n\tpublic /*override*/ fromDictObj(item:dto.Item) : void\n\t{\n\t\tconst self = this;\n\t\tsuper.fromDictObj( item );\n\t\tself.features( item.features.map( v=>{ return new TranslationKO(v); } ) );\n\t\tself.pictures( item.pictures );\n\t}\n}\n","\nimport * as common from \"../common\";\n\nexport namespace list\n{\n\texport const { e:ViewModes, a:allViewModes } = common.utils.strEnum([ 'grid', 'list' ]);\n\texport type ViewMode = keyof typeof ViewModes;\n\n\texport const { e:SortingFields, a:allSortingFields } = common.utils.strEnum([ 'price', 'price_desc', 'name', 'name_desc' ]);\n\texport type SortingField = keyof typeof SortingFields;\n\n\texport async function getListContent(p:GetListContentRequest) : Promise<string>\n\t{\n\t\tvar url = common.routes.itemTTT.list.replace( common.routes.languageParameter, common.pageParameters.currentLanguage );\n\t\treturn await common.url.getRequest( url, p );\n\t}\n\texport interface GetListContentRequest\n\t\t{\n\t\t\tviewMode?\t\t: ViewMode,\n\t\t\tsortingField?\t: SortingField,\n\t\t\tnoLayout?\t\t: boolean,\n\t\t};\n}\n","\nimport * as common from \"../common\";\nimport * as itemCtrl from \"../../Services/ItemController\";\nimport { list } from \"./ItemTTTController\";\nimport * as dto from \"../../DTOs/Item\";\nimport { Languages } from \"../../Language\";\n\nconst modelSearchString = '[type=ttt-model]';\n\nvar currentSortingField : list.SortingField;\nvar $txtSearch\t\t: JQuery;\nvar $cbShowInactive\t: JQuery;\nvar $divCarsList\t: JQuery;\nvar $divBlocking\t: JQuery;\n\nexport var itemsList : ItemKO[];\n\nexport async function init(p:{\tsortingField\t: list.SortingField,\n\t\t\t\t\t\t\t\t$txtSearch\t\t: JQuery,\n\t\t\t\t\t\t\t\t$cbShowInactive\t: JQuery,\n\t\t\t\t\t\t\t\t$divCarsList\t: JQuery,\n\t\t\t\t\t\t\t\t$btnViewList\t: JQuery,\n\t\t\t\t\t\t\t\t$btnViewGrid\t: JQuery,\n\t\t\t\t\t\t\t\t$btnSortName\t: JQuery,\n\t\t\t\t\t\t\t\t$btnSortPrice\t: JQuery }) : Promise<void>\n{\n\tcommon.utils.log( 'list.init(): START' );\n\n\tcurrentSortingField\t= p.sortingField;\n\t$txtSearch\t\t\t= p.$txtSearch;\n\t$cbShowInactive\t\t= p.$cbShowInactive.prop( 'checked', true );\n\t$divCarsList\t\t= p.$divCarsList;\n\t$divBlocking\t\t= $divCarsList;\n\tp.$btnViewGrid\t.click( ()=>{ refreshList({ viewMode:list.ViewModes.grid }) } );\n\tp.$btnViewList\t.click( ()=>{ refreshList({ viewMode:list.ViewModes.list }) } );\n\tp.$btnSortName\t.click( ()=>{ refreshList({ sortingField:list.SortingFields.name }) } );\n\tp.$btnSortPrice\t.click( ()=>{ refreshList({ sortingField:list.SortingFields.price }) } );\n\n\treconstructItemsList();\n\n\tcommon.utils.log( 'list.init(): Bind JQuery events' );\n\t$txtSearch.keyup( ()=>{ filterItemsList(); } );\n\t$cbShowInactive.change( ()=>{ filterItemsList(); } );\n\n\tcommon.utils.log( 'list.init(): END' );\n}\n\nfunction reconstructItemsList() : void\n{\n\tcommon.utils.log( 'list.reconstructItemsList(): START' );\n\n\tconst $models = $divCarsList.find( modelSearchString );\n\n\tcommon.utils.log( `list.reconstructItemsList(): Reconstructing ${$models.length} models`  );\n\tconst items : ItemKO[] = [];\n\t$models.each( (i,e)=>\n\t\t{\n\t\t\t// Find the JSON model's tag & set its parent element as the item's container\n\t\t\tconst $modelElement = $(e);\n\t\t\tconst $container = $modelElement.parent();\n\t\t\tconst model = <dto.Item>JSON.parse( $modelElement.text() );\n\n\t\t\t// Remove the model tag (i.e. free memory ?)\n\t\t\t$modelElement.remove();\n\n\t\t\t// Create the ItemKO and add it to the list\n\t\t\tconst item = new ItemKO( $container, model );\n\t\t\titems.push( item );\n\t\t} );\n\n\tcommon.utils.log( 'list.reconstructItemsList(): Replacing itemsList'  );\n\titemsList = items;\n\n\tcommon.utils.log( 'list.reconstructItemsList(): END' );\n}\n\nexport function filterItemsList() : void\n{\n\titemsList.forEach( (item)=>\n\t\t{\n\t\t\titem.visible( item.getIsVisible() );\n\t\t} );\n}\n\nasync function refreshList(p:list.GetListContentRequest) : Promise<void>\n{\n\tcommon.utils.log( 'list.refreshList(): START', { p, currentSortingField } );\n\n\t// Ask for the stripped version of the page (no layout)\n\tp.noLayout = true;\n\n\t// Switch to descending order if required\n\tif( p.sortingField != null )\n\t{\n\t\tif( p.sortingField == currentSortingField )\n\t\t{\n\t\t\tswitch( currentSortingField )\n\t\t\t{\n\t\t\t\tcase list.SortingFields.name:\tp.sortingField = list.SortingFields.name_desc;\tbreak;\n\t\t\t\tcase list.SortingFields.price:\tp.sortingField = list.SortingFields.price_desc;\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tcurrentSortingField = p.sortingField;\n\t}\n\n\tcommon.utils.log( 'list.refreshList(): Request html & replace list DOM' );\n\tcommon.html.block( $divBlocking );\n\tvar html = await list.getListContent( p );\n\tcommon.html.unblock( $divBlocking );\n\t$divCarsList.html( html );\n\n\treconstructItemsList();\n\n\tcommon.utils.log( 'list.refreshList(): END', { currentSortingField } );\n}\n\nclass ItemKO extends dto.ItemKO\n{\n\tpublic readonly $container\t: JQuery;\n\tpublic readonly visible\t\t: KnockoutObservable<boolean>;\n\n\tconstructor($container:JQuery, model:dto.Item)\n\t{\n\t\tconst required = [\tcommon.utils.nameof<dto.ItemKO>('code'),\n\t\t\t\t\t\t\tcommon.utils.nameof<dto.ItemKO>('name'),\n\t\t\t\t\t\t\tcommon.utils.nameof<dto.ItemKO>('descriptionEN'),\n\t\t\t\t\t\t\tcommon.utils.nameof<dto.ItemKO>('descriptionFR'),\n\t\t\t\t\t\t\tcommon.utils.nameof<dto.ItemKO>('descriptionNL'),\n\t\t\t\t\t\t\tcommon.utils.nameof<dto.ItemKO>('active') ];\n\t\tsuper( $container, model, required );\n\t\tconst self = this;\n\t\tthis.$container\t= $container;\n\t\tthis.visible\t= ko.observable( self.getIsVisible() );\n\n\t\t// Bind this object to its container\n\t\tko.applyBindings( self, $container[0] );\n\t}\n\n\tpublic async toggleActive() : Promise<void>\n\t{\n\t\tcommon.utils.log( 'list.ItemKO.toggleActive(): START' );\n\t\tconst self = this;\n\n\t\tcommon.utils.log( 'list.ItemKO.toggleActive(): Retreive original model' );\n\t\tcommon.html.block( $divBlocking );\n\t\t{\n\t\t\tconst rc = await itemCtrl.details( self.code() );\n\t\t\tif(! rc.success )\n\t\t\t{\n\t\t\t\tcommon.html.unblock( $divBlocking );\n\t\t\t\tcommon.utils.error( 'Item retreive error', { rc } );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar model = rc.item;\n\t\t}\n\n\t\tcommon.utils.log( 'list.ItemKO.toggleActive(): Toggle active flag & save' );\n\t\t{\n\t\t\tmodel.active = (! model.active);\n\t\t\tconst rc = await itemCtrl.save({ originalCode:model.code, item:model });\n\t\t\tif(! rc.success )\n\t\t\t\tcommon.utils.error( 'Item save error', { rc } );\n\t\t}\n\n\t\tcommon.utils.log( 'list.ItemKO.toggleActive(): Refresh' );\n\t\tawait refreshList({});\n\n\t\tcommon.html.unblock( $divBlocking );\n\t\tcommon.utils.log( 'list.ItemKO.toggleActive(): END' );\n\t}\n\n\tpublic getIsVisible() : boolean\n\t{\n\t\tconst self = this;\n\n\t\t// Check \"show active\" checkbox\n\n\t\tconst showInactive = $cbShowInactive.is( ':checked' );\n\t\tif( ! self.active() )\n\t\t\tif( ! showInactive )\n\t\t\t\treturn false;\n\n\t\t// Check \"search\" textbox\n\n\t\tlet searchString = <string>$txtSearch.val();\n\t\tsearchString = (searchString == null ? '' : searchString).toLowerCase().trim();\n\t\tif( searchString == '' )\n\t\t\treturn true;\n\t\tlet searchWords : string[] = [];\n\t\t$.each( searchString.split(' '), function(i,word)\n\t\t\t{\n\t\t\t\tif( common.utils.stringIsNullOrWhitespace(word) )\n\t\t\t\t\treturn;\n\t\t\t\tsearchWords.push( word.trim() );\n\t\t\t} );\n\n\t\tconst searchFields : string[] = [];\n\t\tsearchFields.push( self.name() );\n\t\tswitch( common.pageParameters.currentLanguage )\n\t\t{\n\t\t\tcase Languages.en:\tsearchFields.push( self.descriptionEN() );\tbreak;\n\t\t\tcase Languages.fr:\tsearchFields.push( self.descriptionFR() );\tbreak;\n\t\t\tcase Languages.nl:\tsearchFields.push( self.descriptionNL() );\tbreak;\n\t\t}\n\n\t\tlet matchCount = 0;\n\t\tsearchWords.forEach( (word,i)=>\n\t\t\t{\n\t\t\t\tfor( let i=0; i<searchFields.length; ++i )\n\t\t\t\t{\n\t\t\t\t\tconst field = searchFields[i].toLowerCase();\n\t\t\t\t\tif( field.indexOf(word) >= 0 )\n\t\t\t\t\t{\n\t\t\t\t\t\t++ matchCount;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\tif( matchCount != searchWords.length )  // All words must match\n\t\t\treturn false;\n\n\t\treturn true;\n\t}\n}\n","\nimport * as common from \"../common\";\nimport * as dtos from \"../../DTOs/Testimonial\";\nimport * as ctrl from \"../../Services/TestimonialController\";\n\nconst testimonialIdAttribute = 'ttt-testimonial-id';\nvar message_imageUploadError : string;\nconst message_confirmDelete = 'Are you sure you want to delete this testimonial?';\n\nexport var formTestimonial : FormTestimonial;\nvar saveSuccessMessage : string;\n\nexport function init(p:{\turlImgNotFound\t\t\t: string,\n\t\t\t\t\t\t\timageUploadErrorMessage\t: string,\n\t\t\t\t\t\t\tsaveSuccessMessage\t\t: string,\n\t\t\t\t\t\t\t$blockingDiv\t\t\t: JQuery,\n\t\t\t\t\t\t\t$formDialog\t\t\t\t: JQuery,\n\t\t\t\t\t\t\t$picUploadControl\t\t: JQuery }) : void\n{\n\tcommon.utils.log( 'list.init(): START' );\n\n\tmessage_imageUploadError = p.imageUploadErrorMessage;\n\tsaveSuccessMessage = p.saveSuccessMessage;\n\n\tcommon.utils.log( 'list.init(): Create KO for new testimonial form' );\n\tformTestimonial = new FormTestimonial( p.$formDialog, p.$blockingDiv, p.urlImgNotFound );\n\n\tcommon.utils.log( 'list.init(): Init picture upload' );\n\tp.$picUploadControl.click( ()=>\n\t\t{\n\t\t\t// Clear upload control so selecting the same image twice triggers the 'change' event\n\t\t\tp.$picUploadControl.val( null );\n\t\t} );\n\tp.$picUploadControl.change( ()=>\n\t\t{\n\t\t\tconst files = (<HTMLInputElement>p.$picUploadControl[0]).files;\n\t\t\t/*await*/ formTestimonial.uploadPicture( files );\n\t\t} );\n\n\tif( common.pageParameters.isAutenticated )  // Nb: binding actions on testimonial entries is required only for the administrator\n\t{\n\t\tcommon.utils.log( 'list.init(): Bind all testimonial items' );\n\t\t$(`[${testimonialIdAttribute}]`).each( (i,e)=>\n\t\t\t{\n\t\t\t\tconst $e = $(e);\n\t\t\t\tconst id = parseInt( $e.attr(testimonialIdAttribute) );\n\t\t\t\tconst o = new TestimonialItem( id, $e, p.$blockingDiv );\n\t\t\t\tko.applyBindings( o, $e[0] );\n\t\t\t} );\n\t}\n\n\tcommon.utils.log( 'list.init(): END' );\n}\n\nexport class TestimonialItem\n{\n\tprivate readonly\tid\t\t\t\t: number;\n\tprivate readonly\t$blockingDiv\t: JQuery;\n\n\tconstructor(id:number, $container:JQuery, $blockingDiv:JQuery)\n\t{\n\t\tcommon.utils.log( `TestimonialItem(): id:${id}` );\n\t\tthis.id\t\t\t\t= id;\n\t\tthis.$blockingDiv\t= $blockingDiv;\n\t}\n\n\tprotected async toggleActive() : Promise<void>\n\t{\n\t\tconst self = this;\n\t\tcommon.utils.log( `TestimonialItem.toggleActive(): START: id:'${self.id}'` );\n\n\t\tcommon.html.block( self.$blockingDiv );\n\t\tconst rc1 = await ctrl.list({ id:self.id, includeImages:false, includeInactives:true });\n\t\tif(! rc1 )\n\t\t{\n\t\t\tcommon.html.unblock( self.$blockingDiv );\n\t\t\tcommon.utils.error( 'retreive testimonial error', { rc1 } );\n\t\t\tcommon.html.showMessage( rc1.errorMessage );\n\t\t\treturn;\t\n\t\t}\n\t\tif( rc1.testimonials.length != 1 )\n\t\t{\n\t\t\tcommon.html.showMessage( 'Error while retreiving testimonial' );\n\t\t\treturn;\n\t\t}\n\t\tconst dto = rc1.testimonials[0];\n\n\t\tcommon.utils.log( `TestimonialItem.toggleActive(): Create save request` );\n\t\tdto.active = dto.active ? false : true;\n\t\tconst saveRequest : ctrl.SaveRequest = $.extend( dto, { saveImage:false } );\n\n\t\tcommon.utils.log( 'TestimonialItem.toggleActive(): Send the save request' );\n\t\tconst rc2 = await ctrl.save( saveRequest );\n\t\tcommon.html.unblock( self.$blockingDiv );\n\t\tif(! rc2.success )\n\t\t{\n\t\t\tcommon.utils.error( 'TestimonialItem.toggleActive(): Error', { rc2 } );\n\t\t\tcommon.html.showMessage( rc2.errorMessage );\n\t\t\treturn;\n\t\t}\n\n\t\tcommon.utils.log( 'TestimonialItem.toggleActive(): Reload page' );\n\t\tlocation.reload();\n\n\t\tcommon.utils.log( 'TestimonialItem.toggleActive(): END' );\n\t}\n\n\tprotected async edit() : Promise<void>\n\t{\n\t\tconst self = this;\n\t\tcommon.utils.log( `TestimonialItem.edit(): START: id:'${self.id}'` );\n\n\t\tcommon.html.block( self.$blockingDiv );\n\t\tconst rc1 = await ctrl.list({ id:self.id, includeImages:true, includeInactives:true });\n\t\tcommon.html.unblock( self.$blockingDiv );\n\t\tif(! rc1 )\n\t\t{\n\t\t\tcommon.utils.error( 'retreive testimonial error', { rc1 } );\n\t\t\tcommon.html.showMessage( rc1.errorMessage );\n\t\t\treturn;\t\n\t\t}\n\t\tif( rc1.testimonials.length != 1 )\n\t\t{\n\t\t\tcommon.html.showMessage( 'Error while retreiving testimonial' );\n\t\t\treturn;\n\t\t}\n\t\tconst dto = rc1.testimonials[0];\n\n\t\tformTestimonial.show( dto );\n\n\t\tcommon.utils.log( `TestimonialItem.edit(): START: id:'${self.id}'` );\n\t}\n\n\tprotected async delete_() : Promise<void>\n\t{\n\t\tconst self = this;\n\t\tcommon.utils.log( 'TestimonialItem.delete_(): START' );\n\n\t\tcommon.utils.log( 'TestimonialItem.delete_(): Ask confirmation' );\n\t\tconst rc1 = await common.html.confirm( message_confirmDelete );\n\t\tif(! rc1 )\n\t\t{\n\t\t\tcommon.utils.log( 'TestimonialItem.delete_(): NOT CONFIRMED' );\n\t\t\treturn;\n\t\t}\n\n\t\tcommon.utils.log( 'TestimonialItem.delete_(): Launch delete request' );\n\t\tcommon.html.block( self.$blockingDiv );\n\t\tconst rc2 = await ctrl.delete_( self.id )\n\t\tcommon.html.unblock( self.$blockingDiv );\n\t\tif(! rc2.success )\n\t\t{\n\t\t\tcommon.utils.error( 'TestimonialItem.delete_(): Error', { rc2 } );\n\t\t\tcommon.html.showMessage( rc2.errorMessage );\n\t\t\treturn;\n\t\t}\n\n\t\tcommon.utils.log( 'TestimonialItem.delete_(): Reload page' );\n\t\tlocation.reload();\n\n\t\tcommon.utils.log( 'TestimonialItem.delete_(): END' );\n\t}\n}\n\nclass FormTestimonial\n{\n\tprivate readonly\t$container\t\t: JQuery;\n\tprivate readonly\t$blockingDiv\t: JQuery;\n\tprotected readonly\tshowRequiredText: KnockoutObservable<boolean>;\n\n\tprivate\t\t\t\tmodel\t\t\t: dtos.Testimonial;\n\n\tprotected readonly\tdate\t\t\t: KnockoutObservable<string>;\n\tprotected readonly\tfirstLastName\t: KnockoutObservable<string>;\n\tprotected readonly\twhosWho\t\t\t: KnockoutObservable<string>;\n\tprotected readonly\ttext\t\t\t: KnockoutObservable<string>;\n\tprotected readonly\tactive\t\t\t: KnockoutObservable<boolean>;\n\tprotected readonly\timageData\t\t: KnockoutObservable<string>;\n\tprotected readonly\timageSrc\t\t: KnockoutComputed<string>;\n\n\tconstructor($container:JQuery, $blockingDiv:JQuery, urlImgNotFound:string)\n\t{\n\t\tconst self = this;\n\t\tthis.$container\t\t\t= $container;\n\t\tthis.$blockingDiv\t\t= $blockingDiv;\n\t\tthis.showRequiredText\t= ko.observable( false );\n\t\tthis.model\t\t\t\t= null;\n\t\tthis.date\t\t\t\t= ko.observable( '' );\n\t\tthis.firstLastName\t\t= ko.observable( '' );\n\t\tthis.whosWho\t\t\t= ko.observable( '' );\n\t\tthis.text\t\t\t\t= ko.observable( '' );\n\t\tthis.active\t\t\t\t= ko.observable( false );\n\t\tthis.imageData\t\t\t= ko.observable( null );\n\t\tthis.imageSrc\t\t\t= ko.computed( ()=>\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tconst data = self.imageData();\n\t\t\t\t\t\t\t\t\t\t\tif( data == null )\n\t\t\t\t\t\t\t\t\t\t\t\treturn urlImgNotFound;\n\t\t\t\t\t\t\t\t\t\t\treturn data;\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\tcommon.utils.log( 'FormTestimonial(): Bind to the Boostrap\\'s close event' );\n\t\tself.$container.on( 'hidden.bs.modal', ()=>self.reset() );\n\n\t\tcommon.utils.log( 'FormTestimonial(): KO bind the form dialog' );\n\t\tko.applyBindings( self, self.$container[0] );\n\t}\n\n\tpublic show(dto:dtos.Testimonial) : void\n\t{\n\t\tcommon.utils.log( 'FormTestimonial.show(): START', { dto } );\n\t\tconst self = this;\n\n\t\tself.reset( dto );\n\t\tself.open();\n\n\t\tcommon.utils.log( 'FormTestimonial.show(): END' );\n\t}\n\n\tpublic async uploadPicture(files:FileList) : Promise<void>\n\t{\n\t\tcommon.utils.log( 'FormTestimonial.uploadPicture(): START', {files} );\n\t\tconst self = this;\n\n\t\tif( files.length == 0 )\n\t\t\treturn;\n\t\tif( (<any>window).FormData === undefined )\n\t\t{\n\t\t\tcommon.utils.error( \"This browser doesn't support HTML5 file uploads!\" );\n\t\t\treturn;\n\t\t}\n\n\t\tcommon.html.block( self.$blockingDiv );\n\t\tconst rc = await ctrl.uploadPicture( files[0] );\n\t\tcommon.html.unblock( self.$blockingDiv );\n\t\tif(! rc.success )\n\t\t{\n\t\t\tcommon.utils.error( 'FormTestimonial.uploadPicture(): Error', { rc } );\n\t\t\tcommon.html.showMessage( /*rc.errorMessage*/message_imageUploadError );\n\t\t\treturn;\n\t\t}\n\n\t\tself.imageData( rc.imageData );\n\n\t\tcommon.utils.log( 'FormTestimonial.uploadPicture(): END' );\n\t}\n\n\tprivate reset(dto?:dtos.Testimonial) : void\n\t{\n\t\tcommon.utils.log( 'FormTestimonial.reset(): START' );\n\t\tconst self = this;\n\n\t\tif( dto == null )\n\t\t{\n\t\t\tself.model = null;\n\n\t\t\tself.date( '' );\n\t\t\tself.firstLastName( '' );\n\t\t\tself.whosWho( '' );\n\t\t\tself.text( '' );\n\t\t\tself.active( false );\n\t\t\tself.imageData( null );\n\t\t}\n\t\telse\n\t\t{\n\t\t\tself.model = dto;\n\n\t\t\tself.date( dto.date );\n\t\t\tself.firstLastName( dto.firstLastName );\n\t\t\tself.whosWho( dto.whosWho );\n\t\t\tself.text( dto.text );\n\t\t\tself.active( dto.active );\n\t\t\tself.imageData( dto.imageData );\n\t\t}\n\n\t\tcommon.utils.log( 'FormTestimonial.reset(): END' );\n\t}\n\n\tprivate open() : void\n\t{\n\t\tcommon.utils.log( 'FormTestimonial.open(): START' );\n\t\tthis.$container.modal( 'show' );\n\t\tcommon.utils.log( 'FormTestimonial.open(): END' );\n\t}\n\n\tprotected close() : void\n\t{\n\t\tcommon.utils.log( 'FormTestimonial.close(): START' );\n\t\tthis.$container.modal( 'hide' );\n\t\tcommon.utils.log( 'FormTestimonial.close(): END' );\n\t}\n\n\tprotected async save() : Promise<void>\n\t{\n\t\tcommon.utils.log( 'FormTestimonial.save(): START' );\n\t\tconst self = this;\n\n\t\tif( common.utils.stringIsNullOrWhitespace( self.firstLastName() )\n\t\t || common.utils.stringIsNullOrWhitespace( self.whosWho() )\n\t\t || common.utils.stringIsNullOrWhitespace( self.text() ) )\n\t\t{\n\t\t\tself.showRequiredText( true );\n\t\t\treturn;\n\t\t}\n\n\t\tconst fields = {\n\t\t\t\tdate\t\t\t: self.date(),\n\t\t\t\tfirstLastName\t: self.firstLastName(),\n\t\t\t\twhosWho\t\t\t: self.whosWho(),\n\t\t\t\ttext\t\t\t: self.text(),\n\t\t\t\tactive\t\t\t: self.active(),\n\t\t\t\timageData\t\t: self.imageData(),\n\t\t\t\tsaveImage\t\t: true,\n\t\t\t};\n\t\tlet saveRequest : ctrl.SaveRequest;\n\t\tif( self.model == null )\n\t\t\t// add new\n\t\t\tsaveRequest = $.extend( { date:'', active:false }, fields );\n\t\telse\n\t\t\t// edit existing\n\t\t\tsaveRequest = $.extend( self.model, fields );\n\n\t\tcommon.utils.log( 'FormTestimonial.save(): Send the save request' );\n\t\tcommon.html.block( self.$blockingDiv );\n\t\tconst rc = await ctrl.save( saveRequest );\n\t\tcommon.html.unblock( self.$blockingDiv );\n\t\tif(! rc.success )\n\t\t{\n\t\t\tcommon.utils.error( 'FormTestimonial.save(): Error', { rc } );\n\t\t\tcommon.html.showMessage( rc.errorMessage );\n\t\t\treturn;\n\t\t}\n\n\t\tif( common.pageParameters.isAutenticated )\n\t\t{\n\t\t\tcommon.utils.log( 'FormTestimonial.save(): Refresh page' );  // nb: list may have changed\n\t\t\tlocation.reload();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcommon.utils.log( 'FormTestimonial.save(): Close & show success message' );\n\t\t\tself.close();\n\t\t\tcommon.html.showMessage( saveSuccessMessage );\n\t\t}\n\n\t\tcommon.utils.log( 'FormTestimonial.save(): END' );\n\t}\n}\n","\r\nimport * as common from \"./common\";\r\nimport { PageParameters } from \"../PageHelper\";\r\nimport { Routes } from \"../Routes\";\r\n\r\n\r\nexport const debugMessages : boolean = false;  // NB: 'export' so that it can be easily changed from the browser's console\r\nexport var pageParameters : PageParameters;\r\nexport var routes : Routes;\r\n\r\nexport function init(p:{ pageParameters:PageParameters })\r\n{\r\n\tpageParameters = p.pageParameters;\r\n\troutes = pageParameters.routes;\r\n\tutils.log( 'common.init()' );\r\n\r\n\tif( pageParameters.hasErrors )\r\n\t{\r\n\t\tutils.log( 'common.init(): Page has errors! ; outputting the logs' );\r\n\t\tcommon.utils.error( 'Page has errors!', { log:pageParameters.logs } );\r\n\t}\r\n\r\n\tutils.log( 'common.init(): Add custom KnockoutHandler' );\r\n\r\n\tko.bindingHandlers.ttt_autocomplete =\r\n\t\t{\r\n\t\t\tinit: (element,valueAccessor)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconst searchFunction : (term:string)=>Promise<string[]> = valueAccessor();\r\n\t\t\t\t\t\t$(element).autocomplete( {\tminLength\t: 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsource\t\t: async (request:{term:string}, resolve:(list:string[])=>void)=>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst list = await searchFunction( request.term );\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tresolve( list );\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t},\r\n\t\t};\r\n\r\n\t// cf. https://knockoutjs.com/examples/animatedTransitions.html\r\n\tko.bindingHandlers.ttt_slideUpDownVisible =\r\n\t\t{\r\n\t\t\tinit: (element,valueAccessor)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconst value = ko.unwrap( valueAccessor() );\r\n\t\t\t\t\t\tif(! value )\r\n\t\t\t\t\t\t\t$(element).hide();\r\n\t\t\t\t\t},\r\n\t\t\tupdate: (element,valueAccessor)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconst value = ko.unwrap( valueAccessor() );\r\n\t\t\t\t\t\tif( value )\r\n\t\t\t\t\t\t\t$(element).slideDown();\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t$(element).slideUp();\r\n\t\t\t\t\t}\r\n\t\t};\r\n\tko.bindingHandlers.ttt_slideLeftRightVisible =\r\n\t\t{\r\n\t\t\tinit: (element,valueAccessor)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconst value = ko.unwrap( valueAccessor() );\r\n\t\t\t\t\t\tif(! value )\r\n\t\t\t\t\t\t\t$(element).hide();\r\n\t\t\t\t\t},\r\n\t\t\tupdate: (element,valueAccessor)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconst value = ko.unwrap( valueAccessor() );\r\n\t\t\t\t\t\tif( value )\r\n\t\t\t\t\t\t\t$(element).show( 'blind', { direction: 'left' } );\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t$(element).hide( 'blind', { direction: 'left' } );\r\n\t\t\t\t\t}\r\n\t\t};\r\n\r\n\tko.bindingHandlers.ttt_blink =\r\n\t\t{\r\n\t\t\tinit: (element,valueAccessor)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// Initially hidden\r\n\t\t\t\t\t\t$(element).hide();\r\n\r\n\t\t\t\t\t\t// Initial value must always be 'false'\r\n\t\t\t\t\t\tconst koValue = valueAccessor();\r\n\t\t\t\t\t\tkoValue( false );\r\n\t\t\t\t\t},\r\n\t\t\tupdate: (element,valueAccessor)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconst $element = $(element);\r\n\t\t\t\t\t\tconst koValue = valueAccessor();\r\n\t\t\t\t\t\tif( koValue() == true )\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t// Switched to 'true' => animate\r\n\t\t\t\t\t\t\t$element.fadeIn().delay(1000).fadeOut( ()=>\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t// then revert to 'false'\r\n\t\t\t\t\t\t\t\t\tkoValue( false );\r\n\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t};\r\n}\r\n\r\nexport namespace utils\r\n{\r\n\texport function log(...optionalParams: any[]) : void\r\n\t{\r\n\t\tif( pageParameters.isDebug )\r\n\t\t\tconsole.log.apply( console, arguments );\r\n\t}\r\n\r\n\texport function error(...optionalParams: any[]) : void\r\n\t{\r\n\t\tconsole.error.apply( console, arguments );\r\n\t}\r\n\r\n\t/** cf. https://schneidenbach.gitbooks.io/typescript-cookbook/nameof-operator.html */\r\n\texport const nameof = <T>(name: keyof T) => name;\r\n\r\n\t/** Function to simulate string-valued enums\r\n\t * Based on: https://basarat.gitbooks.io/typescript/docs/types/literal-types.html\r\n\t * Returns: { e:the enum , a:the array specified as parameter } */\r\n\texport function strEnum<T extends string>(a:Array<T>): { e:{[K in T]: K}, a:T[] }\r\n\t{\r\n\t\tconst e = a.reduce( (res, key)=>\r\n\t\t\t{\r\n\t\t\t\tres[key] = key;\r\n\t\t\t\treturn res;\r\n\t\t\t}, Object.create(null) );\r\n\t\treturn { e, a };\r\n\t}\r\n\r\n\texport function stringIsNullOrEmpty(str:string) : boolean\r\n\t{\r\n\t\tif( str == null )\r\n\t\t\treturn true;\r\n\t\tif( str == '' )\r\n\t\t\treturn true;\r\n\t\treturn false;\r\n\t}\r\n\texport function stringIsNullOrWhitespace(str:string) : boolean\r\n\t{\r\n\t\tif( str == null )\r\n\t\t\treturn true;\r\n\t\tif( str.trim() == '' )\r\n\t\t\treturn true;\r\n\t\treturn false;\r\n\t}\r\n\r\n\texport function htmlEncode(txt:string|string[]) : string\r\n\t{\r\n\t\t// TODO: Find a better way ?\r\n\t\tif( Array.isArray(txt) )\r\n\t\t\treturn $.map( <string[]>txt, v=>$(document.createElement('span')).text( v ).html() ).join( '<br/>' );\r\n\t\telse\r\n\t\t\treturn $(document.createElement('span')).text( txt ).html();\r\n\t}\r\n\r\n\texport function arrayContains<T>(a:T[], item:any) : boolean\r\n\t{\r\n\t\treturn ( a.indexOf( item ) >= 0 );\r\n\t}\r\n\r\n//ES5 incompatible ...\r\n//\texport function arrayUnique<T>(a:T[]) : T[]\r\n//\t{\r\n//\t\t//return a.filter( (v,i)=>( a.indexOf(v) === i ) );\r\n//\t\treturn [ ... new Set(a) ];\r\n//\t}\r\n\r\n\texport function arrayRemoveItem<T>(a:T[], item:T) : boolean\r\n\t{\r\n\t\tlet i = a.indexOf( item );\r\n\t\tif( i < 0 )\r\n\t\t\treturn false;\r\n\t\ta.splice( i, 1 );\r\n\t\treturn true;\r\n\t}\r\n\r\n\texport function arraySum<T>(a:T[], f:(e:T)=>number) : number\r\n\t{\r\n\t\tlet rc = 0;\r\n\t\ta.forEach( function(e)\r\n\t\t\t{\r\n\t\t\t\trc += f(e);\r\n\t\t\t} );\r\n\t\treturn rc;\r\n\t}\r\n\r\n\texport function arrayMoveItem<T>(p:{ list:T[], item:T, direction?:'up'|'down' }) : T[]\r\n\t{\r\n\t\t// NB: Does not yet work when n>1 ...\r\n\r\n\t\tlet n = 1;\r\n\t\tif( p.direction != null )\r\n\t\t\tn = (p.direction == 'up') ? -n : n;\r\n\t\tconst i = p.list.indexOf( p.item );  // Start position\r\n\t\tif( i < 0 )\r\n\t\t\tthrow { error:'Could not find item in list', item:p.item };\r\n\t\tlet j = i + n;  // End position\r\n\t\tif( j < 0 )\r\n\t\t\tj = 0;\r\n\t\telse if( j >= p.list.length )\r\n\t\t\tj = p.list.length - 1;\r\n\t\tif( i == j )\r\n\t\t\t// NOOP\r\n\t\t\treturn p.list;\r\n\r\n\t\t// Swap items here\r\n\t\tconst tmp = p.list[ i ];\r\n\t\tp.list[ i ] = p.list[ j ];\r\n\t\tp.list[ j ] = tmp;\r\n\r\n\t\treturn p.list;\r\n\t}\r\n\r\n\texport function ensureInteger(p:{\tobservable:KnockoutObservable<Number>,\r\n\t\t\t\t\t\t\t\t\t\tfallbackValue?:number,\r\n\t\t\t\t\t\t\t\t\t\tmustBePositive?:boolean,\r\n\t\t\t\t\t\t\t\t\t\tcanBeZero?:boolean,\r\n\t\t\t\t\t\t\t\t\t\tcanBeNull?:boolean }) : void\r\n\t{\r\n\t\tif( p.canBeZero == null )\r\n\t\t\tp.canBeZero = true;\r\n\t\tif( p.canBeNull == null )\r\n\t\t\tp.canBeNull = false;\r\n\t\tif( p.fallbackValue == null )\r\n\t\t{\r\n\t\t\tif( p.canBeZero )\r\n\t\t\t\tp.fallbackValue = 0;\r\n\t\t\telse\r\n\t\t\t\tp.fallbackValue = 1;\r\n\t\t}\r\n\r\n\t\tlet canBeNull = p.canBeNull;\r\n\t\tp.observable.subscribe( function(value:number)\r\n\t\t\t{\r\n\t\t\t\tif( canBeNull )\r\n\t\t\t\t{\r\n\t\t\t\t\tif( (<any>value == '') || (value == null) )\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tp.observable( null );\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar newValue = parseInt( <any>value );\r\n\r\n\t\t\t\tif( isNaN(newValue) )\r\n\t\t\t\t\tnewValue = p.fallbackValue;\r\n\t\t\t\telse if( (!p.canBeZero) && (value == 0) )\r\n\t\t\t\t\tnewValue = p.fallbackValue;\r\n\t\t\t\telse if( (p.mustBePositive) && (value < 0) )\r\n\t\t\t\t\tnewValue = p.fallbackValue;\r\n\r\n\t\t\t\tif( value !== newValue )\r\n\t\t\t\t\t// Value must be changed\r\n\t\t\t\t\tp.observable( newValue );\r\n\t\t\t} );\r\n\t}\r\n\r\n\t/** Generates a GUID-like string (something that looks like one, but NOT a real one!!!)\r\n\t * cf. http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript */\r\n\texport function newGuid() : string\r\n\t{\r\n\t\tvar S4 = function() : string\r\n\t\t{\r\n\t\t\treturn (((1+Math.random())*0x10000)|0).toString(16).substring(1);\r\n\t\t};\r\n\t\treturn (S4()+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+S4()+S4());\r\n\t}\r\n\r\n\texport function sleep(ms:number) : Promise<void>\r\n\t{\r\n\t\treturn new Promise( resolve => setTimeout(resolve, ms) );\r\n\t}\r\n} // namespace utils\r\n\r\nexport namespace html\r\n{\r\n\texport function showMessage(msg:string) : void\r\n\t{\r\n\t\t// Bootstrap style:\r\n\t\tconst html = `<div class=\"modal\" tabindex=\"-1\" role=\"dialog\">\r\n\t\t\t\t\t\t<div class=\"modal-dialog\" role=\"document\">\r\n\t\t\t\t\t\t\t<div class=\"modal-content\">\r\n\t\t\t\t\t\t\t\t<div class=\"modal-body\">\r\n\t\t\t\t\t\t\t\t\t<!-- Text content here -->\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"modal-footer\">\r\n\t\t\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Close</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>`;\r\n\t\tconst $div = $(html);\r\n\t\t$div.find( '.modal-body' ).text( msg );\r\n\t\t$div.modal();\r\n\r\n\t\t// JQuery style:\r\n\t\t// var $div = $('<div/>').text('Hello world');\r\n\t\t// $('body').append( $div );\r\n\t\t// $div.dialog()\r\n\t}\r\n\r\n\texport function confirm(msg:string) : Promise<boolean>\r\n\t{\r\n\t\t// Bootstrap style:\r\n\t\tconst html = `<div class=\"modal\" tabindex=\"-1\" role=\"dialog\">\r\n\t\t\t\t\t\t<div class=\"modal-dialog\" role=\"document\">\r\n\t\t\t\t\t\t\t<div class=\"modal-content\">\r\n\t\t\t\t\t\t\t\t<div class=\"modal-body\">\r\n\t\t\t\t\t\t\t\t\t<!-- Text content here -->\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"modal-footer\">\r\n\t\t\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-primary\">Ok</button>\r\n\t\t\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Cancel</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>`;\r\n\t\tconst $div = $(html);\r\n\t\t$div.find( '.modal-body' ).text( msg );\r\n\t\treturn new Promise<boolean>( (resolve)=>\r\n\t\t\t{\r\n\t\t\t\tlet confirmed = false;\r\n\t\t\t\t$div.find( '.btn-primary' ).click( ()=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconfirmed = true;\r\n\t\t\t\t\t\t$div.modal( 'hide' );\r\n\t\t\t\t\t\tresolve( true );\r\n\t\t\t\t\t} );\r\n\t\t\t\t$div.on( 'hidden.bs.modal', (e)=>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif( confirmed )\r\n\t\t\t\t\t\t\t// Clicked on 'Save' => NOOP\r\n\t\t\t\t\t\t\t// nb: should not happen, but in case ...\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t// Manually closed => Cancel\r\n\t\t\t\t\t\tresolve( false );\r\n\t\t\t\t\t} );\r\n\t\t\t\t$div.modal();\r\n\t\t\t} );\r\n\r\n\t\t// JQuery style:\r\n\t\t// TODO ...\r\n\t}\r\n\r\n\t/** Invoke jQuery.blockUI's '.block()' on the specified element but supports multiple invokation on the same element */\r\n\texport function block($e:JQuery) : JQuery\r\n\t{\r\n\t\t// Insert/increment a block counter as jQuery 'data()'\r\n\t\tvar blockCounter = ( $e.data('ttt_blockCounter')|0 ) + 1;\r\n\t\t$e.data( 'ttt_blockCounter', blockCounter );\r\n\r\n\t\tif( blockCounter == 1 )\r\n\t\t\t// This element is not blocked yet\r\n\t\t\t(<any>$e).block();  // TODO: ACA: jQuery.blockUI typings ...\r\n\r\n\t\treturn $e;\r\n\t}\r\n\r\n\t/** Invoke jQuery.blockUI's '.unblock()' on the specified element except if it has been block()ed more than once */\r\n\texport function unblock($e:JQuery) : JQuery\r\n\t{\r\n\t\t// Decrement the block counter in the jQuery 'data()'\r\n\t\tvar blockCounter = ( $e.data('ttt_blockCounter')|0 ) - 1;\r\n\t\t$e.data( 'ttt_blockCounter', blockCounter );\r\n\r\n\t\tif( blockCounter < 0 )\r\n\t\t{\r\n\t\t\t// There is a logic error somewhere...\r\n\t\t\tcommon.utils.error( 'INTERNAL ERROR: Unblock count > block count:', blockCounter );\r\n\r\n\t\t\t// Reset counter\r\n\t\t\tblockCounter = 0;\r\n\t\t\t$e.data( 'ttt_blockCounter', 0 );\r\n\t\t}\r\n\r\n\t\tif( blockCounter == 0 )\r\n\t\t\t// This element is no more blocked by anything else\r\n\t\t\t(<any>$e).unblock();  // TODO: ACA: jQuery.blockUI typings ...\r\n\r\n\t\treturn $e;\r\n\t}\r\n\r\n\texport function ensureVisible($e:JQuery) : void\r\n\t{\r\n\t\t// Scroll\r\n\t\tconst offset = $e.offset().top - ( 20 + $e.height() );\r\n\t\t$('html, body').animate({ scrollTop:offset });  // cf.: https://stackoverflow.com/questions/4884839/how-do-i-get-an-element-to-scroll-into-view-using-jquery?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa\r\n\r\n\t\t// Blink\r\n\t\t$e.effect( \"highlight\", {}, 2000 );  // cf.: https://stackoverflow.com/questions/5205445/jquery-blinking-highlight-effect-on-div?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa\r\n\t}\r\n\r\n\texport function waitForScrolledVisible($elem:JQuery) : Promise<void>\r\n\t{\r\n\t\tconst $window = $(window);\r\n\r\n\t\tfunction isScrolledVisible()\r\n\t\t{\r\n\t\t\tconst docViewTop = $window.scrollTop();\r\n\t\t\tconst docViewBottom = docViewTop + $window.height();\r\n\r\n\t\t\tconst elemTop = $elem.offset().top;\r\n\t\t\tconst elemBottom = elemTop + $elem.height();\r\n\t\t\treturn ((elemBottom <= docViewBottom) && (elemTop >= docViewTop));\r\n\t\t}\r\n\r\n\t\treturn new Promise( (resolve)=>\r\n\t\t\t{\r\n\t\t\t\tlet scrollHandler : ()=>void;\r\n\t\t\t\tscrollHandler = function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif(! isScrolledVisible() )\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t// This is a one-shot only => unbind myself\r\n\t\t\t\t\t$window.unbind( 'scroll', scrollHandler );\r\n\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif( isScrolledVisible() )\r\n\t\t\t\t\t// Element is visible right now => no need to bind to scroll event\r\n\t\t\t\t\tresolve();\r\n\t\t\t\telse  // Bind to scroll event & wait for $elem to be visible\r\n\t\t\t\t\t$window.bind( 'scroll', scrollHandler );\r\n\t\t\t} );\r\n\t}\r\n} // namespace html\r\n\r\nexport namespace url\r\n{\r\n\tconst onChangedEvent = 'onUrlChanged';\r\n\tvar onChangedCallbacks = $({});\r\n\tvar onChangedCallbacksRegistered = false;\r\n\r\n\texport function redirect(url:string)\r\n\t{\r\n\t\twindow.location.href = url;\r\n\t}\r\n\r\n\t/** Parse a parameters string like 'foo=bar&hello=world' and return the a dictionary like {foo:'bar',hello:'world'} */\r\n\texport function parseParameters(searchString?:string) : {[key:string]:any}\r\n\t{\r\n\t\tif( searchString == null )\r\n\t\t\tsearchString = window.location.search.substring(1);\r\n\t\tif( searchString.length == 0 )\r\n\t\t\treturn {};\r\n\r\n\t\tvar tokens = searchString.split( '&' );\r\n\r\n\t\tvar dict = <{[key:string]:any}>{};\r\n\t\tfor( var i=0; i < tokens.length; ++i )\r\n\t\t{\r\n\t\t\tvar pairs = tokens[i].split( '=' );\r\n\t\t\tvar key = decodeURIComponent( pairs[0] );\r\n\t\t\tvar value = decodeURIComponent( pairs[1] );\r\n\r\n\t\t\t// Try parse JSON\r\n\t\t\ttry { value = JSON.parse(value); }\r\n\t\t\tcatch( ex ){/* Not JSON => Keep the string as-is*/}\r\n\r\n\t\t\tdict[ key ] = value;\r\n\t\t}\r\n\t\treturn dict;\r\n\t}\r\n\r\n\t/** Transform a dictionary like {foo:'bar',hello:'world'} to a parameters string like 'foo=bar&hello=world' */\r\n\texport function stringifyParameters(parms:{[key:string]:any}) : string\r\n\t{\r\n\t\tvar pairs = <string[]>[];\r\n\t\t$.each( parms, function(key:string,value)\r\n\t\t\t{\r\n\t\t\t\tkey = encodeURIComponent( key );\r\n\r\n\t\t\t\tif( (value == null) || (typeof(value) === 'string') || (typeof(value) === 'number') || (typeof(value) === 'boolean') )\r\n\t\t\t\t\t{/*Keep as-is*/}\r\n\t\t\t\telse\r\n\t\t\t\t\t// Convert to JSON\r\n\t\t\t\t\tvalue = JSON.stringify( value );\r\n\t\t\t\tvalue = encodeURIComponent( value );\r\n\r\n\t\t\t\tpairs.push( key+\"=\"+value );\r\n\t\t\t} );\r\n\t\treturn pairs.join( '&' );\r\n\t}\r\n\r\n\t/** Registers a callback to be invoked whenever the browser's URL changes (cf. 'pushHistory()') */\r\n\texport function onChanged(callback:()=>void) : void\r\n\t{\r\n\t\t// NB: The callback gets invoked ALSO when 'pushHistory()' is invoked\r\n\r\n\t\tif( onChangedCallbacksRegistered == false )\r\n\t\t{\r\n\t\t\t$(window).bind( 'popstate', function(evt)\r\n\t\t\t\t{\r\n\t\t\t\t\tonChangedCallbacks.trigger( onChangedEvent );\r\n\t\t\t\t} );\r\n\t\t\tonChangedCallbacksRegistered = true;\r\n\t\t}\r\n\r\n\t\tonChangedCallbacks.bind( onChangedEvent, callback );\r\n\t}\r\n\r\n\texport function createUrl(p:{ pathname?:string, parameters?:{[key:string]:any} }) : string\r\n\t{\r\n\t\tvar newPath = p.pathname;\r\n\t\tif( newPath == null )\r\n\t\t\tnewPath = window.location.pathname;\r\n\r\n\t\tif( p.parameters != null )\r\n\t\t{\r\n\t\t\tconst queryString = stringifyParameters( p.parameters );\r\n\t\t\tif( queryString.length > 0 )\r\n\t\t\t\tnewPath = newPath+'?'+queryString;\r\n\t\t}\r\n\t\treturn newPath;\r\n\t}\r\n\r\n\t/** Change the browser's current URL without triggering an HTTP request (NB: Will trigger any registered 'onChanged()' callbacks) */\r\n\texport function pushHistory(p:{ pathname?:string, parameters?:{[key:string]:any}, newTitle?:string }) : void\r\n\t{\r\n\t\tconst newPath = createUrl( p );\r\n\t\twindow.history.pushState( {}, p.newTitle, newPath );\r\n\r\n\t\t// Invoke any registered callbacks\r\n\t\tonChangedCallbacks.trigger( onChangedEvent );\r\n\t}\r\n\r\n\texport function postRequestForm<T>(url:string, request:{[key:string]:any}) : Promise<T>\r\n\t{\r\n\t\tutils.log( 'postRequestForm', { url, request } );\r\n\t\treturn new Promise<T>( (resolve,reject)=>\r\n\t\t\t{\r\n\t\t\t\t$.ajax({\ttype\t\t: 'POST',\r\n\t\t\t\t\t\t\turl\t\t\t: url,\r\n\t\t\t\t\t\t\tcontentType\t: 'application/x-www-form-urlencoded',\r\n\t\t\t\t\t\t\tdata\t\t: request,\r\n\t\t\t\t\t\t\tdataType\t: 'json',\r\n\t\t\t\t\t\t\tsuccess\t\t: (data,textStatus,jqXHR)=>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tutils.log( 'postRequestForm', { response:data } );\r\n\t\t\t\t\t\t\t\t\t\t\t\tresolve( data );\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\terror\t\t: (jqXHR,textStatus,errorThrown)=>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tutils.error( 'postRequestForm rejected', { jqXHR, textStatus, errorThrown } );\r\n\t\t\t\t\t\t\t\t\t\t\t\treject( textStatus );\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t} );\r\n\t}\r\n\r\n\texport function postRequestFormData<T>(url:string, formData:FormData) : Promise<T>\r\n\t{\r\n\t\tutils.log( 'postRequestFormData', { url, formData } );\r\n\t\treturn new Promise<T>( (resolve,reject)=>\r\n\t\t\t{\r\n\t\t\t\t$.ajax( {\ttype\t\t: \"POST\",\r\n\t\t\t\t\t\t\turl\t\t\t: url,\r\n\t\t\t\t\t\t\tcontentType\t: false,\r\n\t\t\t\t\t\t\tprocessData\t: false,\r\n\t\t\t\t\t\t\tdata\t\t: formData,\r\n\t\t\t\t\t\t\tdataType\t: 'json',\r\n\t\t\t\t\t\t\tsuccess\t\t: (data:T,textStatus,jqXHR)=>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tutils.log( 'postRequestFormData', { response:data } );\r\n\t\t\t\t\t\t\t\t\t\t\t\tresolve( data );\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\terror\t\t: (jqXHR,textStatus,errorThrown)=>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tutils.error( 'postRequestFormData rejected', { jqXHR, textStatus, errorThrown } );\r\n\t\t\t\t\t\t\t\t\t\t\t\treject( textStatus );\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t} );\r\n\t\t\t} );\r\n\t}\r\n\r\n\texport function postRequestJSON<T>(url:string, request:{[key:string]:any}) : Promise<T>\r\n\t{\r\n\t\tutils.log( 'postRequestJSON', { url, request } );\r\n\t\tlet requestStr = JSON.stringify( request );\r\n\t\treturn new Promise<T>( (resolve,reject)=>\r\n\t\t\t{\r\n\t\t\t\t$.ajax({\ttype\t\t: 'POST',\r\n\t\t\t\t\t\t\turl\t\t\t: url,\r\n\t\t\t\t\t\t\tcontentType\t: 'application/json',\r\n\t\t\t\t\t\t\tdata\t\t: requestStr,\r\n\t\t\t\t\t\t\tdataType\t: 'json',\r\n\t\t\t\t\t\t\tsuccess\t\t: (data,textStatus,jqXHR)=>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tutils.log( 'postRequestJSON', { response:data } );\r\n\t\t\t\t\t\t\t\t\t\t\t\tresolve( data );\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\terror\t\t: (jqXHR,textStatus,errorThrown)=>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tutils.error( 'postRequestJSON rejected', { jqXHR, textStatus, errorThrown } );\r\n\t\t\t\t\t\t\t\t\t\t\t\treject( textStatus );\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t} );\r\n\t}\r\n\r\n\texport function getRequest(url:string, request?:{[key:string]:any}) : Promise<string>\r\n\t{\r\n\t\tif( request != null )\r\n\t\t{\r\n\t\t\tconst parms = stringifyParameters( request );\r\n\t\t\turl = `${url}?${parms}`;\r\n\t\t}\r\n\t\tutils.log( 'getRequest', { url, request } );\r\n\r\n\t\treturn new Promise<string>( (resolve,reject)=>\r\n\t\t\t{\r\n\t\t\t\t$.ajax({\ttype\t\t: 'GET',\r\n\t\t\t\t\t\t\turl\t\t\t: url,\r\n\t\t\t\t\t\t\tcontentType\t: 'text/html',\r\n\t\t\t\t\t\t\tsuccess\t\t: (data,textStatus,jqXHR)=>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tutils.log( 'getRequest', { response:data } );\r\n\t\t\t\t\t\t\t\t\t\t\t\tresolve( data );\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\terror\t\t: (jqXHR,textStatus,errorThrown)=>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tutils.error( 'getRequest rejected', { jqXHR, textStatus, errorThrown } );\r\n\t\t\t\t\t\t\t\t\t\t\t\treject( textStatus );\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t} );\r\n\t}\r\n\r\n\texport function downloadFile(url:string) : void\r\n\t{\r\n\t\t$(document.body).append( $(\"<iframe/>\").attr({\tsrc\t\t: url,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle\t: 'visibility:hidden;display:none' })\r\n\t\t\t\t\t\t\t\t);\r\n\t}\r\n\r\n} // namespace url\r\n\r\n// nb: Exports at the end or the order of execution breaks everything (i.e. strEnum must be defined before) ...\r\nexport * from \"../Language\";\r\nexport * from \"../PageHelper\";\r\nexport * from \"../Routes\";\r\n"]}