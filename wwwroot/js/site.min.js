!function o(u,s,l){function a(e,t){if(!s[e]){if(!u[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(c)return c(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[e]={exports:{}};u[e][0].call(i.exports,function(t){return a(u[e][1][t]||t)},i,i.exports,o,u,s,l)}return s[e].exports}for(var c="function"==typeof require&&require,t=0;t<l.length;t++)a(l[t]);return a}({1:[function(t,e,n){},{}],2:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0});var r={common:t("./src/Views/common"),itemttt:{list:t("./src/Views/ItemTTT/List"),add:t("./src/Views/ItemTTT/Add"),edit:t("./src/Views/ItemTTT/Edit")}};window.ttt=r},{"./src/Views/ItemTTT/Add":8,"./src/Views/ItemTTT/Edit":9,"./src/Views/ItemTTT/List":11,"./src/Views/common":12}],3:[function(t,e,n){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var u=t("../Views/common"),o=function(o){function t(t,e,n){var r=this;null==e&&(e={name:"",pictures:[]});var i=r=o.call(this,t,e,n)||this;return r.pictures=ko.observableArray(e.pictures),null!=i.price&&u.utils.ensureInteger({observable:i.price,canBeZero:!1,canBeNull:!0,mustBePositive:!0}),r}return i(t,o),t.prototype.toDictObj=function(t){return o.prototype.toDictObj.call(this,t)},t.prototype.fromDictObj=function(t){o.prototype.fromDictObj.call(this,t),this.pictures(t.pictures)},t}(t("../Utils/BaseAutoItem").BaseAutoItem);n.ItemKO=o},{"../Utils/BaseAutoItem":7,"../Views/common":12}],4:[function(t,e,n){var r;Object.defineProperty(n,"__esModule",{value:!0});var i=t("./Views/common");n.Languages=(r=i.utils.strEnum(["en","fr","nl"])).e,n.allLanguages=r.a},{"./Views/common":12}],5:[function(t,e,n){var i=this&&this.__awaiter||function(o,u,s,l){return new(s||(s=Promise))(function(t,e){function n(t){try{i(l.next(t))}catch(t){e(t)}}function r(t){try{i(l.throw(t))}catch(t){e(t)}}function i(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(n,r)}i((l=l.apply(o,u||[])).next())})},o=this&&this.__generator||function(n,r){var i,o,u,t,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(u=2&e[0]?o.return:e[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,e[1])).done)return u;switch(o=0,u&&(e=[2&e[0],u.value]),e[0]){case 0:case 1:u=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(u=0<(u=s.trys).length&&u[u.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3])){s.label=e[1];break}if(6===e[0]&&s.label<u[1]){s.label=u[1],u=e;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(e);break}u[2]&&s.ops.pop(),s.trys.pop();continue}e=r.call(n,s)}catch(t){e=[6,t],o=0}finally{i=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(n,"__esModule",{value:!0});var u=t("../Views/common");n.getUrlCode=function(e){return i(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return u.utils.stringIsNullOrWhitespace(e)?[2,null]:[4,u.url.getRequest(u.routes.api.getUrlCode,{originalCode:e})];case 1:return[2,t.sent()]}})})},n.details=function(r){return i(this,void 0,void 0,function(){var e,n;return o(this,function(t){switch(t.label){case 0:return e=u.routes.api.itemDetails.replace(u.routes.itemCodeParameter,r),[4,u.url.postRequestJSON(e,{})];case 1:return(n=t.sent()).item=n.result,delete n.result,[2,n]}})})},n.save=function(n){return i(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:return[4,u.url.postRequestJSON(u.routes.api.itemSave,n)];case 1:return(e=t.sent()).newCode=e.result,delete e.result,[2,e]}})})},n.delete_=function(n){return i(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:return e=u.routes.api.itemDelete.replace(u.routes.itemCodeParameter,n),[4,u.url.postRequestJSON(e,{})];case 1:return[2,t.sent()]}})})}},{"../Views/common":12}],6:[function(t,e,n){var r=this&&this.__awaiter||function(o,u,s,l){return new(s||(s=Promise))(function(t,e){function n(t){try{i(l.next(t))}catch(t){e(t)}}function r(t){try{i(l.throw(t))}catch(t){e(t)}}function i(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(n,r)}i((l=l.apply(o,u||[])).next())})},i=this&&this.__generator||function(n,r){var i,o,u,t,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(u=2&e[0]?o.return:e[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,e[1])).done)return u;switch(o=0,u&&(e=[2&e[0],u.value]),e[0]){case 0:case 1:u=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(u=0<(u=s.trys).length&&u[u.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3])){s.label=e[1];break}if(6===e[0]&&s.label<u[1]){s.label=u[1],u=e;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(e);break}u[2]&&s.ops.pop(),s.trys.pop();continue}e=r.call(n,s)}catch(t){e=[6,t],o=0}finally{i=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(n,"__esModule",{value:!0});var u=t("../Views/common");n.upload=function(t,e){var n=u.routes.api.itemPictureUpload.replace(u.routes.itemCodeParameter,t),o=new FormData;return o.append("file",e),new Promise(function(r,i){$.ajax({type:"POST",url:n,contentType:!1,processData:!1,data:o,dataType:"json",success:function(t,e,n){t.imageNumber=t.result,delete t.result,r(t)},error:function(t,e,n){i(e)}})})},n.delete_=function(n){return r(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return e=u.routes.api.itemPictureDelete.replace(u.routes.itemCodeParameter,n.itemCode),[4,u.url.postRequestForm(e,{number:n.number})];case 1:return[2,t.sent()]}})})},n.reorder=function(n){return r(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return e=u.routes.api.itemPictureReorder.replace(u.routes.itemCodeParameter,n.itemCode),[4,u.url.postRequestForm(e,{number:n.number,newNumber:n.newNumber})];case 1:return[2,t.sent()]}})})},n.setMain=function(n){return r(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return e=u.routes.api.itemPictureSetMain.replace(u.routes.itemCodeParameter,n.itemCode),[4,u.url.postRequestForm(e,{number:n.number,isMain:n.isMain})];case 1:return[2,t.sent()]}})})}},{"../Views/common":12}],7:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0});var i="ttt-name",r=function(){function t(t,e,n){this.fieldNames=null!=n?n:[],this.knockoutify(t,e)}return t.prototype.toDictObj=function(r){var i=this;return null==r&&(r={}),$.each(this.fieldNames,function(t,e){var n=i[e];r[e]=n()}),r},t.prototype.fromDictObj=function(n){var r=this;$.each(this.fieldNames,function(t,e){(0,r[e])(n[e])})},t.prototype.knockoutify=function(t,e){var r=this,n=this;t.find("["+i+"]").each(function(t,e){var n=$(e).attr(i);0<=r.fieldNames.indexOf(n)||r.fieldNames.push(n)}),r.fieldNames.forEach(function(t){n[t]=ko.observable(e[t])})},t}();n.BaseAutoItem=r},{}],8:[function(t,e,i){var n=this&&this.__awaiter||function(o,u,s,l){return new(s||(s=Promise))(function(t,e){function n(t){try{i(l.next(t))}catch(t){e(t)}}function r(t){try{i(l.throw(t))}catch(t){e(t)}}function i(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(n,r)}i((l=l.apply(o,u||[])).next())})},o=this&&this.__generator||function(n,r){var i,o,u,t,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(u=2&e[0]?o.return:e[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,e[1])).done)return u;switch(o=0,u&&(e=[2&e[0],u.value]),e[0]){case 0:case 1:u=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(u=0<(u=s.trys).length&&u[u.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3])){s.label=e[1];break}if(6===e[0]&&s.label<u[1]){s.label=u[1],u=e;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(e);break}u[2]&&s.ops.pop(),s.trys.pop();continue}e=r.call(n,s)}catch(t){e=[6,t],o=0}finally{i=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(i,"__esModule",{value:!0});var u,s=t("../common"),r=t("../../DTOs/Item"),l=t("../../Services/ItemController");function a(){return n(this,void 0,void 0,function(){var e,n,r;return o(this,function(t){switch(t.label){case 0:return s.utils.log("add.save(): START"),e=i.item.toDictObj(),s.utils.log("add.save(): Launch save"),s.html.block(u),[4,l.save({item:e})];case 1:return n=t.sent(),s.html.unblock(u),n.success?(s.utils.log("add.save(): Redirect",{rc:n}),r=s.routes.itemTTT.itemEdit.replace(s.routes.itemCodeParameter,n.newCode),s.utils.log('add.save(): url="'+r+'"'),s.url.redirect(r),s.utils.log("add.save(): END"),[2]):(s.utils.error("add.save(): Error",{rc:n}),s.html.showMessage(n.errorMessage),[2])}})})}i.init=function(e){return n(this,void 0,void 0,function(){return o(this,function(t){return s.utils.log("add.init() START",{p:e}),u=e.$blockingDiv,s.utils.log("add.init(): Create KO item"),i.item=new r.ItemKO(e.$fieldsContainer),s.utils.log("add.init(): Apply KO item"),ko.applyBindings(i.item,e.$fieldsContainer[0]),s.utils.log("add.init(): Bind JQuery events"),e.$btnSave.click(a),s.utils.log("add.init() END"),[2]})})}},{"../../DTOs/Item":3,"../../Services/ItemController":5,"../common":12}],9:[function(t,e,i){var o=this&&this.__awaiter||function(o,u,s,l){return new(s||(s=Promise))(function(t,e){function n(t){try{i(l.next(t))}catch(t){e(t)}}function r(t){try{i(l.throw(t))}catch(t){e(t)}}function i(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(n,r)}i((l=l.apply(o,u||[])).next())})},u=this&&this.__generator||function(n,r){var i,o,u,t,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(u=2&e[0]?o.return:e[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,e[1])).done)return u;switch(o=0,u&&(e=[2&e[0],u.value]),e[0]){case 0:case 1:u=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(u=0<(u=s.trys).length&&u[u.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3])){s.label=e[1];break}if(6===e[0]&&s.label<u[1]){s.label=u[1],u=e;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(e);break}u[2]&&s.ops.pop(),s.trys.pop();continue}e=r.call(n,s)}catch(t){e=[6,t],o=0}finally{i=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(i,"__esModule",{value:!0});var s,l,a=t("../common"),c=t("../../DTOs/Item"),d=t("../../Services/ItemController"),f=t("../../Services/ItemPictureController"),m="Are you sure you want to delete that item?",r="Item saved successfully",p="An error occured while refresing the data: ",h="Are you sure you want to delete that image?";function v(){return o(this,void 0,void 0,function(){var e,n;return u(this,function(t){switch(t.label){case 0:return a.utils.log("edit.save(): START"),e=i.item.toDictObj(),a.utils.log("edit.save(): Launch save"),a.html.block(s),[4,d.save({originalCode:l,item:e})];case 1:return n=t.sent(),a.html.unblock(s),n.success?(a.utils.log("edit.save(): Refresh values",{rc:n}),[4,g(n.newCode)]):(a.utils.error("edit.save(): Error",{rc:n}),a.html.showMessage(n.errorMessage),[2]);case 2:return t.sent()&&a.html.showMessage(r),a.utils.log("edit.save(): END"),[2]}})})}function b(r){return o(this,void 0,void 0,function(){var e,n;return u(this,function(t){switch(t.label){case 0:return a.utils.log("edit.uploadPicture(): START",{files:r}),0==r.length?[2]:void 0===window.FormData?(a.utils.error("This browser doesn't support HTML5 file uploads!"),[2]):(a.utils.log("edit.uploadPicture(): Create '"+r.length+"' upload tasks"),a.html.block(s),e=$.map(r,function(t){return f.upload(l,t)}),a.utils.log("edit.uploadPicture(): Wait for tasks to terminate"),[4,Promise.all(e)]);case 1:return n=t.sent(),a.html.unblock(s),a.utils.log("edit.uploadPicture(): All tasks terminated"),$.each(n,function(t,e){e||(a.utils.error("edit.delete(): Upload error",{i:t,rc:e}),a.html.showMessage(e.errorMessage))}),[4,g()];case 2:return t.sent(),a.utils.log("edit.uploadPicture(): END"),[2]}})})}function g(r){return o(this,void 0,void 0,function(){var e,n;return u(this,function(t){switch(t.label){case 0:return a.utils.log("edit.refresh(): START"),(e=null)==r?r=l:(l!=r&&(e=a.routes.itemTTT.itemEdit.replace(a.routes.itemCodeParameter,r)),l=r),a.utils.log("edit.refresh(): Launch request"),a.html.block(s),[4,d.details(r)];case 1:return n=t.sent(),a.html.unblock(s),n.success?(a.utils.log("edit.refresh(): Load from new item",{rc:n}),i.item.fromDictObj(n.item),null!=e&&(a.utils.log('edit.refresh(): Update URL to "'+e+'"'),a.url.pushHistory({pathname:e,newTitle:i.item.name()})),a.utils.log("edit.refresh(): END"),[2,!0]):(a.utils.error("edit.refresh(): Error",{rc:n}),a.html.showMessage(p+n.errorMessage),[2,!1])}})})}i.init=function(r){return o(this,void 0,void 0,function(){return u(this,function(t){var e,n;return a.utils.log("edit.init() START",{p:r}),s=r.$blockingDiv,a.utils.log("edit.init(): Create KO item"),i.item=new c.ItemKO(r.$fieldsContainer,r.model),l=i.item.code(),a.utils.log("edit.init(): Bind JQuery events"),r.$btnSave.click(v),r.$btnDelete.click(function(){!function(r){o(this,void 0,void 0,function(){var e,n;return u(this,function(t){switch(t.label){case 0:return a.utils.log("edit.delete(): START"),1==r?[3,2]:(a.utils.log("edit.delete(): Ask confirmation"),[4,a.html.confirm(m)]);case 1:if(!t.sent())return a.utils.log("edit.delete(): NOT CONFIRMED"),[2];t.label=2;case 2:return a.utils.log("edit.delete(): Launch delete"),a.html.block(s),[4,d.delete_(l)];case 3:return e=t.sent(),a.html.unblock(s),e.success?(a.utils.log("edit.delete(): Redirect"),n=a.routes.itemTTT.itemsList.replace(a.routes.languageParameter,a.pageParameters.currentLanguage),a.utils.log("edit.delete()",{url:n}),a.url.redirect(n),a.utils.log("edit.delete(): END")):(a.utils.error("edit.delete(): Error",{rc:e}),a.html.showMessage(e.errorMessage)),[2]}})})}()}),a.utils.log("edit.init(): Init picture upload"),e=r.$picUploadDropZone,n=r.$picUploadControl,a.utils.log("edit.initDropZone(): Create drop zone object"),i.picDropZone={hover:ko.observable(!1)},a.utils.log('edit.initDropZone(): Watch for drag-drops on "upload image drop zone"'),e.on("dragenter",function(t){i.picDropZone.hover(!0),t.stopPropagation(),t.preventDefault()}),e.on("dragover",function(t){i.picDropZone.hover(!0),t.stopPropagation(),t.preventDefault()}),e.on("dragleave",function(t){i.picDropZone.hover(!1)}),e.on("drop",function(t){i.picDropZone.hover(!1),t.preventDefault();var e=t.originalEvent.dataTransfer.files;b(e)}),n.on("change",function(){var t=n[0].files;b(t)}),a.utils.log("edit.init() END"),[2]})})},i.deletePicture=function(n,r){return o(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return a.utils.log("edit.deletePicture(): START"),1==r?[3,2]:(a.utils.log("edit.deletePicture(): Ask confirmation"),[4,a.html.confirm(h)]);case 1:if(!t.sent())return a.utils.log("edit.deletePicture(): NOT CONFIRMED"),[2];t.label=2;case 2:return a.utils.log("edit.deletePicture(): Launch delete request"),a.html.block(s),[4,f.delete_({itemCode:n.itemCode,number:n.number})];case 3:return e=t.sent(),a.html.unblock(s),e.success||(a.utils.error("edit.deletePicture(): Error",{rc:e}),a.html.showMessage(e.errorMessage)),a.utils.log("edit.deletePicture(): Launch refresh"),[4,g()];case 4:return t.sent(),a.utils.log("edit.deletePicture(): END"),[2]}})})},i.toggleMainPicture=function(n){return o(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return a.utils.log("edit.toggleMainPicture(): START"),a.utils.log("edit.toggleMainPicture(): Launch toggle request"),a.html.block(s),[4,f.setMain({itemCode:n.itemCode,number:n.number,isMain:!n.isMainImage})];case 1:return e=t.sent(),a.html.unblock(s),e.success||(a.utils.error("edit.toggleMainPicture(): Error",{rc:e}),a.html.showMessage(e.errorMessage)),a.utils.log("edit.toggleMainPicture(): Launch refresh"),[4,g()];case 2:return t.sent(),a.utils.log("edit.toggleMainPicture(): END"),[2]}})})},i.reorderPicture=function(r,i){return o(this,void 0,void 0,function(){var e,n;return u(this,function(t){switch(t.label){case 0:return a.utils.log("edit.movePicture(): START"),(e=r.number+i)<=0&&(e=1),r.number==e?[2]:(a.utils.log("edit.movePicture(): Launch move request"),a.html.block(s),[4,f.reorder({itemCode:r.itemCode,number:r.number,newNumber:e})]);case 1:return n=t.sent(),a.html.unblock(s),n.success||(a.utils.error("edit.movePicture(): Error",{rc:n}),a.html.showMessage(n.errorMessage)),a.utils.log("edit.movePicture(): Launch refresh"),[4,g()];case 2:return t.sent(),a.utils.log("edit.movePicture(): END"),[2]}})})},i.scrambleUrl=function(t){return 0<=t.indexOf("?")?t+="&":t+="?",t=t+"p="+a.utils.newGuid()}},{"../../DTOs/Item":3,"../../Services/ItemController":5,"../../Services/ItemPictureController":6,"../common":12}],10:[function(t,e,n){var r=this&&this.__awaiter||function(o,u,s,l){return new(s||(s=Promise))(function(t,e){function n(t){try{i(l.next(t))}catch(t){e(t)}}function r(t){try{i(l.throw(t))}catch(t){e(t)}}function i(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(n,r)}i((l=l.apply(o,u||[])).next())})},i=this&&this.__generator||function(n,r){var i,o,u,t,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(u=2&e[0]?o.return:e[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,e[1])).done)return u;switch(o=0,u&&(e=[2&e[0],u.value]),e[0]){case 0:case 1:u=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(u=0<(u=s.trys).length&&u[u.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3])){s.label=e[1];break}if(6===e[0]&&s.label<u[1]){s.label=u[1],u=e;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(e);break}u[2]&&s.ops.pop(),s.trys.pop();continue}e=r.call(n,s)}catch(t){e=[6,t],o=0}finally{i=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(n,"__esModule",{value:!0});var o,u,s,l=t("../common");o=n.list||(n.list={}),u=l.utils.strEnum(["grid","list"]),o.ViewModes=u.e,o.allViewModes=u.a,s=l.utils.strEnum(["price","price_desc","name","name_desc"]),o.SortingFields=s.e,o.allSortingFields=s.a,o.getListContent=function(n){return r(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return e=l.routes.itemTTT.itemsList.replace(l.routes.languageParameter,l.pageParameters.currentLanguage),[4,l.url.getRequest(e,n)];case 1:return[2,t.sent()]}})})}},{"../common":12}],11:[function(t,e,n){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(o,u,s,l){return new(s||(s=Promise))(function(t,e){function n(t){try{i(l.next(t))}catch(t){e(t)}}function r(t){try{i(l.throw(t))}catch(t){e(t)}}function i(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(n,r)}i((l=l.apply(o,u||[])).next())})},u=this&&this.__generator||function(n,r){var i,o,u,t,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(u=2&e[0]?o.return:e[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,e[1])).done)return u;switch(o=0,u&&(e=[2&e[0],u.value]),e[0]){case 0:case 1:u=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(u=0<(u=s.trys).length&&u[u.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3])){s.label=e[1];break}if(6===e[0]&&s.label<u[1]){s.label=u[1],u=e;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(e);break}u[2]&&s.ops.pop(),s.trys.pop();continue}e=r.call(n,s)}catch(t){e=[6,t],o=0}finally{i=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(n,"__esModule",{value:!0});var s,l,a,c,d=t("../common"),f=t("./ItemTTTController"),m=t("../../DTOs/Item"),p=t("../../Language"),h="[type=ttt-model]";function v(){d.utils.log("list.reconstructItemsList(): START");var t=c.find(h);d.utils.log("list.reconstructItemsList(): Reconstructing "+t.length+" models");var u=[];t.each(function(t,e){var n=$(e),r=n.parent(),i=JSON.parse(n.text());n.remove();var o=new y(r,i);u.push(o)}),d.utils.log("list.reconstructItemsList(): Replacing itemsList"),n.itemsList=u,d.utils.log("list.reconstructItemsList(): END")}function b(){n.itemsList.forEach(function(t){t.visible(t.getIsVisible())})}function g(n){return o(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:if(d.utils.log("list.refreshList(): START",{p:n,currentSortingField:s}),n.noLayout=!0,null!=n.sortingField){if(n.sortingField==s)switch(s){case f.list.SortingFields.name:n.sortingField=f.list.SortingFields.name_desc;break;case f.list.SortingFields.price:n.sortingField=f.list.SortingFields.price_desc}s=n.sortingField}return d.utils.log("list.refreshList(): Request html & replace list DOM"),[4,f.list.getListContent(n)];case 1:return e=t.sent(),c.html(e),v(),d.utils.log("list.refreshList(): END",{currentSortingField:s}),[2]}})})}n.init=function(e){return o(this,void 0,void 0,function(){return u(this,function(t){return d.utils.log("list.init(): START"),s=e.sortingField,l=e.$txtSearch,a=e.$cbShowInactive.prop("checked",!0),c=e.$divCarsList,e.$btnViewGrid.click(function(){g({viewMode:f.list.ViewModes.grid})}),e.$btnViewList.click(function(){g({viewMode:f.list.ViewModes.list})}),e.$btnSortName.click(function(){g({sortingField:f.list.SortingFields.name})}),e.$btnSortPrice.click(function(){g({sortingField:f.list.SortingFields.price})}),v(),d.utils.log("list.init(): Bind JQuery events"),l.keyup(function(){b()}),a.change(function(){b()}),d.utils.log("list.init(): END"),[2]})})},n.filterItemsList=b;var y=function(o){function t(t,e){var n=this,r=[d.utils.nameof("name"),d.utils.nameof("descriptionEN"),d.utils.nameof("descriptionFR"),d.utils.nameof("descriptionNL"),d.utils.nameof("active")],i=n=o.call(this,t,e,r)||this;return n.$container=t,n.visible=ko.observable(i.getIsVisible()),ko.applyBindings(i,t[0]),n}return i(t,o),t.prototype.toggleActive=function(){console.warn("TODO: toggleActive",{self:this})},t.prototype.getIsVisible=function(){var t=this,e=a.is(":checked");if(!t.active()&&!e)return!1;var n=l.val();if(""==(n=(null==n?"":n).toLowerCase().trim()))return!0;var r=[];$.each(n.split(" "),function(t,e){d.utils.stringIsNullOrWhitespace(e)||r.push(e.trim())});var i=[];switch(i.push(t.name()),d.pageParameters.currentLanguage){case p.Languages.en:i.push(t.descriptionEN());break;case p.Languages.fr:i.push(t.descriptionFR());break;case p.Languages.nl:i.push(t.descriptionNL())}var o=0;return r.forEach(function(t,e){for(var n=0;n<i.length;++n){if(0<=i[n].toLowerCase().indexOf(t))return void++o}}),o==r.length},t}(m.ItemKO)},{"../../DTOs/Item":3,"../../Language":4,"../common":12,"./ItemTTTController":10}],12:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i,o,u=t("./common");n.debugMessages=!1,n.init=function(t){n.pageParameters=t.pageParameters,n.routes=n.pageParameters.routes,r.log("common.init()"),r.log("common.init(): Add custom KnockoutHandler"),ko.bindingHandlers.ttt_slideUpDownVisible={init:function(t,e){ko.unwrap(e())||$(t).hide()},update:function(t,e){ko.unwrap(e())?$(t).slideDown():$(t).slideUp()}},ko.bindingHandlers.ttt_slideLeftRightVisible={init:function(t,e){ko.unwrap(e())||$(t).hide()},update:function(t,e){ko.unwrap(e())?$(t).show("blind",{direction:"left"}):$(t).hide("blind",{direction:"left"})}}},(i=r=n.utils||(n.utils={})).log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];n.pageParameters.isDebug&&console.log.apply(console,arguments)},i.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.error.apply(console,arguments)},i.nameof=function(t){return t},i.strEnum=function(t){return{e:t.reduce(function(t,e){return t[e]=e,t},Object.create(null)),a:t}},i.stringIsNullOrEmpty=function(t){return null==t||""==t},i.stringIsNullOrWhitespace=function(t){return null==t||""==t.trim()},i.htmlEncode=function(t){return Array.isArray(t)?$.map(t,function(t){return $(document.createElement("span")).text(t).html()}).join("<br/>"):$(document.createElement("span")).text(t).html()},i.arrayContains=function(t,e){return 0<=t.indexOf(e)},i.arrayRemoveItem=function(t,e){var n=t.indexOf(e);return!(n<0||(t.splice(n,1),0))},i.arraySum=function(t,e){var n=0;return t.forEach(function(t){n+=e(t)}),n},i.arrayMoveItem=function(t){var e=1;null!=t.direction&&(e="up"==t.direction?-e:e);var n=t.list.indexOf(t.item);if(n<0)throw{error:"Could not find item in list",item:t.item};var r=n+e;if(r<0?r=0:r>=t.list.length&&(r=t.list.length-1),n==r)return t.list;var i=t.list[n];return t.list[n]=t.list[r],t.list[r]=i,t.list},i.ensureInteger=function(n){null==n.canBeZero&&(n.canBeZero=!0),null==n.canBeNull&&(n.canBeNull=!1),null==n.fallbackValue&&(n.canBeZero?n.fallbackValue=0:n.fallbackValue=1);var r=n.canBeNull;n.observable.subscribe(function(t){if(!r||""!=t&&null!=t){var e=parseInt(t);isNaN(e)?e=n.fallbackValue:n.canBeZero||0!=t?n.mustBePositive&&t<0&&(e=n.fallbackValue):e=n.fallbackValue,t!==e&&n.observable(e)}else n.observable(null)})},i.newGuid=function(){var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},i.sleep=function(e){return new Promise(function(t){return setTimeout(t,e)})},(o=n.html||(n.html={})).showMessage=function(t){var e=$('<div class="modal" tabindex="-1" role="dialog">\n\t\t\t\t\t\t<div class="modal-dialog" role="document">\n\t\t\t\t\t\t\t<div class="modal-content">\n\t\t\t\t\t\t\t\t<div class="modal-body">\n\t\t\t\t\t\t\t\t\t\x3c!-- Text content here --\x3e\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="modal-footer">\n\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>');e.find(".modal-body").text(t),e.modal()},o.confirm=function(t){var r=$('<div class="modal" tabindex="-1" role="dialog">\n\t\t\t\t\t\t<div class="modal-dialog" role="document">\n\t\t\t\t\t\t\t<div class="modal-content">\n\t\t\t\t\t\t\t\t<div class="modal-body">\n\t\t\t\t\t\t\t\t\t\x3c!-- Text content here --\x3e\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="modal-footer">\n\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-primary">Save changes</button>\n\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>');return r.find(".modal-body").text(t),new Promise(function(e){var n=!1;r.find(".btn-primary").click(function(){n=!0,r.modal("hide"),e(!0)}),r.on("hidden.bs.modal",function(t){n||e(!1)}),r.modal()})},o.block=function(t){var e=1+(0|t.data("common_blockCounter"));return t.data("common_blockCounter",e),1==e&&t.block(),t},o.unblock=function(t){var e=(0|t.data("common_blockCounter"))-1;return t.data("common_blockCounter",e),e<0&&(u.utils.error("INTERNAL ERROR: Unblock count > block count:",e),e=0,t.data("common_blockCounter",0)),0==e&&t.unblock(),t},o.ensureVisible=function(t){var e=t.offset().top-(20+t.height());$("html, body").animate({scrollTop:e}),t.effect("highlight",{},2e3)},function(t){var n="onUrlChanged",r=$({}),e=!1;function i(t){var n=[];return $.each(t,function(t,e){t=encodeURIComponent(t),null==e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||(e=JSON.stringify(e)),e=encodeURIComponent(e),n.push(t+"="+e)}),n.join("&")}function o(t){var e=t.pathname;if(null==e&&(e=window.location.pathname),null!=t.parameters){var n=i(t.parameters);0<n.length&&(e=e+"?"+n)}return e}t.redirect=function(t){window.location.href=t},t.parseParameters=function(t){if(null==t&&(t=window.location.search.substring(1)),0==t.length)return{};for(var e=t.split("&"),n={},r=0;r<e.length;++r){var i=e[r].split("="),o=decodeURIComponent(i[0]),u=decodeURIComponent(i[1]);try{u=JSON.parse(u)}catch(t){}n[o]=u}return n},t.stringifyParameters=i,t.onChanged=function(t){0==e&&($(window).bind("popstate",function(t){r.trigger(n)}),e=!0),r.bind(n,t)},t.createUrl=o,t.pushHistory=function(t){var e=o(t);window.history.pushState({},t.newTitle,e),r.trigger(n)},t.postRequestForm=function(t,e){return new Promise(function(r,i){$.ajax({type:"POST",url:t,contentType:"application/x-www-form-urlencoded",data:e,dataType:"json",success:function(t,e,n){return r(t)},error:function(t,e,n){i(e)}})})},t.postRequestJSON=function(t,e){var n=JSON.stringify(e);return new Promise(function(r,i){$.ajax({type:"POST",url:t,contentType:"application/json",data:n,dataType:"json",success:function(t,e,n){return r(t)},error:function(t,e,n){i(e)}})})},t.getRequest=function(t,e){if(null!=e){var n=i(e);t=t+"?"+n}return new Promise(function(r,i){$.ajax({type:"GET",url:t,contentType:"text/html",success:function(t,e,n){return r(t)},error:function(t,e,n){i(e)}})})},t.downloadFile=function(t){$(document.body).append($("<iframe/>").attr({src:t,style:"visibility:hidden;display:none"}))}}(n.url||(n.url={})),function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(t("../Language"))},{"../Language":4,"./common":12}]},{},[1,2]);
//# sourceMappingURL=site.min.js.map
